
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      
      
      <link rel="icon" href="../../../../../../../assets/favicon.ico">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.22">
    
    
      
        <title>Deepseek v3 - Ohayou</title>
      
    
    
      <link rel="stylesheet" href="../../../../../../../assets/stylesheets/main.84d31ad4.min.css">
      
        
        <link rel="stylesheet" href="../../../../../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../../../../../assets/extra.css">
    
    <script>__md_scope=new URL("../../../../../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#deepseek-v3deepseek-v3" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../../../../.." title="Ohayou" class="md-header__button md-logo" aria-label="Ohayou" data-md-component="logo">
      
  <img src="../../../../../../../assets/logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Ohayou
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Deepseek v3
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../../../../ohayou/" class="md-tabs__link">
        
  
  
    
  
  Ohayou

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../../../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../../../../vllm/open_ai_vllm_example_a_v_t/" class="md-tabs__link">
          
  
  
    
  
  vLLM

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../../../../llm/speculative_decoding/" class="md-tabs__link">
          
  
  
    
  
  LLM

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../../../../vlm/qwen3_vl_4B_object_detection/" class="md-tabs__link">
          
  
  
    
  
  VLM

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../../../../md_format_helpers/" class="md-tabs__link">
        
  
  
    
  
  MD format helpers

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../../../../docker/" class="md-tabs__link">
        
  
  
    
  
  Docker

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../../../../linux/" class="md-tabs__link">
        
  
  
    
  
  Linux

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../../../../moe/" class="md-tabs__link">
        
  
  
    
  
  Mixture of Experts

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../../../../slurm/" class="md-tabs__link">
        
  
  
    
  
  Slurm

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../../../../japanese-phrases/" class="md-tabs__link">
          
  
  
    
  
  Japanese Phrases

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../../../../hackathon/index.md" class="md-tabs__link">
        
  
  
    
  
  Hack

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../../../../.." title="Ohayou" class="md-nav__button md-logo" aria-label="Ohayou" data-md-component="logo">
      
  <img src="../../../../../../../assets/logo.png" alt="logo">

    </a>
    Ohayou
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../ohayou/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Ohayou
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    vLLM
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            vLLM
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../vllm/open_ai_vllm_example_a_v_t/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Single Request
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../vllm/bash_vllm_serve/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Bash online serve
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../vllm/benchmarks/performance_eval/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Benchmarks
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    LLM
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            LLM
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../llm/speculative_decoding/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Speculative Decoding
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    VLM
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            VLM
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../vlm/qwen3_vl_4B_object_detection/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Qwen3VL_adema_grounding
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../vlm/qwen3_vla_4B_audio_training_aspandiyar/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Qwen3VLA_aspandiyar_thinking
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../md_format_helpers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    MD format helpers
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../docker/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Docker
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../linux/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Linux
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../moe/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Mixture of Experts
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../slurm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Slurm
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../../../../japanese-phrases/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Japanese Phrases
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_11" id="__nav_11_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_11">
            <span class="md-nav__icon md-icon"></span>
            Japanese Phrases
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11_2" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../../../../japanese-phrases/daily-life/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Daily Life
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_11_2" id="__nav_11_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_11_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_11_2">
            <span class="md-nav__icon md-icon"></span>
            Daily Life
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../japanese-phrases/daily-life/shopping/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Shopping
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11_3" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../../../../japanese-phrases/greetings/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Greetings
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_11_3" id="__nav_11_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_11_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_11_3">
            <span class="md-nav__icon md-icon"></span>
            Greetings
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../japanese-phrases/greetings/casual/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Casual
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../japanese-phrases/emotions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Emotions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../japanese-phrases/anime-manga/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Anime/Manga
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../hackathon/index.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Hack
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    <span class="md-ellipsis">
      개요[[overview]]
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#limitations-and-call-for-contribution" class="md-nav__link">
    <span class="md-ellipsis">
      한계 및 기여 요청![[limitations-and-call-for-contribution!]]
    </span>
  </a>
  
    <nav class="md-nav" aria-label="한계 및 기여 요청![[limitations-and-call-for-contribution!]]">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#usage-tips" class="md-nav__link">
    <span class="md-ellipsis">
      사용 팁[[usage-tips]]
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deepseekv3configdeepseekv3config" class="md-nav__link">
    <span class="md-ellipsis">
      DeepseekV3Config[[deepseekv3config]]
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deepseekv3modeldeepseekv3model" class="md-nav__link">
    <span class="md-ellipsis">
      DeepseekV3Model[[deepseekv3model]]
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deepseekv3forcausallmdeepseekv3forcausallm" class="md-nav__link">
    <span class="md-ellipsis">
      DeepseekV3ForCausalLM[[deepseekv3forcausallm]]
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<!--Copyright 2025 The HuggingFace Team. All rights reserved.

Licensed under the Apache License, Version 2.0 (the "License"); you may not use this file except in compliance with
the License. You may obtain a copy of the License at

http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on
an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the
specific language governing permissions and limitations under the License.

⚠️ Note that this file is in Markdown but contain specific syntax for our doc-builder (similar to MDX) that may not be
rendered properly in your Markdown viewer.

-->

<h1 id="deepseek-v3deepseek-v3">DeepSeek-V3[[deepseek-v3]]</h1>
<h2 id="overview">개요[[overview]]</h2>
<p>DeepSeek-V3 모델은 <a href="https://huggingface.co/papers/2412.19437">DeepSeek-V3 기술 보고서</a>에서 DeepSeek-AI 팀에 의해 제안되었습니다.</p>
<p>논문의 초록은 다음과 같습니다.
총 671B개의 파라미터를 가지며 토큰당 37B개가 활성화되는 강력한 Mixture-of-Experts(MoE) 언어 모델인 DeepSeek-V3를 소개합니다. 효율적인 추론과 비용 효율적인 훈련을 달성하기 위해, DeepSeek-V3는 DeepSeek-V2에서 철저히 검증된 Multi-head Latent Attention(MLA) 및 DeepSeekMoE 아키텍처를 채택했습니다. 나아가 DeepSeek-V3는 로드 밸런싱을 위한 보조 손실 없는 전략을 개척하고, 더 강력한 성능을 위해 다중 토큰 예측 훈련 목표를 설정합니다. 저희는 14.8조 개의 다양하고 고품질의 토큰으로 DeepSeek-V3를 사전 훈련했으며, 그 잠재력을 완전히 활용하기 위해 지도 파인튜닝 및 강화 학습 단계를 거쳤습니다. 종합적인 평가 결과, DeepSeek-V3는 다른 오픈 소스 모델들을 능가하며 선도적인 비공개 소스 모델들과 필적하는 성능을 달성했음을 보여줍니다. 뛰어난 성능에도 불구하고 DeepSeek-V3의 전체 훈련에는 278.8만 H800 GPU 시간만이 소요되었습니다. 또한, 훈련 과정이 매우 안정적입니다. 전체 훈련 과정 동안 복구 불가능한 손실 급증을 경험하거나 롤백을 수행한 적이 없습니다. 모델 체크포인트는 https://github.com/deepseek-ai/DeepSeek-V3 에서 확인할 수 있습니다.</p>
<h2 id="limitations-and-call-for-contribution">한계 및 기여 요청![[limitations-and-call-for-contribution!]]</h2>
<p>저희는 이 코드를 커뮤니티 기반으로 만들게 되어 매우 기쁘며, 여러분이 다음 사항들을 어떻게 최적화할 수 있는지 확인하고 싶습니다.</p>
<ul>
<li>현재 구현은 "기본적인" 어텐션 계산을 사용합니다. 따라서 실제 Multi-head Latent Attention (MLA) 가 아닙니다.</li>
<li>현재 구현은 전문가들을 순회하는 루프를 사용합니다. 이는 교체되어야 하기에 <code>integrations/tensor_parallel</code>의 <code>get_packed_weights</code>를 사용하는 것을 제안합니다.</li>
<li>현재 구현에서는 ROPE에 EleutherAI의 수식을 사용하지만, 원본 수식을 적용하면 더 효율적일 것입니다! (단, 기존 API는 그대로 준수해야 합니다)</li>
<li>generation config 또는 config shape의 문제일 것으로 추정되는 문제로 인해 정적 캐시는 지원되지 않습니다.</li>
</ul>
<h3 id="usage-tips">사용 팁[[usage-tips]]</h3>
<p>이 모델은 효율적인 추론과 비용 효율적인 훈련을 위해 Multi-head Latent Attention (MLA) 및 DeepSeekMoE 아키텍처를 사용합니다. 로드 밸런싱을 위한 보조 손실이 없는 전략과 다중 토큰 예측 훈련 목표를 채택합니다. 이 모델은 14.8조 개의 토큰으로 사전 훈련되고 지도 파인튜닝 및 강화 학습 단계를 거친 후 다양한 언어 작업에 사용될 수 있습니다.</p>
<p><code>FP8</code>로 모델을 자동으로 실행할 수 있으며, 8개의 H100으로 구성된 2개 노드면 충분할 것입니다!</p>
<p><div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="c1"># `run_deepseek_v1.py`</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">transformers</span><span class="w"> </span><span class="kn">import</span> <span class="n">AutoModelForCausalLM</span><span class="p">,</span> <span class="n">AutoTokenizer</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="n">torch</span><span class="o">.</span><span class="n">manual_seed</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="n">tokenizer</span> <span class="o">=</span> <span class="n">AutoTokenizer</span><span class="o">.</span><span class="n">from_pretrained</span><span class="p">(</span><span class="s2">&quot;deepseek-r1&quot;</span><span class="p">)</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="n">chat</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>  <span class="p">{</span><span class="s2">&quot;role&quot;</span><span class="p">:</span> <span class="s2">&quot;user&quot;</span><span class="p">,</span> <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="s2">&quot;안녕하세요, 어떻게 지내세요?&quot;</span><span class="p">},</span>
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>  <span class="p">{</span><span class="s2">&quot;role&quot;</span><span class="p">:</span> <span class="s2">&quot;assistant&quot;</span><span class="p">,</span> <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="s2">&quot;저는 잘 지내요. 오늘 무엇을 도와드릴까요?&quot;</span><span class="p">},</span>
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a>  <span class="p">{</span><span class="s2">&quot;role&quot;</span><span class="p">:</span> <span class="s2">&quot;user&quot;</span><span class="p">,</span> <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="s2">&quot;채팅 템플릿이 어떻게 작동하는지 보여주고 싶어요!&quot;</span><span class="p">},</span>
</span><span id="__span-0-12"><a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="p">]</span>
</span><span id="__span-0-13"><a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a>
</span><span id="__span-0-14"><a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a>
</span><span id="__span-0-15"><a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="n">model</span> <span class="o">=</span> <span class="n">AutoModelForCausalLM</span><span class="o">.</span><span class="n">from_pretrained</span><span class="p">(</span><span class="s2">&quot;deepseek-r1&quot;</span><span class="p">,</span> <span class="n">device_map</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">,</span> <span class="n">torch_dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">bfloat16</span><span class="p">)</span>
</span><span id="__span-0-16"><a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="n">inputs</span> <span class="o">=</span> <span class="n">tokenizer</span><span class="o">.</span><span class="n">apply_chat_template</span><span class="p">(</span><span class="n">chat</span><span class="p">,</span> <span class="n">tokenize</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">add_generation_prompt</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">return_tensors</span><span class="o">=</span><span class="s2">&quot;pt&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
</span><span id="__span-0-17"><a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a><span class="kn">import</span><span class="w"> </span><span class="nn">time</span>
</span><span id="__span-0-18"><a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a><span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span id="__span-0-19"><a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a><span class="n">outputs</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span> <span class="n">max_new_tokens</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
</span><span id="__span-0-20"><a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a><span class="nb">print</span><span class="p">(</span><span class="n">tokenizer</span><span class="o">.</span><span class="n">batch_decode</span><span class="p">(</span><span class="n">outputs</span><span class="p">))</span>
</span><span id="__span-0-21"><a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a><span class="nb">print</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span><span class="o">-</span><span class="n">start</span><span class="p">)</span>
</span></code></pre></div>
생성된 결과는 다음과 같습니다.</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>&lt;｜Assistant｜&gt;&lt;think&gt;
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>좋아요,<span class="w"> </span>사용자는<span class="w"> </span>채팅<span class="w"> </span>템플릿이<span class="w"> </span>어떻게<span class="w"> </span>작동하는지<span class="w"> </span>보여주고<span class="w"> </span>싶어<span class="w"> </span>하는군요.<span class="w"> </span>이게<span class="w"> </span>무슨<span class="w"> </span>의미인지<span class="w"> </span>분석해<span class="w"> </span>보겠습니다.<span class="w"> </span>채팅<span class="w"> </span>템플릿은<span class="w"> </span>대화<span class="w"> </span>데이터를<span class="w"> </span>구조화하는<span class="w"> </span>것인데,<span class="w"> </span>특히<span class="w"> </span>특정<span class="w"> </span>입력<span class="w"> </span>형식이<span class="w"> </span>필요한<span class="w"> </span>모델에<span class="w"> </span>중요합니다.<span class="w"> </span>아마도<span class="w"> </span>OpenAI<span class="w"> </span>같은<span class="w"> </span>API에서<span class="w"> </span>메시지가<span class="w"> </span>역할<span class="o">(</span>사용자,<span class="w"> </span>어시스턴트,<span class="w"> </span>시스템<span class="o">)</span>과<span class="w"> </span>함께<span class="w"> </span>형식화되는<span class="w"> </span>방식을<span class="w"> </span>말하는<span class="w"> </span>것일<span class="w"> </span>수<span class="w"> </span>있습니다.
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a>
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a>먼저,<span class="w"> </span>채팅<span class="w"> </span>템플릿이<span class="w"> </span>무엇인지<span class="w"> </span>설명해야겠습니다.<span class="w"> </span>이는<span class="w"> </span>모델이<span class="w"> </span>이해할<span class="w"> </span>수<span class="w"> </span>있는<span class="w"> </span>구조화된<span class="w"> </span>형식으로<span class="w"> </span>대화<span class="w"> </span>데이터를<span class="w"> </span>포맷하는<span class="w"> </span>과정입니다.<span class="w"> </span>여기에는<span class="w"> </span>보통<span class="w"> </span>역할과<span class="w"> </span>콘텐츠가<span class="w"> </span>포함됩니다.<span class="w"> </span>예를<span class="w"> </span>들어,<span class="w"> </span>사용자<span class="w"> </span>메시지,<span class="w"> </span>어시스턴트<span class="w"> </span>응답,<span class="w"> </span>시스템<span class="w"> </span>메시지는<span class="w"> </span>각각<span class="w"> </span>고유한<span class="w"> </span>역할<span class="w"> </span>태그를<span class="w"> </span>가집니다.
</span><span id="__span-1-5"><a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a>
</span><span id="__span-1-6"><a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a>사용자는<span class="w"> </span>예시를<span class="w"> </span>원할<span class="w"> </span>수<span class="w"> </span>있습니다.<span class="w"> </span>간단한<span class="w"> </span>대화를<span class="w"> </span>생각해<span class="w"> </span>보죠.<span class="w"> </span>사용자가<span class="w"> </span><span class="s2">&quot;안녕하세요, 잘 지내세요?&quot;</span>라고<span class="w"> </span>말하고<span class="w"> </span>어시스턴트가<span class="w"> </span><span class="s2">&quot;네, 잘 지내요. 오늘 무엇을 도와드릴까요?&quot;</span>라고<span class="w"> </span>답합니다.<span class="w"> </span>그런<span class="w"> </span>다음<span class="w"> </span>사용자가<span class="w"> </span>채팅<span class="w"> </span>템플릿을<span class="w"> </span>보여주고<span class="w"> </span>싶다고<span class="w"> </span>이어갑니다.<span class="w"> </span>따라서<span class="w"> </span>예시에는<span class="w"> </span>대화<span class="w"> </span>기록과<span class="w"> </span>새<span class="w"> </span>메시지가<span class="w"> </span>포함되어야<span class="w"> </span>합니다.
</span><span id="__span-1-7"><a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a>
</span><span id="__span-1-8"><a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a>Hugging<span class="w"> </span>Face의<span class="w"> </span>Transformers와<span class="w"> </span>같은<span class="w"> </span>프레임워크에서는<span class="w"> </span>Jinja2<span class="w"> </span>템플릿을<span class="w"> </span>사용하여<span class="w"> </span>채팅<span class="w"> </span>템플릿이<span class="w"> </span>적용됩니다.<span class="w"> </span>템플릿은<span class="w"> </span>시스템<span class="w"> </span>메시지를<span class="w"> </span>결합한<span class="w"> </span>다음,<span class="w"> </span>적절한<span class="w"> </span>태그와<span class="w"> </span>함께<span class="w"> </span>사용자와<span class="w"> </span>어시스턴트<span class="w"> </span>메시지를<span class="w"> </span>반복하는<span class="w"> </span>형식일<span class="w"> </span>수<span class="w"> </span>있습니다.<span class="w"> </span>예를<span class="w"> </span>들어,<span class="w"> </span><span class="o">{</span>%<span class="w"> </span><span class="k">for</span><span class="w"> </span>message<span class="w"> </span><span class="k">in</span><span class="w"> </span>messages<span class="w"> </span>%<span class="o">}</span>를<span class="w"> </span>사용하고<span class="w"> </span>&lt;<span class="p">|</span>user<span class="p">|</span>&gt;,<span class="w"> </span>&lt;<span class="p">|</span>assistant<span class="p">|</span>&gt;와<span class="w"> </span>같은<span class="w"> </span>역할을<span class="w"> </span>할당하는<span class="w"> </span>것입니다.
</span><span id="__span-1-9"><a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a>
</span><span id="__span-1-10"><a id="__codelineno-1-10" name="__codelineno-1-10" href="#__codelineno-1-10"></a>메시지<span class="w"> </span>배열<span class="w"> </span>예시를<span class="w"> </span>구성하고,<span class="w"> </span>각<span class="w"> </span>역할과<span class="w"> </span>내용을<span class="w"> </span>보여주어야겠습니다.<span class="w"> </span>그런<span class="w"> </span>다음<span class="w"> </span>가상의<span class="w"> </span>템플릿을<span class="w"> </span>적용하여<span class="w"> </span>모델이<span class="w"> </span>사용하는<span class="w"> </span>형식화된<span class="w"> </span>문자열로<span class="w"> </span>변환하는<span class="w"> </span>과정을<span class="w"> </span>보여줍니다.<span class="w"> </span>또한,<span class="w"> </span>모델마다<span class="w"> </span>특수<span class="w"> </span>토큰을<span class="w"> </span>사용하거나<span class="w"> </span>역할<span class="w"> </span>레이블이<span class="w"> </span>다른<span class="w"> </span>것처럼<span class="w"> </span>템플릿<span class="w"> </span>요구<span class="w"> </span>사항이<span class="w"> </span>다르다는<span class="w"> </span>점도<span class="w"> </span>언급해야<span class="w"> </span>합니다.
</span><span id="__span-1-11"><a id="__codelineno-1-11" name="__codelineno-1-11" href="#__codelineno-1-11"></a>
</span><span id="__span-1-12"><a id="__codelineno-1-12" name="__codelineno-1-12" href="#__codelineno-1-12"></a>잠깐,<span class="w"> </span>사용자가<span class="w"> </span><span class="s2">&quot;채팅 템플릿&quot;</span>을<span class="w"> </span>보여주는<span class="w"> </span>맥락에서<span class="w"> </span>언급했습니다.<span class="w"> </span>아마도<span class="w"> </span>발표할<span class="w"> </span>수<span class="w"> </span>있는<span class="w"> </span>실용적인<span class="w"> </span>예시를<span class="w"> </span>원하는<span class="w"> </span>것일<span class="w"> </span>수<span class="w"> </span>있습니다.<span class="w"> </span>따라서<span class="w"> </span>코드<span class="w"> </span>스니펫이나<span class="w"> </span>구조화된<span class="w"> </span>데이터<span class="w"> </span>예시를<span class="w"> </span>제공하는<span class="w"> </span>것이<span class="w"> </span>도움이<span class="w"> </span>될<span class="w"> </span>것입니다.<span class="w"> </span>일반적인<span class="w"> </span>메시지<span class="w"> </span>배열과<span class="w"> </span>템플릿이<span class="w"> </span>적용된<span class="w"> </span>결과물을<span class="w"> </span>개략적으로<span class="w"> </span>설명해<span class="w"> </span>보겠습니다.
</span><span id="__span-1-13"><a id="__codelineno-1-13" name="__codelineno-1-13" href="#__codelineno-1-13"></a>
</span><span id="__span-1-14"><a id="__codelineno-1-14" name="__codelineno-1-14" href="#__codelineno-1-14"></a>또한,<span class="w"> </span>적절한<span class="w"> </span>템플릿팅은<span class="w"> </span>모델이<span class="w"> </span>대화<span class="w"> </span>흐름을<span class="w"> </span>이해하도록<span class="w"> </span>보장하며,<span class="w"> </span>이는<span class="w"> </span>일관된<span class="w"> </span>응답을<span class="w"> </span>생성하는<span class="w"> </span>데<span class="w"> </span>중요합니다.<span class="w"> </span>왜<span class="w"> </span>이것이<span class="w"> </span>중요한지에<span class="w"> </span>대한<span class="w"> </span>메모,<span class="w"> </span>예를<span class="w"> </span>들어<span class="w"> </span>컨텍스트<span class="w"> </span>유지<span class="w"> </span>및<span class="w"> </span>역할별<span class="w"> </span>처리의<span class="w"> </span>중요성을<span class="w"> </span>포함할<span class="w"> </span>수도<span class="w"> </span>있겠습니다.
</span><span id="__span-1-15"><a id="__codelineno-1-15" name="__codelineno-1-15" href="#__codelineno-1-15"></a>
</span><span id="__span-1-16"><a id="__codelineno-1-16" name="__codelineno-1-16" href="#__codelineno-1-16"></a>흔한<span class="w"> </span>실수나<span class="w"> </span>피해야<span class="w"> </span>할<span class="w"> </span>점이<span class="w"> </span>있는지<span class="w"> </span>확인해<span class="w"> </span>보겠습니다.<span class="w"> </span>예를<span class="w"> </span>들어,<span class="w"> </span>태그를<span class="w"> </span>제대로<span class="w"> </span>닫지<span class="w"> </span>않거나<span class="w"> </span>역할이<span class="w"> </span>일치하지<span class="w"> </span>않는<span class="w"> </span>경우입니다.<span class="w"> </span>하지만<span class="w"> </span>사용자가<span class="w"> </span>묻지<span class="w"> </span>않는<span class="w"> </span>한<span class="w"> </span>너무<span class="w"> </span>자세할<span class="w"> </span>수<span class="w"> </span>있습니다.<span class="w"> </span>먼저<span class="w"> </span>긍정적인<span class="w"> </span>예시에<span class="w"> </span>집중합시다.
</span><span id="__span-1-17"><a id="__codelineno-1-17" name="__codelineno-1-17" href="#__codelineno-1-17"></a>
</span><span id="__span-1-18"><a id="__codelineno-1-18" name="__codelineno-1-18" href="#__codelineno-1-18"></a>모든<span class="w"> </span>것을<span class="w"> </span>종합하면,<span class="w"> </span>응답에는<span class="w"> </span>예시<span class="w"> </span>메시지<span class="w"> </span>배열,<span class="w"> </span>적용된<span class="w"> </span>템플릿,<span class="w"> </span>그리고<span class="w"> </span>최종적으로<span class="w"> </span>형식화된<span class="w"> </span>문자열이<span class="w"> </span>포함되어야<span class="w"> </span>합니다.<span class="w"> </span>자리<span class="w"> </span>표시자로<span class="w"> </span>꺾쇠괄호나<span class="w"> </span>특수<span class="w"> </span>토큰을<span class="w"> </span>사용할<span class="w"> </span>수<span class="w"> </span>있습니다.<span class="w"> </span>또한,<span class="w"> </span>이것이<span class="w"> </span>구조화된<span class="w"> </span>데이터로<span class="w"> </span>모델을<span class="w"> </span>훈련하거나<span class="w"> </span>파인튜닝하는<span class="w"> </span>데<span class="w"> </span>도움이<span class="w"> </span>된다는<span class="w"> </span>점도<span class="w"> </span>언급해야<span class="w"> </span>합니다.
</span><span id="__span-1-19"><a id="__codelineno-1-19" name="__codelineno-1-19" href="#__codelineno-1-19"></a>
</span><span id="__span-1-20"><a id="__codelineno-1-20" name="__codelineno-1-20" href="#__codelineno-1-20"></a>이것이<span class="w"> </span>확실한<span class="w"> </span>접근<span class="w"> </span>방식인<span class="w"> </span>것<span class="w"> </span>같습니다.<span class="w"> </span>명확하게<span class="w"> </span>만들기<span class="w"> </span>위해<span class="w"> </span>단계별로<span class="w"> </span>구조화해<span class="w"> </span>보겠습니다.
</span><span id="__span-1-21"><a id="__codelineno-1-21" name="__codelineno-1-21" href="#__codelineno-1-21"></a>&lt;/think&gt;
</span><span id="__span-1-22"><a id="__codelineno-1-22" name="__codelineno-1-22" href="#__codelineno-1-22"></a>
</span><span id="__span-1-23"><a id="__codelineno-1-23" name="__codelineno-1-23" href="#__codelineno-1-23"></a>채팅<span class="w"> </span>템플릿은<span class="w"> </span>대화<span class="w"> </span>데이터<span class="o">(</span>예:<span class="w"> </span>사용자/어시스턴트<span class="w"> </span>상호작용<span class="o">)</span>를<span class="w"> </span>언어<span class="w"> </span>모델이<span class="w"> </span>이해할<span class="w"> </span>수<span class="w"> </span>있는<span class="w"> </span>형식으로<span class="w"> </span>구조화하는<span class="w"> </span>방법입니다.<span class="w"> </span>이는<span class="w"> </span>특히<span class="w"> </span>입력에서<span class="w"> </span>역할<span class="o">(</span>사용자,<span class="w"> </span>어시스턴트,<span class="w"> </span>시스템<span class="w"> </span>등<span class="o">)</span>과<span class="w"> </span>메시지를<span class="w"> </span>명시적으로<span class="w"> </span>구분해야<span class="w"> </span>하는<span class="w"> </span>다중<span class="w"> </span>턴<span class="w"> </span>대화를<span class="w"> </span>처리하도록<span class="w"> </span>훈련된<span class="w"> </span>모델에<span class="w"> </span>중요합니다.<span class="w"> </span>예시와<span class="w"> </span>함께<span class="w"> </span>자세히<span class="w"> </span>살펴보겠습니다!
</span><span id="__span-1-24"><a id="__codelineno-1-24" name="__codelineno-1-24" href="#__codelineno-1-24"></a>
</span><span id="__span-1-25"><a id="__codelineno-1-25" name="__codelineno-1-25" href="#__codelineno-1-25"></a>---
</span><span id="__span-1-26"><a id="__codelineno-1-26" name="__codelineno-1-26" href="#__codelineno-1-26"></a>
</span><span id="__span-1-27"><a id="__codelineno-1-27" name="__codelineno-1-27" href="#__codelineno-1-27"></a><span class="c1">### **1단계: 원본 대화 기록**</span>
</span><span id="__span-1-28"><a id="__codelineno-1-28" name="__codelineno-1-28" href="#__codelineno-1-28"></a>다음과<span class="w"> </span>같은<span class="w"> </span>대화가<span class="w"> </span>있다고<span class="w"> </span>가정해<span class="w"> </span>보겠습니다:
</span><span id="__span-1-29"><a id="__codelineno-1-29" name="__codelineno-1-29" href="#__codelineno-1-29"></a>-<span class="w"> </span>**사용자**:<span class="w"> </span><span class="s2">&quot;안녕하세요, 어떻게 지내세요?&quot;</span>
</span><span id="__span-1-30"><a id="__codelineno-1-30" name="__codelineno-1-30" href="#__codelineno-1-30"></a>-<span class="w"> </span>**어시스턴트**:<span class="w"> </span><span class="s2">&quot;저는 잘 지내요. 오늘 무엇을 도와드릴까요?&quot;</span>
</span><span id="__span-1-31"><a id="__codelineno-1-31" name="__codelineno-1-31" href="#__codelineno-1-31"></a>-<span class="w"> </span>**사용자**:<span class="w"> </span><span class="s2">&quot;채팅 템플릿이 어떻게 작동하는지 보여주고 싶어요!&quot;</span>
</span><span id="__span-1-32"><a id="__codelineno-1-32" name="__codelineno-1-32" href="#__codelineno-1-32"></a>
</span><span id="__span-1-33"><a id="__codelineno-1-33" name="__codelineno-1-33" href="#__codelineno-1-33"></a>---
</span><span id="__span-1-34"><a id="__codelineno-1-34" name="__codelineno-1-34" href="#__codelineno-1-34"></a>
</span><span id="__span-1-35"><a id="__codelineno-1-35" name="__codelineno-1-35" href="#__codelineno-1-35"></a><span class="c1">### **2단계: 구조화된 메시지**</span>
</span><span id="__span-1-36"><a id="__codelineno-1-36" name="__codelineno-1-36" href="#__codelineno-1-36"></a>Hugging<span class="w"> </span>Face<span class="w"> </span>Transformers나<span class="w"> </span>OpenAI<span class="w"> </span>같은<span class="w"> </span>프레임워크에서는<span class="w"> </span>대화가<span class="w"> </span>종종<span class="w"> </span><span class="sb">`</span>role<span class="sb">`</span>과<span class="w"> </span><span class="sb">`</span>content<span class="sb">`</span>를<span class="w"> </span>가진<span class="w"> </span>딕셔너리<span class="w"> </span>리스트로<span class="w"> </span>형식화됩니다.
</span><span id="__span-1-37"><a id="__codelineno-1-37" name="__codelineno-1-37" href="#__codelineno-1-37"></a><span class="sb">```</span>python
</span><span id="__span-1-38"><a id="__codelineno-1-38" name="__codelineno-1-38" href="#__codelineno-1-38"></a><span class="nv">messages</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">[</span>
</span><span id="__span-1-39"><a id="__codelineno-1-39" name="__codelineno-1-39" href="#__codelineno-1-39"></a><span class="w">    </span><span class="o">{</span><span class="s2">&quot;role&quot;</span>:<span class="w"> </span><span class="s2">&quot;user&quot;</span>,<span class="w"> </span><span class="s2">&quot;content&quot;</span>:<span class="w"> </span><span class="s2">&quot;안녕하세요, 어떻게 지내세요?&quot;</span><span class="o">}</span>,
</span><span id="__span-1-40"><a id="__codelineno-1-40" name="__codelineno-1-40" href="#__codelineno-1-40"></a><span class="w">    </span><span class="o">{</span><span class="s2">&quot;role&quot;</span>:<span class="w"> </span><span class="s2">&quot;assistant&quot;</span>,<span class="w"> </span><span class="s2">&quot;content&quot;</span>:<span class="w"> </span><span class="s2">&quot;저는 잘 지내요. 오늘 무엇을 도와드릴까요?&quot;</span><span class="o">}</span>,
</span><span id="__span-1-41"><a id="__codelineno-1-41" name="__codelineno-1-41" href="#__codelineno-1-41"></a><span class="w">    </span><span class="o">{</span><span class="s2">&quot;role&quot;</span>:<span class="w"> </span><span class="s2">&quot;user&quot;</span>,<span class="w"> </span><span class="s2">&quot;content&quot;</span>:<span class="w"> </span><span class="s2">&quot;채팅 템플릿이 어떻게 작동하는지 보여주고 싶어요!&quot;</span><span class="o">}</span>,
</span><span id="__span-1-42"><a id="__codelineno-1-42" name="__codelineno-1-42" href="#__codelineno-1-42"></a><span class="o">]</span>
</span><span id="__span-1-43"><a id="__codelineno-1-43" name="__codelineno-1-43" href="#__codelineno-1-43"></a><span class="sb">```</span>
</span><span id="__span-1-44"><a id="__codelineno-1-44" name="__codelineno-1-44" href="#__codelineno-1-44"></a>
</span><span id="__span-1-45"><a id="__codelineno-1-45" name="__codelineno-1-45" href="#__codelineno-1-45"></a>---
</span><span id="__span-1-46"><a id="__codelineno-1-46" name="__codelineno-1-46" href="#__codelineno-1-46"></a>
</span><span id="__span-1-47"><a id="__codelineno-1-47" name="__codelineno-1-47" href="#__codelineno-1-47"></a><span class="c1">### **3단계: 채팅 템플릿 적용**</span>
</span><span id="__span-1-48"><a id="__codelineno-1-48" name="__codelineno-1-48" href="#__codelineno-1-48"></a>**채팅<span class="w"> </span>템플릿**은<span class="w"> </span>이<span class="w"> </span>구조화된<span class="w"> </span>데이터를<span class="w"> </span>모델에<span class="w"> </span>맞는<span class="w"> </span>단일<span class="w"> </span>문자열로<span class="w"> </span>변환합니다.<span class="w"> </span>예를<span class="w"> </span>들어,<span class="w"> </span><span class="o">(</span>Hugging<span class="w"> </span>Face에서<span class="w"> </span>흔히<span class="w"> </span>사용되는<span class="o">)</span><span class="w"> </span>Jinja<span class="w"> </span>스타일<span class="w"> </span>템플릿을<span class="w"> </span>사용하면<span class="w"> </span>다음과<span class="w"> </span>같습니다.
</span><span id="__span-1-49"><a id="__codelineno-1-49" name="__codelineno-1-49" href="#__codelineno-1-49"></a>
</span><span id="__span-1-50"><a id="__codelineno-1-50" name="__codelineno-1-50" href="#__codelineno-1-50"></a><span class="sb">```</span>jinja
</span><span id="__span-1-51"><a id="__codelineno-1-51" name="__codelineno-1-51" href="#__codelineno-1-51"></a><span class="o">{</span>%<span class="w"> </span><span class="k">for</span><span class="w"> </span>message<span class="w"> </span><span class="k">in</span><span class="w"> </span>messages<span class="w"> </span>%<span class="o">}</span>
</span><span id="__span-1-52"><a id="__codelineno-1-52" name="__codelineno-1-52" href="#__codelineno-1-52"></a><span class="w">    </span><span class="o">{</span>%<span class="w"> </span><span class="k">if</span><span class="w"> </span>message<span class="o">[</span><span class="s1">&#39;role&#39;</span><span class="o">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;user&#39;</span><span class="w"> </span>%<span class="o">}</span>
</span><span id="__span-1-53"><a id="__codelineno-1-53" name="__codelineno-1-53" href="#__codelineno-1-53"></a><span class="w">        </span>&lt;<span class="p">|</span>user<span class="p">|</span>&gt;<span class="o">{{</span><span class="w"> </span>message<span class="o">[</span><span class="s1">&#39;content&#39;</span><span class="o">]</span><span class="w"> </span><span class="o">}}</span>&lt;<span class="p">|</span>end<span class="p">|</span>&gt;
</span><span id="__span-1-54"><a id="__codelineno-1-54" name="__codelineno-1-54" href="#__codelineno-1-54"></a><span class="w">    </span><span class="o">{</span>%<span class="w"> </span><span class="k">elif</span><span class="w"> </span>message<span class="o">[</span><span class="s1">&#39;role&#39;</span><span class="o">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;assistant&#39;</span><span class="w"> </span>%<span class="o">}</span>
</span><span id="__span-1-55"><a id="__codelineno-1-55" name="__codelineno-1-55" href="#__codelineno-1-55"></a><span class="w">        </span>&lt;<span class="p">|</span>assistant<span class="p">|</span>&gt;<span class="o">{{</span><span class="w"> </span>message<span class="o">[</span><span class="s1">&#39;content&#39;</span><span class="o">]</span><span class="w"> </span><span class="o">}}</span>&lt;<span class="p">|</span>end<span class="p">|</span>&gt;
</span><span id="__span-1-56"><a id="__codelineno-1-56" name="__codelineno-1-56" href="#__codelineno-1-56"></a><span class="w">    </span><span class="o">{</span>%<span class="w"> </span>endif<span class="w"> </span>%<span class="o">}</span>
</span><span id="__span-1-57"><a id="__codelineno-1-57" name="__codelineno-1-57" href="#__codelineno-1-57"></a><span class="o">{</span>%<span class="w"> </span>endfor<span class="w"> </span>%<span class="o">}</span>
</span><span id="__span-1-58"><a id="__codelineno-1-58" name="__codelineno-1-58" href="#__codelineno-1-58"></a>&lt;<span class="p">|</span>assistant<span class="p">|</span>&gt;
</span><span id="__span-1-59"><a id="__codelineno-1-59" name="__codelineno-1-59" href="#__codelineno-1-59"></a><span class="sb">```</span>
</span><span id="__span-1-60"><a id="__codelineno-1-60" name="__codelineno-1-60" href="#__codelineno-1-60"></a>
</span><span id="__span-1-61"><a id="__codelineno-1-61" name="__codelineno-1-61" href="#__codelineno-1-61"></a>---
</span><span id="__span-1-62"><a id="__codelineno-1-62" name="__codelineno-1-62" href="#__codelineno-1-62"></a>
</span><span id="__span-1-63"><a id="__codelineno-1-63" name="__codelineno-1-63" href="#__codelineno-1-63"></a><span class="c1">### **4단계: 최종 템플릿 결과물**</span>
</span><span id="__span-1-64"><a id="__codelineno-1-64" name="__codelineno-1-64" href="#__codelineno-1-64"></a>위<span class="w"> </span>템플릿을<span class="w"> </span>저희<span class="w"> </span><span class="sb">`</span>messages<span class="sb">`</span><span class="w"> </span>리스트에<span class="w"> </span>적용하면<span class="w"> </span>다음과<span class="w"> </span>같은<span class="w"> </span>결과가<span class="w"> </span>생성됩니다:
</span><span id="__span-1-65"><a id="__codelineno-1-65" name="__codelineno-1-65" href="#__codelineno-1-65"></a><span class="sb">```</span>text
</span><span id="__span-1-66"><a id="__codelineno-1-66" name="__codelineno-1-66" href="#__codelineno-1-66"></a>&lt;<span class="p">|</span>user<span class="p">|</span>&gt;안녕하세요,<span class="w"> </span>어떻게<span class="w"> </span>지내세요?&lt;<span class="p">|</span>end<span class="p">|</span>&gt;
</span><span id="__span-1-67"><a id="__codelineno-1-67" name="__codelineno-1-67" href="#__codelineno-1-67"></a>&lt;<span class="p">|</span>assistant<span class="p">|</span>&gt;저는<span class="w"> </span>잘<span class="w"> </span>지내요.<span class="w"> </span>오늘<span class="w"> </span>무엇을<span class="w"> </span>도와드릴까요?&lt;<span class="p">|</span>end<span class="p">|</span>&gt;
</span><span id="__span-1-68"><a id="__codelineno-1-68" name="__codelineno-1-68" href="#__codelineno-1-68"></a>&lt;<span class="p">|</span>user<span class="p">|</span>&gt;채팅<span class="w"> </span>템플릿이<span class="w"> </span>어떻게<span class="w"> </span>작동하는지<span class="w"> </span>보여주고<span class="w"> </span>싶어요!&lt;<span class="p">|</span>end<span class="p">|</span>&gt;
</span><span id="__span-1-69"><a id="__codelineno-1-69" name="__codelineno-1-69" href="#__codelineno-1-69"></a>&lt;<span class="p">|</span>assistant<span class="p">|</span>&gt;
</span><span id="__span-1-70"><a id="__codelineno-1-70" name="__codelineno-1-70" href="#__codelineno-1-70"></a><span class="sb">```</span>
</span><span id="__span-1-71"><a id="__codelineno-1-71" name="__codelineno-1-71" href="#__codelineno-1-71"></a>
</span><span id="__span-1-72"><a id="__codelineno-1-72" name="__codelineno-1-72" href="#__codelineno-1-72"></a>이는<span class="w"> </span>모델에게<span class="w"> </span>다음을<span class="w"> </span>알려줍니다:
</span><span id="__span-1-73"><a id="__codelineno-1-73" name="__codelineno-1-73" href="#__codelineno-1-73"></a><span class="m">1</span>.<span class="w"> </span>대화<span class="w"> </span>기록<span class="w"> </span><span class="o">(</span>사용자/어시스턴트<span class="w"> </span>턴<span class="o">)</span>.
</span><span id="__span-1-74"><a id="__codelineno-1-74" name="__codelineno-1-74" href="#__codelineno-1-74"></a><span class="m">2</span>.<span class="w"> </span>모델이<span class="w"> </span>응답을<span class="w"> </span>생성할<span class="w"> </span>차례<span class="w"> </span><span class="o">(</span><span class="sb">`</span>&lt;<span class="p">|</span>assistant<span class="p">|</span>&gt;<span class="sb">`</span>가<span class="w"> </span>끝에<span class="w"> </span>있음<span class="o">)</span>.
</span><span id="__span-1-75"><a id="__codelineno-1-75" name="__codelineno-1-75" href="#__codelineno-1-75"></a>
</span><span id="__span-1-76"><a id="__codelineno-1-76" name="__codelineno-1-76" href="#__codelineno-1-76"></a>---
</span><span id="__span-1-77"><a id="__codelineno-1-77" name="__codelineno-1-77" href="#__codelineno-1-77"></a>
</span><span id="__span-1-78"><a id="__codelineno-1-78" name="__codelineno-1-78" href="#__codelineno-1-78"></a><span class="c1">### **주요 참고사항**:</span>
</span><span id="__span-1-79"><a id="__codelineno-1-79" name="__codelineno-1-79" href="#__codelineno-1-79"></a>-<span class="w"> </span>**역할<span class="w"> </span>분리**:<span class="w"> </span><span class="sb">`</span>&lt;<span class="p">|</span>user<span class="p">|</span>&gt;<span class="sb">`</span>와<span class="w"> </span><span class="sb">`</span>&lt;<span class="p">|</span>assistant<span class="p">|</span>&gt;<span class="sb">`</span><span class="w"> </span>같은<span class="w"> </span>태그는<span class="w"> </span>모델이<span class="w"> </span>화자를<span class="w"> </span>구별하는<span class="w"> </span>데<span class="w"> </span>도움이<span class="w"> </span>됩니다.
</span><span id="__span-1-80"><a id="__codelineno-1-80" name="__codelineno-1-80" href="#__codelineno-1-80"></a>-<span class="w"> </span>**특수<span class="w"> </span>토큰**:<span class="w"> </span>모델은<span class="w"> </span>종종<span class="w"> </span>메시지<span class="w"> </span>경계를<span class="w"> </span>표시하기<span class="w"> </span>위해<span class="w"> </span><span class="sb">`</span>&lt;<span class="p">|</span>end<span class="p">|</span>&gt;<span class="sb">`</span>와<span class="w"> </span>같은<span class="w"> </span>고유한<span class="w"> </span>토큰을<span class="w"> </span>사용합니다.
</span><span id="__span-1-81"><a id="__codelineno-1-81" name="__codelineno-1-81" href="#__codelineno-1-81"></a>-<span class="w"> </span>**유연성**:<span class="w"> </span>템플릿은<span class="w"> </span>모델마다<span class="w"> </span>다릅니다<span class="w"> </span><span class="o">(</span>예:<span class="w"> </span>OpenAI는<span class="w"> </span>태그<span class="w"> </span>대신<span class="w"> </span><span class="sb">`</span><span class="o">{</span><span class="s2">&quot;role&quot;</span>:<span class="w"> </span><span class="s2">&quot;user&quot;</span>,<span class="w"> </span><span class="s2">&quot;content&quot;</span>:<span class="w"> </span><span class="s2">&quot;...&quot;</span><span class="o">}</span><span class="sb">`</span><span class="w"> </span>형식을<span class="w"> </span>사용합니다<span class="o">)</span>.
</span><span id="__span-1-82"><a id="__codelineno-1-82" name="__codelineno-1-82" href="#__codelineno-1-82"></a>
</span><span id="__span-1-83"><a id="__codelineno-1-83" name="__codelineno-1-83" href="#__codelineno-1-83"></a>---
</span><span id="__span-1-84"><a id="__codelineno-1-84" name="__codelineno-1-84" href="#__codelineno-1-84"></a>
</span><span id="__span-1-85"><a id="__codelineno-1-85" name="__codelineno-1-85" href="#__codelineno-1-85"></a><span class="c1">### **이것이 왜 중요한가**:</span>
</span><span id="__span-1-86"><a id="__codelineno-1-86" name="__codelineno-1-86" href="#__codelineno-1-86"></a>-<span class="w"> </span>**일관성**:<span class="w"> </span>모델이<span class="w"> </span>대화<span class="w"> </span>구조를<span class="w"> </span>이해하도록<span class="w"> </span>보장합니다.
</span><span id="__span-1-87"><a id="__codelineno-1-87" name="__codelineno-1-87" href="#__codelineno-1-87"></a>-<span class="w"> </span>**컨텍스트<span class="w"> </span>보존**:<span class="w"> </span>다중<span class="w"> </span>턴<span class="w"> </span>대화의<span class="w"> </span>흐름을<span class="w"> </span>유지합니다.
</span><span id="__span-1-88"><a id="__codelineno-1-88" name="__codelineno-1-88" href="#__codelineno-1-88"></a>-<span class="w"> </span>**정렬**:<span class="w"> </span>더<span class="w"> </span>나은<span class="w"> </span>성능을<span class="w"> </span>위해<span class="w"> </span>모델이<span class="w"> </span>훈련된<span class="w"> </span>형식과<span class="w"> </span>일치시킵니다.
</span><span id="__span-1-89"><a id="__codelineno-1-89" name="__codelineno-1-89" href="#__codelineno-1-89"></a>
</span><span id="__span-1-90"><a id="__codelineno-1-90" name="__codelineno-1-90" href="#__codelineno-1-90"></a>더<span class="w"> </span>자세히<span class="w"> </span>알아보거나<span class="w"> </span>특정<span class="w"> </span>프레임워크<span class="o">(</span>예:<span class="w"> </span>OpenAI,<span class="w"> </span>Llama,<span class="w"> </span>Mistral<span class="o">)</span>의<span class="w"> </span>구현을<span class="w"> </span>보고<span class="w"> </span>싶으신가요?<span class="w"> </span>알려주세요!<span class="w"> </span>😊&lt;｜end<span class="w"> </span>of<span class="w"> </span>sentence｜&gt;
</span></code></pre></div>
<p>다음을 사용하여 실행하세요
<div class="language-bash highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>torchrun<span class="w"> </span>--nproc_per_node<span class="o">=</span><span class="m">8</span><span class="w"> </span>--nnodes<span class="o">=</span><span class="m">2</span><span class="w"> </span>--node_rank<span class="o">=</span><span class="m">0</span><span class="p">|</span><span class="m">1</span><span class="w"> </span>--rdzv-id<span class="w"> </span>an_id<span class="w"> </span>--rdzv-backend<span class="w"> </span>c10d<span class="w"> </span>--rdzv-endpoint<span class="w"> </span>master_addr:master_port<span class="w"> </span>run_deepseek_r1.py
</span></code></pre></div></p>
<p>만약 다음과 같은
<div class="language-bash highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="o">[</span>rank0<span class="o">]</span>:<span class="w"> </span>ncclInternalError:<span class="w"> </span>Internal<span class="w"> </span>check<span class="w"> </span>failed.
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="o">[</span>rank0<span class="o">]</span>:<span class="w"> </span>Last<span class="w"> </span>error:
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a><span class="o">[</span>rank0<span class="o">]</span>:<span class="w"> </span>Bootstrap<span class="w"> </span>:<span class="w"> </span>no<span class="w"> </span>socket<span class="w"> </span>interface<span class="w"> </span>found
</span></code></pre></div>
오류가 발생한다면, NCCL이 로드되지 않았을 가능성이 높다는 의미입니다.</p>
<h2 id="deepseekv3configdeepseekv3config">DeepseekV3Config[[deepseekv3config]]</h2>
<p>[[autodoc]] DeepseekV3Config</p>
<h2 id="deepseekv3modeldeepseekv3model">DeepseekV3Model[[deepseekv3model]]</h2>
<p>[[autodoc]] DeepseekV3Model
    - forward</p>
<h2 id="deepseekv3forcausallmdeepseekv3forcausallm">DeepseekV3ForCausalLM[[deepseekv3forcausallm]]</h2>
<p>[[autodoc]] DeepseekV3ForCausalLM
    - forward</p>












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../../../../../../..", "features": ["navigation.tabs", "navigation.indexes", "navigation.instant", "navigation.sections", "navigation.top", "navigation.tracking", "search.highlight", "search.share", "search.suggest", "toc.follow", "content.tabs.link", "content.code.copy"], "search": "../../../../../../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../../../../../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
    
  </body>
</html>