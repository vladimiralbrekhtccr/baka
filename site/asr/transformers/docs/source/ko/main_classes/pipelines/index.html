
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      
      
      <link rel="icon" href="../../../../../../../assets/favicon.ico">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.22">
    
    
      
        <title>Pipelines - Ohayou</title>
      
    
    
      <link rel="stylesheet" href="../../../../../../../assets/stylesheets/main.84d31ad4.min.css">
      
        
        <link rel="stylesheet" href="../../../../../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../../../../../assets/extra.css">
    
    <script>__md_scope=new URL("../../../../../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#pipelines" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../../../../.." title="Ohayou" class="md-header__button md-logo" aria-label="Ohayou" data-md-component="logo">
      
  <img src="../../../../../../../assets/logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Ohayou
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Pipelines
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../../../../ohayou/" class="md-tabs__link">
        
  
  
    
  
  Ohayou

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../../../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../../../../vllm/open_ai_vllm_example_a_v_t/" class="md-tabs__link">
          
  
  
    
  
  vLLM

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../../../../llm/speculative_decoding/" class="md-tabs__link">
          
  
  
    
  
  LLM

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../../../../vlm/qwen3_vl_4B_object_detection/" class="md-tabs__link">
          
  
  
    
  
  VLM

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../../../../md_format_helpers/" class="md-tabs__link">
        
  
  
    
  
  MD format helpers

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../../../../docker/" class="md-tabs__link">
        
  
  
    
  
  Docker

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../../../../linux/" class="md-tabs__link">
        
  
  
    
  
  Linux

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../../../../moe/" class="md-tabs__link">
        
  
  
    
  
  Mixture of Experts

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../../../../slurm/" class="md-tabs__link">
        
  
  
    
  
  Slurm

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../../../../japanese-phrases/" class="md-tabs__link">
          
  
  
    
  
  Japanese Phrases

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../../../../hackathon/index.md" class="md-tabs__link">
        
  
  
    
  
  Hack

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../../../../.." title="Ohayou" class="md-nav__button md-logo" aria-label="Ohayou" data-md-component="logo">
      
  <img src="../../../../../../../assets/logo.png" alt="logo">

    </a>
    Ohayou
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../ohayou/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Ohayou
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    vLLM
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            vLLM
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../vllm/open_ai_vllm_example_a_v_t/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Single Request
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../vllm/bash_vllm_serve/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Bash online serve
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../vllm/benchmarks/performance_eval/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Benchmarks
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    LLM
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            LLM
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../llm/speculative_decoding/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Speculative Decoding
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    VLM
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            VLM
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../vlm/qwen3_vl_4B_object_detection/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Qwen3VL_adema_grounding
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../vlm/qwen3_vla_4B_audio_training_aspandiyar/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Qwen3VLA_aspandiyar_thinking
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../md_format_helpers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    MD format helpers
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../docker/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Docker
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../linux/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Linux
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../moe/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Mixture of Experts
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../slurm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Slurm
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../../../../japanese-phrases/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Japanese Phrases
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_11" id="__nav_11_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_11">
            <span class="md-nav__icon md-icon"></span>
            Japanese Phrases
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11_2" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../../../../japanese-phrases/daily-life/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Daily Life
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_11_2" id="__nav_11_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_11_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_11_2">
            <span class="md-nav__icon md-icon"></span>
            Daily Life
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../japanese-phrases/daily-life/shopping/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Shopping
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11_3" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../../../../japanese-phrases/greetings/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Greetings
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_11_3" id="__nav_11_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_11_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_11_3">
            <span class="md-nav__icon md-icon"></span>
            Greetings
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../japanese-phrases/greetings/casual/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Casual
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../japanese-phrases/emotions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Emotions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../japanese-phrases/anime-manga/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Anime/Manga
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../hackathon/index.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Hack
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#the-pipeline-abstraction" class="md-nav__link">
    <span class="md-ellipsis">
      파이프라인 추상화 [[the-pipeline-abstraction]]
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pipeline-batching" class="md-nav__link">
    <span class="md-ellipsis">
      파이프라인 배치 처리 [[pipeline-batching]]
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pipeline-chunk-batching" class="md-nav__link">
    <span class="md-ellipsis">
      파이프라인 청크 배치 처리 [[pipeline-chunk-batching]]
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fp16-pipeline-fp16-inference" class="md-nav__link">
    <span class="md-ellipsis">
      파이프라인 FP16 추론 [[pipeline-fp16-inference]]
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pipeline-custom-code" class="md-nav__link">
    <span class="md-ellipsis">
      파이프라인 사용자 정의 코드 [[pipeline-custom-code]]
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#implementing-a-pipeline" class="md-nav__link">
    <span class="md-ellipsis">
      파이프라인 구현하기 [[implementing-a-pipeline]]
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#audio" class="md-nav__link">
    <span class="md-ellipsis">
      오디오 [[audio]]
    </span>
  </a>
  
    <nav class="md-nav" aria-label="오디오 [[audio]]">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#audioclassificationpipeline-transformersaudioclassificationpipeline" class="md-nav__link">
    <span class="md-ellipsis">
      AudioClassificationPipeline [[transformers.AudioClassificationPipeline]]
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#automaticspeechrecognitionpipeline-transformersautomaticspeechrecognitionpipeline" class="md-nav__link">
    <span class="md-ellipsis">
      AutomaticSpeechRecognitionPipeline [[transformers.AutomaticSpeechRecognitionPipeline]]
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#texttoaudiopipeline-transformerstexttoaudiopipeline" class="md-nav__link">
    <span class="md-ellipsis">
      TextToAudioPipeline [[transformers.TextToAudioPipeline]]
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zeroshotaudioclassificationpipeline-transformerszeroshotaudioclassificationpipeline" class="md-nav__link">
    <span class="md-ellipsis">
      ZeroShotAudioClassificationPipeline [[transformers.ZeroShotAudioClassificationPipeline]]
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#computer-vision" class="md-nav__link">
    <span class="md-ellipsis">
      컴퓨터 비전 [[computer-vision]]
    </span>
  </a>
  
    <nav class="md-nav" aria-label="컴퓨터 비전 [[computer-vision]]">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#depthestimationpipeline-transformersdepthestimationpipeline" class="md-nav__link">
    <span class="md-ellipsis">
      DepthEstimationPipeline [[transformers.DepthEstimationPipeline]]
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#imageclassificationpipeline-transformersimageclassificationpipeline" class="md-nav__link">
    <span class="md-ellipsis">
      ImageClassificationPipeline [[transformers.ImageClassificationPipeline]]
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#imagesegmentationpipeline-transformersimagesegmentationpipeline" class="md-nav__link">
    <span class="md-ellipsis">
      ImageSegmentationPipeline [[transformers.ImageSegmentationPipeline]]
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#imagetoimagepipeline-transformersimagetoimagepipeline" class="md-nav__link">
    <span class="md-ellipsis">
      ImageToImagePipeline [[transformers.ImageToImagePipeline]]
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#objectdetectionpipeline-transformersobjectdetectionpipeline" class="md-nav__link">
    <span class="md-ellipsis">
      ObjectDetectionPipeline [[transformers.ObjectDetectionPipeline]]
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#videoclassificationpipeline-transformersvideoclassificationpipeline" class="md-nav__link">
    <span class="md-ellipsis">
      VideoClassificationPipeline [[transformers.VideoClassificationPipeline]]
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zeroshotimageclassificationpipeline-transformerszeroshotimageclassificationpipeline" class="md-nav__link">
    <span class="md-ellipsis">
      ZeroShotImageClassificationPipeline [[transformers.ZeroShotImageClassificationPipeline]]
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zeroshotobjectdetectionpipeline-transformerszeroshotobjectdetectionpipeline" class="md-nav__link">
    <span class="md-ellipsis">
      ZeroShotObjectDetectionPipeline [[transformers.ZeroShotObjectDetectionPipeline]]
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#natural-language-processing" class="md-nav__link">
    <span class="md-ellipsis">
      자연어 처리 [[natural-language-processing]]
    </span>
  </a>
  
    <nav class="md-nav" aria-label="자연어 처리 [[natural-language-processing]]">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#fillmaskpipeline-transformersfillmaskpipeline" class="md-nav__link">
    <span class="md-ellipsis">
      FillMaskPipeline [[transformers.FillMaskPipeline]]
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#questionansweringpipeline-transformersquestionansweringpipeline" class="md-nav__link">
    <span class="md-ellipsis">
      QuestionAnsweringPipeline [[transformers.QuestionAnsweringPipeline]]
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#summarizationpipeline-transformerssummarizationpipeline" class="md-nav__link">
    <span class="md-ellipsis">
      SummarizationPipeline [[transformers.SummarizationPipeline]]
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tablequestionansweringpipeline-transformerstablequestionansweringpipeline" class="md-nav__link">
    <span class="md-ellipsis">
      TableQuestionAnsweringPipeline [[transformers.TableQuestionAnsweringPipeline]]
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#textclassificationpipeline-transformerstextclassificationpipeline" class="md-nav__link">
    <span class="md-ellipsis">
      TextClassificationPipeline [[transformers.TextClassificationPipeline]]
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#textgenerationpipeline-transformerstextgenerationpipeline" class="md-nav__link">
    <span class="md-ellipsis">
      TextGenerationPipeline [[transformers.TextGenerationPipeline]]
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#text2textgenerationpipeline-transformerstext2textgenerationpipeline" class="md-nav__link">
    <span class="md-ellipsis">
      Text2TextGenerationPipeline [[transformers.Text2TextGenerationPipeline]]
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tokenclassificationpipeline-transformerstokenclassificationpipeline" class="md-nav__link">
    <span class="md-ellipsis">
      TokenClassificationPipeline [[transformers.TokenClassificationPipeline]]
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#translationpipeline-transformerstranslationpipeline" class="md-nav__link">
    <span class="md-ellipsis">
      TranslationPipeline [[transformers.TranslationPipeline]]
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zeroshotclassificationpipeline-transformerszeroshotclassificationpipeline" class="md-nav__link">
    <span class="md-ellipsis">
      ZeroShotClassificationPipeline [[transformers.ZeroShotClassificationPipeline]]
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#multimodal" class="md-nav__link">
    <span class="md-ellipsis">
      멀티모달 [[multimodal]]
    </span>
  </a>
  
    <nav class="md-nav" aria-label="멀티모달 [[multimodal]]">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#documentquestionansweringpipeline-transformersdocumentquestionansweringpipeline" class="md-nav__link">
    <span class="md-ellipsis">
      DocumentQuestionAnsweringPipeline [[transformers.DocumentQuestionAnsweringPipeline]]
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#featureextractionpipeline-transformersfeatureextractionpipeline" class="md-nav__link">
    <span class="md-ellipsis">
      FeatureExtractionPipeline [[transformers.FeatureExtractionPipeline]]
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#imagefeatureextractionpipeline-transformersimagefeatureextractionpipeline" class="md-nav__link">
    <span class="md-ellipsis">
      ImageFeatureExtractionPipeline [[transformers.ImageFeatureExtractionPipeline]]
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#imagetotextpipeline-transformersimagetotextpipeline" class="md-nav__link">
    <span class="md-ellipsis">
      ImageToTextPipeline [[transformers.ImageToTextPipeline]]
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#imagetexttotextpipeline-transformersimagetexttotextpipeline" class="md-nav__link">
    <span class="md-ellipsis">
      ImageTextToTextPipeline [[transformers.ImageTextToTextPipeline]]
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#maskgenerationpipeline-transformersmaskgenerationpipeline" class="md-nav__link">
    <span class="md-ellipsis">
      MaskGenerationPipeline [[transformers.MaskGenerationPipeline]]
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#visualquestionansweringpipeline-transformersvisualquestionansweringpipeline" class="md-nav__link">
    <span class="md-ellipsis">
      VisualQuestionAnsweringPipeline [[transformers.VisualQuestionAnsweringPipeline]]
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#parent-class-pipeline-transformerspipeline" class="md-nav__link">
    <span class="md-ellipsis">
      Parent class: Pipeline [[transformers.Pipeline]]
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<!--Copyright 2020 The HuggingFace Team. All rights reserved.

Licensed under the Apache License, Version 2.0 (the "License"); you may not use this file except in compliance with
the License. You may obtain a copy of the License at

http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on
an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the
specific language governing permissions and limitations under the License.

⚠️ Note that this file is in Markdown but contain specific syntax for our doc-builder (similar to MDX) that may not be
rendered properly in your Markdown viewer.

-->

<h1 id="pipelines">파이프라인 [[pipelines]]</h1>
<p>파이프라인은 모델을 추론에 활용할 수 있는 훌륭하고 쉬운 방법입니다. 이 파이프라인은 라이브러리의 복잡한 코드를 대부분 추상화하여, 개체명 인식(Named Entity Recognition), 마스크드 언어 모델링(Masked Language Modeling), 감정 분석(Sentiment Analysis), 특성 추출(Feature Extraction), 질의응답(Question Answering) 등의 여러 작업에 특화된 간단한 API를 제공합니다. 사용 예시는 <a href="../task_summary">작업 요약</a>을 참고하세요.</p>
<p>파이프라인 추상화는 다음 두 가지 범주로 나뉩니다.</p>
<ul>
<li>[<code>파이프라인</code>]은 다른 모든 파이프라인을 캡슐화하는 가장 강력한 객체입니다.</li>
<li>작업별 파이프라인은 <a href="#audio">오디오</a>, <a href="#computer-vision">컴퓨터 비전</a>, <a href="#natural-language-processing">자연어 처리</a>, <a href="#multimodal">멀티모달</a> 작업에 사용할 수 있습니다.</li>
</ul>
<h2 id="the-pipeline-abstraction">파이프라인 추상화 [[the-pipeline-abstraction]]</h2>
<p><em>파이프라인</em> 추상화는 사용 가능한 모든 파이프라인을 감싸는 래퍼입니다. 다른 파이프라인처럼 인스턴스화되며, 추가적인 편의 기능을 제공합니다.</p>
<p>단일 항목 호출 예시:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">pipe</span> <span class="o">=</span> <span class="n">pipeline</span><span class="p">(</span><span class="s2">&quot;text-classification&quot;</span><span class="p">)</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">pipe</span><span class="p">(</span><span class="s2">&quot;This restaurant is awesome&quot;</span><span class="p">)</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="p">[{</span><span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s1">&#39;POSITIVE&#39;</span><span class="p">,</span> <span class="s1">&#39;score&#39;</span><span class="p">:</span> <span class="mf">0.9998743534088135</span><span class="p">}]</span>
</span></code></pre></div>
<p><a href="https://huggingface.co">hub</a>에서 특정 모델을 사용하려는 경우, 해당 모델이 이미 허브에 작업을 정의하고 있다면 작업명을 생략할 수 있습니다.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">pipe</span> <span class="o">=</span> <span class="n">pipeline</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="s2">&quot;FacebookAI/roberta-large-mnli&quot;</span><span class="p">)</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">pipe</span><span class="p">(</span><span class="s2">&quot;This restaurant is awesome&quot;</span><span class="p">)</span>
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="p">[{</span><span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s1">&#39;NEUTRAL&#39;</span><span class="p">,</span> <span class="s1">&#39;score&#39;</span><span class="p">:</span> <span class="mf">0.7313136458396912</span><span class="p">}]</span>
</span></code></pre></div>
<p>여러 항목을 처리하려면 <em>리스트</em>를 전달하세요.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">pipe</span> <span class="o">=</span> <span class="n">pipeline</span><span class="p">(</span><span class="s2">&quot;text-classification&quot;</span><span class="p">)</span>
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">pipe</span><span class="p">([</span><span class="s2">&quot;This restaurant is awesome&quot;</span><span class="p">,</span> <span class="s2">&quot;This restaurant is awful&quot;</span><span class="p">]</span> <span class="p">)</span>
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a><span class="p">[{</span><span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s1">&#39;POSITIVE&#39;</span><span class="p">,</span> <span class="s1">&#39;score&#39;</span><span class="p">:</span> <span class="mf">0.9998743534088135</span><span class="p">},</span>
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a> <span class="p">{</span><span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s1">&#39;NEGATIVE&#39;</span><span class="p">,</span> <span class="s1">&#39;score&#39;</span><span class="p">:</span> <span class="mf">0.9996669292449951</span><span class="p">}]</span>
</span></code></pre></div>
<p>전체 데이터셋을 순회하려면 <code>dataset</code>을 직접 사용하는 것이 좋습니다.
이렇게 하면 전체 데이터를 한 번에 메모리에 올릴 필요도 없고, 배치 처리를 따로 구현하지 않아도 됩니다.
이 방식은 GPU에서 사용자 정의 루프와 유사한 속도로 작동하며, 만약 그렇지 않을 경우 이슈를 등록해 주세요.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">datasets</span>
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">transformers</span><span class="w"> </span><span class="kn">import</span> <span class="n">pipeline</span>
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a><span class="kn">from</span><span class="w"> </span><span class="nn">transformers.pipelines.pt_utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">KeyDataset</span>
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a><span class="kn">from</span><span class="w"> </span><span class="nn">tqdm.auto</span><span class="w"> </span><span class="kn">import</span> <span class="n">tqdm</span>
</span><span id="__span-3-5"><a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a>
</span><span id="__span-3-6"><a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a><span class="n">pipe</span> <span class="o">=</span> <span class="n">pipeline</span><span class="p">(</span><span class="s2">&quot;automatic-speech-recognition&quot;</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="s2">&quot;facebook/wav2vec2-base-960h&quot;</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-3-7"><a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a><span class="n">dataset</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">load_dataset</span><span class="p">(</span><span class="s2">&quot;superb&quot;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;asr&quot;</span><span class="p">,</span> <span class="n">split</span><span class="o">=</span><span class="s2">&quot;test&quot;</span><span class="p">)</span>
</span><span id="__span-3-8"><a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a>
</span><span id="__span-3-9"><a id="__codelineno-3-9" name="__codelineno-3-9" href="#__codelineno-3-9"></a><span class="c1"># KeyDataset (*pt* 전용)는 데이터셋 항목의 딕셔너리에서 지정된 키만 반환합니다.</span>
</span><span id="__span-3-10"><a id="__codelineno-3-10" name="__codelineno-3-10" href="#__codelineno-3-10"></a><span class="c1"># 이 예제에서는 *target* 항목이 필요하지 않으므로 KeyDataset을 사용합니다. 문장 쌍 입력에는 KeyPairDataset을 사용하세요.</span>
</span><span id="__span-3-11"><a id="__codelineno-3-11" name="__codelineno-3-11" href="#__codelineno-3-11"></a><span class="k">for</span> <span class="n">out</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">pipe</span><span class="p">(</span><span class="n">KeyDataset</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="s2">&quot;file&quot;</span><span class="p">))):</span>
</span><span id="__span-3-12"><a id="__codelineno-3-12" name="__codelineno-3-12" href="#__codelineno-3-12"></a>    <span class="nb">print</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
</span><span id="__span-3-13"><a id="__codelineno-3-13" name="__codelineno-3-13" href="#__codelineno-3-13"></a>    <span class="c1"># {&quot;text&quot;: &quot;NUMBER TEN FRESH NELLY IS WAITING ON YOU GOOD NIGHT HUSBAND&quot;}</span>
</span><span id="__span-3-14"><a id="__codelineno-3-14" name="__codelineno-3-14" href="#__codelineno-3-14"></a>    <span class="c1"># {&quot;text&quot;: ....}</span>
</span><span id="__span-3-15"><a id="__codelineno-3-15" name="__codelineno-3-15" href="#__codelineno-3-15"></a>    <span class="c1"># ....</span>
</span></code></pre></div>
<p>더 편리하게 사용하려면 제너레이터도 가능합니다.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">transformers</span><span class="w"> </span><span class="kn">import</span> <span class="n">pipeline</span>
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a>
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a><span class="n">pipe</span> <span class="o">=</span> <span class="n">pipeline</span><span class="p">(</span><span class="s2">&quot;text-classification&quot;</span><span class="p">)</span>
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a>
</span><span id="__span-4-5"><a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a><span class="k">def</span><span class="w"> </span><span class="nf">data</span><span class="p">():</span>
</span><span id="__span-4-6"><a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a>    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="__span-4-7"><a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a>        <span class="c1"># 데이터는 데이터셋, 데이터베이스, 큐 또는 HTTP 요청에서 올 수 있습니다.</span>
</span><span id="__span-4-8"><a id="__codelineno-4-8" name="__codelineno-4-8" href="#__codelineno-4-8"></a>        <span class="c1"># 서버에서</span>
</span><span id="__span-4-9"><a id="__codelineno-4-9" name="__codelineno-4-9" href="#__codelineno-4-9"></a>        <span class="c1"># 주의: 반복적이므로 `num_workers &gt; 1` 변수를 사용할 수 없습니다.</span>
</span><span id="__span-4-10"><a id="__codelineno-4-10" name="__codelineno-4-10" href="#__codelineno-4-10"></a>        <span class="c1"># 데이터를 전처리하기 위해 여러 스레드를 사용할 수 없습니다. 여전히</span>
</span><span id="__span-4-11"><a id="__codelineno-4-11" name="__codelineno-4-11" href="#__codelineno-4-11"></a>        <span class="c1"># 메인 스레드가 대규모 추론을 수행하는 동안 하나의 스레드가 전처리를 수행할 수 있습니다.</span>
</span><span id="__span-4-12"><a id="__codelineno-4-12" name="__codelineno-4-12" href="#__codelineno-4-12"></a>        <span class="k">yield</span> <span class="s2">&quot;This is a test&quot;</span>
</span><span id="__span-4-13"><a id="__codelineno-4-13" name="__codelineno-4-13" href="#__codelineno-4-13"></a>
</span><span id="__span-4-14"><a id="__codelineno-4-14" name="__codelineno-4-14" href="#__codelineno-4-14"></a><span class="k">for</span> <span class="n">out</span> <span class="ow">in</span> <span class="n">pipe</span><span class="p">(</span><span class="n">data</span><span class="p">()):</span>
</span><span id="__span-4-15"><a id="__codelineno-4-15" name="__codelineno-4-15" href="#__codelineno-4-15"></a>    <span class="nb">print</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
</span><span id="__span-4-16"><a id="__codelineno-4-16" name="__codelineno-4-16" href="#__codelineno-4-16"></a>    <span class="c1"># {&quot;text&quot;: &quot;NUMBER TEN FRESH NELLY IS WAITING ON YOU GOOD NIGHT HUSBAND&quot;}</span>
</span><span id="__span-4-17"><a id="__codelineno-4-17" name="__codelineno-4-17" href="#__codelineno-4-17"></a>    <span class="c1"># {&quot;text&quot;: ....}</span>
</span><span id="__span-4-18"><a id="__codelineno-4-18" name="__codelineno-4-18" href="#__codelineno-4-18"></a>    <span class="c1"># ....</span>
</span></code></pre></div>
<p>[[autodoc]] pipeline</p>
<h2 id="pipeline-batching">파이프라인 배치 처리 [[pipeline-batching]]</h2>
<p>모든 파이프라인은 배치 처리를 지원합니다. 리스트, <code>Dataset</code>, <code>Generator</code> 전달 시 스트리밍 기능을 사용할 때 작동합니다.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">transformers</span><span class="w"> </span><span class="kn">import</span> <span class="n">pipeline</span>
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">transformers.pipelines.pt_utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">KeyDataset</span>
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a><span class="kn">import</span><span class="w"> </span><span class="nn">datasets</span>
</span><span id="__span-5-4"><a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a>
</span><span id="__span-5-5"><a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a><span class="n">dataset</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">load_dataset</span><span class="p">(</span><span class="s2">&quot;imdb&quot;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;plain_text&quot;</span><span class="p">,</span> <span class="n">split</span><span class="o">=</span><span class="s2">&quot;unsupervised&quot;</span><span class="p">)</span>
</span><span id="__span-5-6"><a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a><span class="n">pipe</span> <span class="o">=</span> <span class="n">pipeline</span><span class="p">(</span><span class="s2">&quot;text-classification&quot;</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-5-7"><a id="__codelineno-5-7" name="__codelineno-5-7" href="#__codelineno-5-7"></a><span class="k">for</span> <span class="n">out</span> <span class="ow">in</span> <span class="n">pipe</span><span class="p">(</span><span class="n">KeyDataset</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="s2">&quot;text&quot;</span><span class="p">),</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">truncation</span><span class="o">=</span><span class="s2">&quot;only_first&quot;</span><span class="p">):</span>
</span><span id="__span-5-8"><a id="__codelineno-5-8" name="__codelineno-5-8" href="#__codelineno-5-8"></a>    <span class="nb">print</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
</span><span id="__span-5-9"><a id="__codelineno-5-9" name="__codelineno-5-9" href="#__codelineno-5-9"></a>    <span class="c1"># [{&#39;label&#39;: &#39;POSITIVE&#39;, &#39;score&#39;: 0.9998743534088135}]</span>
</span><span id="__span-5-10"><a id="__codelineno-5-10" name="__codelineno-5-10" href="#__codelineno-5-10"></a>    <span class="c1"># 이전과 동일한 출력이지만, 내용을 배치로 모델에 전달합니다.</span>
</span></code></pre></div>
<p><Tip warning={true}></p>
<p>하지만 배치 처리가 항상 성능 향상을 보장하는 것은 아닙니다. 하드웨어, 데이터, 모델에 따라 속도가 10배로 빨라질수도, 5배 느려질 수 있습니다.</p>
<p>주로 속도 향상이 있는 예시:</p>
<p></Tip></p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">transformers</span><span class="w"> </span><span class="kn">import</span> <span class="n">pipeline</span>
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">torch.utils.data</span><span class="w"> </span><span class="kn">import</span> <span class="n">Dataset</span>
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a><span class="kn">from</span><span class="w"> </span><span class="nn">tqdm.auto</span><span class="w"> </span><span class="kn">import</span> <span class="n">tqdm</span>
</span><span id="__span-6-4"><a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a>
</span><span id="__span-6-5"><a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a><span class="n">pipe</span> <span class="o">=</span> <span class="n">pipeline</span><span class="p">(</span><span class="s2">&quot;text-classification&quot;</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-6-6"><a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a>
</span><span id="__span-6-7"><a id="__codelineno-6-7" name="__codelineno-6-7" href="#__codelineno-6-7"></a><span class="k">class</span><span class="w"> </span><span class="nc">MyDataset</span><span class="p">(</span><span class="n">Dataset</span><span class="p">):</span>
</span><span id="__span-6-8"><a id="__codelineno-6-8" name="__codelineno-6-8" href="#__codelineno-6-8"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-6-9"><a id="__codelineno-6-9" name="__codelineno-6-9" href="#__codelineno-6-9"></a>        <span class="k">return</span> <span class="mi">5000</span>
</span><span id="__span-6-10"><a id="__codelineno-6-10" name="__codelineno-6-10" href="#__codelineno-6-10"></a>
</span><span id="__span-6-11"><a id="__codelineno-6-11" name="__codelineno-6-11" href="#__codelineno-6-11"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
</span><span id="__span-6-12"><a id="__codelineno-6-12" name="__codelineno-6-12" href="#__codelineno-6-12"></a>        <span class="k">return</span> <span class="s2">&quot;This is a test&quot;</span>
</span><span id="__span-6-13"><a id="__codelineno-6-13" name="__codelineno-6-13" href="#__codelineno-6-13"></a>
</span><span id="__span-6-14"><a id="__codelineno-6-14" name="__codelineno-6-14" href="#__codelineno-6-14"></a><span class="n">dataset</span> <span class="o">=</span> <span class="n">MyDataset</span><span class="p">()</span>
</span><span id="__span-6-15"><a id="__codelineno-6-15" name="__codelineno-6-15" href="#__codelineno-6-15"></a>
</span><span id="__span-6-16"><a id="__codelineno-6-16" name="__codelineno-6-16" href="#__codelineno-6-16"></a><span class="k">for</span> <span class="n">batch_size</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">256</span><span class="p">]:</span>
</span><span id="__span-6-17"><a id="__codelineno-6-17" name="__codelineno-6-17" href="#__codelineno-6-17"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">30</span><span class="p">)</span>
</span><span id="__span-6-18"><a id="__codelineno-6-18" name="__codelineno-6-18" href="#__codelineno-6-18"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Streaming batch_size=</span><span class="si">{</span><span class="n">batch_size</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-6-19"><a id="__codelineno-6-19" name="__codelineno-6-19" href="#__codelineno-6-19"></a>    <span class="k">for</span> <span class="n">out</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">pipe</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">),</span> <span class="n">total</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">dataset</span><span class="p">)):</span>
</span><span id="__span-6-20"><a id="__codelineno-6-20" name="__codelineno-6-20" href="#__codelineno-6-20"></a>        <span class="k">pass</span>
</span></code></pre></div>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="c1"># On GTX 970</span>
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a>------------------------------
</span><span id="__span-7-3"><a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a>Streaming<span class="w"> </span>no<span class="w"> </span>batching
</span><span id="__span-7-4"><a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a><span class="m">100</span>%<span class="p">|</span>██████████████████████████████████████████████████████████████████████<span class="p">|</span><span class="w"> </span><span class="m">5000</span>/5000<span class="w"> </span><span class="o">[</span><span class="m">00</span>:26&lt;<span class="m">00</span>:00,<span class="w"> </span><span class="m">187</span>.52it/s<span class="o">]</span>
</span><span id="__span-7-5"><a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a>------------------------------
</span><span id="__span-7-6"><a id="__codelineno-7-6" name="__codelineno-7-6" href="#__codelineno-7-6"></a>Streaming<span class="w"> </span><span class="nv">batch_size</span><span class="o">=</span><span class="m">8</span>
</span><span id="__span-7-7"><a id="__codelineno-7-7" name="__codelineno-7-7" href="#__codelineno-7-7"></a><span class="m">100</span>%<span class="p">|</span>█████████████████████████████████████████████████████████████████████<span class="p">|</span><span class="w"> </span><span class="m">5000</span>/5000<span class="w"> </span><span class="o">[</span><span class="m">00</span>:04&lt;<span class="m">00</span>:00,<span class="w"> </span><span class="m">1205</span>.95it/s<span class="o">]</span>
</span><span id="__span-7-8"><a id="__codelineno-7-8" name="__codelineno-7-8" href="#__codelineno-7-8"></a>------------------------------
</span><span id="__span-7-9"><a id="__codelineno-7-9" name="__codelineno-7-9" href="#__codelineno-7-9"></a>Streaming<span class="w"> </span><span class="nv">batch_size</span><span class="o">=</span><span class="m">64</span>
</span><span id="__span-7-10"><a id="__codelineno-7-10" name="__codelineno-7-10" href="#__codelineno-7-10"></a><span class="m">100</span>%<span class="p">|</span>█████████████████████████████████████████████████████████████████████<span class="p">|</span><span class="w"> </span><span class="m">5000</span>/5000<span class="w"> </span><span class="o">[</span><span class="m">00</span>:02&lt;<span class="m">00</span>:00,<span class="w"> </span><span class="m">2478</span>.24it/s<span class="o">]</span>
</span><span id="__span-7-11"><a id="__codelineno-7-11" name="__codelineno-7-11" href="#__codelineno-7-11"></a>------------------------------
</span><span id="__span-7-12"><a id="__codelineno-7-12" name="__codelineno-7-12" href="#__codelineno-7-12"></a>Streaming<span class="w"> </span><span class="nv">batch_size</span><span class="o">=</span><span class="m">256</span>
</span><span id="__span-7-13"><a id="__codelineno-7-13" name="__codelineno-7-13" href="#__codelineno-7-13"></a><span class="m">100</span>%<span class="p">|</span>█████████████████████████████████████████████████████████████████████<span class="p">|</span><span class="w"> </span><span class="m">5000</span>/5000<span class="w"> </span><span class="o">[</span><span class="m">00</span>:01&lt;<span class="m">00</span>:00,<span class="w"> </span><span class="m">2554</span>.43it/s<span class="o">]</span>
</span><span id="__span-7-14"><a id="__codelineno-7-14" name="__codelineno-7-14" href="#__codelineno-7-14"></a><span class="o">(</span>diminishing<span class="w"> </span>returns,<span class="w"> </span>saturated<span class="w"> </span>the<span class="w"> </span>GPU<span class="o">)</span>
</span></code></pre></div>
<p>주로 속도 저하가 있는 예시:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">MyDataset</span><span class="p">(</span><span class="n">Dataset</span><span class="p">):</span>
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-8-3"><a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a>        <span class="k">return</span> <span class="mi">5000</span>
</span><span id="__span-8-4"><a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a>
</span><span id="__span-8-5"><a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
</span><span id="__span-8-6"><a id="__codelineno-8-6" name="__codelineno-8-6" href="#__codelineno-8-6"></a>        <span class="k">if</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">64</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="__span-8-7"><a id="__codelineno-8-7" name="__codelineno-8-7" href="#__codelineno-8-7"></a>            <span class="n">n</span> <span class="o">=</span> <span class="mi">100</span>
</span><span id="__span-8-8"><a id="__codelineno-8-8" name="__codelineno-8-8" href="#__codelineno-8-8"></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="__span-8-9"><a id="__codelineno-8-9" name="__codelineno-8-9" href="#__codelineno-8-9"></a>            <span class="n">n</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="__span-8-10"><a id="__codelineno-8-10" name="__codelineno-8-10" href="#__codelineno-8-10"></a>        <span class="k">return</span> <span class="s2">&quot;This is a test&quot;</span> <span class="o">*</span> <span class="n">n</span>
</span></code></pre></div>
<p>이는 다른 문장들에 비해 간헐적으로 매우 긴 문장이 포함된 경우입니다. 이 경우 <strong>전체</strong> 배치가 400토큰 길이로<br />
([64, 400]) 되어야 하므로, [64, 4] 대신 [64, 400]이 되어 크게 속도가 저하됩니다. 게다가, 더 큰 배치에서는 프로그램이 충돌할 수 있습니다.</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a>------------------------------
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a>Streaming<span class="w"> </span>no<span class="w"> </span>batching
</span><span id="__span-9-3"><a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a><span class="m">100</span>%<span class="p">|</span>█████████████████████████████████████████████████████████████████████<span class="p">|</span><span class="w"> </span><span class="m">1000</span>/1000<span class="w"> </span><span class="o">[</span><span class="m">00</span>:05&lt;<span class="m">00</span>:00,<span class="w"> </span><span class="m">183</span>.69it/s<span class="o">]</span>
</span><span id="__span-9-4"><a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a>------------------------------
</span><span id="__span-9-5"><a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a>Streaming<span class="w"> </span><span class="nv">batch_size</span><span class="o">=</span><span class="m">8</span>
</span><span id="__span-9-6"><a id="__codelineno-9-6" name="__codelineno-9-6" href="#__codelineno-9-6"></a><span class="m">100</span>%<span class="p">|</span>█████████████████████████████████████████████████████████████████████<span class="p">|</span><span class="w"> </span><span class="m">1000</span>/1000<span class="w"> </span><span class="o">[</span><span class="m">00</span>:03&lt;<span class="m">00</span>:00,<span class="w"> </span><span class="m">265</span>.74it/s<span class="o">]</span>
</span><span id="__span-9-7"><a id="__codelineno-9-7" name="__codelineno-9-7" href="#__codelineno-9-7"></a>------------------------------
</span><span id="__span-9-8"><a id="__codelineno-9-8" name="__codelineno-9-8" href="#__codelineno-9-8"></a>Streaming<span class="w"> </span><span class="nv">batch_size</span><span class="o">=</span><span class="m">64</span>
</span><span id="__span-9-9"><a id="__codelineno-9-9" name="__codelineno-9-9" href="#__codelineno-9-9"></a><span class="m">100</span>%<span class="p">|</span>██████████████████████████████████████████████████████████████████████<span class="p">|</span><span class="w"> </span><span class="m">1000</span>/1000<span class="w"> </span><span class="o">[</span><span class="m">00</span>:26&lt;<span class="m">00</span>:00,<span class="w"> </span><span class="m">37</span>.80it/s<span class="o">]</span>
</span><span id="__span-9-10"><a id="__codelineno-9-10" name="__codelineno-9-10" href="#__codelineno-9-10"></a>------------------------------
</span><span id="__span-9-11"><a id="__codelineno-9-11" name="__codelineno-9-11" href="#__codelineno-9-11"></a>Streaming<span class="w"> </span><span class="nv">batch_size</span><span class="o">=</span><span class="m">256</span>
</span><span id="__span-9-12"><a id="__codelineno-9-12" name="__codelineno-9-12" href="#__codelineno-9-12"></a><span class="w">  </span><span class="m">0</span>%<span class="p">|</span><span class="w">                                                                                 </span><span class="p">|</span><span class="w"> </span><span class="m">0</span>/1000<span class="w"> </span><span class="o">[</span><span class="m">00</span>:00&lt;?,<span class="w"> </span>?it/s<span class="o">]</span>
</span><span id="__span-9-13"><a id="__codelineno-9-13" name="__codelineno-9-13" href="#__codelineno-9-13"></a>Traceback<span class="w"> </span><span class="o">(</span>most<span class="w"> </span>recent<span class="w"> </span>call<span class="w"> </span>last<span class="o">)</span>:
</span><span id="__span-9-14"><a id="__codelineno-9-14" name="__codelineno-9-14" href="#__codelineno-9-14"></a><span class="w">  </span>File<span class="w"> </span><span class="s2">&quot;/home/nicolas/src/transformers/test.py&quot;</span>,<span class="w"> </span>line<span class="w"> </span><span class="m">42</span>,<span class="w"> </span><span class="k">in</span><span class="w"> </span>&lt;module&gt;
</span><span id="__span-9-15"><a id="__codelineno-9-15" name="__codelineno-9-15" href="#__codelineno-9-15"></a><span class="w">    </span><span class="k">for</span><span class="w"> </span>out<span class="w"> </span><span class="k">in</span><span class="w"> </span>tqdm<span class="o">(</span>pipe<span class="o">(</span>dataset,<span class="w"> </span><span class="nv">batch_size</span><span class="o">=</span><span class="m">256</span><span class="o">)</span>,<span class="w"> </span><span class="nv">total</span><span class="o">=</span>len<span class="o">(</span>dataset<span class="o">))</span>:
</span><span id="__span-9-16"><a id="__codelineno-9-16" name="__codelineno-9-16" href="#__codelineno-9-16"></a>....
</span><span id="__span-9-17"><a id="__codelineno-9-17" name="__codelineno-9-17" href="#__codelineno-9-17"></a><span class="w">    </span><span class="nv">q</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>q<span class="w"> </span>/<span class="w"> </span>math.sqrt<span class="o">(</span>dim_per_head<span class="o">)</span><span class="w">  </span><span class="c1"># (bs, n_heads, q_length, dim_per_head)</span>
</span><span id="__span-9-18"><a id="__codelineno-9-18" name="__codelineno-9-18" href="#__codelineno-9-18"></a>RuntimeError:<span class="w"> </span>CUDA<span class="w"> </span>out<span class="w"> </span>of<span class="w"> </span>memory.<span class="w"> </span>Tried<span class="w"> </span>to<span class="w"> </span>allocate<span class="w"> </span><span class="m">376</span>.00<span class="w"> </span>MiB<span class="w"> </span><span class="o">(</span>GPU<span class="w"> </span><span class="m">0</span><span class="p">;</span><span class="w"> </span><span class="m">3</span>.95<span class="w"> </span>GiB<span class="w"> </span>total<span class="w"> </span>capacity<span class="p">;</span><span class="w"> </span><span class="m">1</span>.72<span class="w"> </span>GiB<span class="w"> </span>already<span class="w"> </span>allocated<span class="p">;</span><span class="w"> </span><span class="m">354</span>.88<span class="w"> </span>MiB<span class="w"> </span>free<span class="p">;</span><span class="w"> </span><span class="m">2</span>.46<span class="w"> </span>GiB<span class="w"> </span>reserved<span class="w"> </span><span class="k">in</span><span class="w"> </span>total<span class="w"> </span>by<span class="w"> </span>PyTorch<span class="o">)</span>
</span></code></pre></div>
<p>일반적인 해결책은 없으며, 사용 사례에 따라 다를 수 있습니다.</p>
<p>사용자를 위한 경험상 지침:</p>
<ul>
<li><strong>하드웨어와 실제 워크로드로 성능을 측정하세요. 측정이 답입니다.</strong></li>
<li>실시간 추론(latency)이 중요하다면 배치 처리하지 마세요.</li>
<li>CPU 사용 시에도 배치 처리하지 않는 것이 좋습니다.</li>
<li>
<p>GPU에서 정적 데이터 처리(throughput)가 목적이라면</p>
</li>
<li>
<p>입력 시퀀스 길이("실제" 데이터)를 잘 모르는 경우, 기본적으로 배치 처리하지 말고 성능을 측정하면서 임시로 배치를 적용해 보고, 실패 시 이를 복구할 수 있도록 OOM 검사 로직을 추가하세요. (시퀀스 길이를 제어하지 않으면 언젠가는 실패하게 됩니다.)</p>
</li>
<li>시퀀스 길이가 일정하다면 배치 처리가 유리할 수 있습니다. 측정하며 OOM까지 시도해 보세요.</li>
<li>GPU 메모리가 클수록 배치 처리의 이점이 큽니다.</li>
<li>배치 처리 활성화 시 OOM을 핸들링할 수 있도록 대비하세요.</li>
</ul>
<h2 id="pipeline-chunk-batching">파이프라인 청크 배치 처리 [[pipeline-chunk-batching]]</h2>
<p><code>제로샷 분류</code> 및 <code>질의응답</code> 파이프라인은 단일 입력이 여러 포워드 패스를 유발할 수 있어 <code>배치 크기</code> 인자를 그대로 사용하면 문제가 발생할 수 있습니다.</p>
<p>이를 해결하기 위해 두 파이프라인은 <code>청크 파이프라인</code> 형태로 동작합니다. 요약하면</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="n">preprocessed</span> <span class="o">=</span> <span class="n">pipe</span><span class="o">.</span><span class="n">preprocess</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
</span><span id="__span-10-2"><a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a><span class="n">model_outputs</span> <span class="o">=</span> <span class="n">pipe</span><span class="o">.</span><span class="n">forward</span><span class="p">(</span><span class="n">preprocessed</span><span class="p">)</span>
</span><span id="__span-10-3"><a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a><span class="n">outputs</span> <span class="o">=</span> <span class="n">pipe</span><span class="o">.</span><span class="n">postprocess</span><span class="p">(</span><span class="n">model_outputs</span><span class="p">)</span>
</span></code></pre></div>
<p>이제 내부적으로는</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="n">all_model_outputs</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="__span-11-2"><a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a><span class="k">for</span> <span class="n">preprocessed</span> <span class="ow">in</span> <span class="n">pipe</span><span class="o">.</span><span class="n">preprocess</span><span class="p">(</span><span class="n">inputs</span><span class="p">):</span>
</span><span id="__span-11-3"><a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a>    <span class="n">model_outputs</span> <span class="o">=</span> <span class="n">pipe</span><span class="o">.</span><span class="n">forward</span><span class="p">(</span><span class="n">preprocessed</span><span class="p">)</span>
</span><span id="__span-11-4"><a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a>    <span class="n">all_model_outputs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">model_outputs</span><span class="p">)</span>
</span><span id="__span-11-5"><a id="__codelineno-11-5" name="__codelineno-11-5" href="#__codelineno-11-5"></a><span class="n">outputs</span> <span class="o">=</span> <span class="n">pipe</span><span class="o">.</span><span class="n">postprocess</span><span class="p">(</span><span class="n">all_model_outputs</span><span class="p">)</span>
</span></code></pre></div>
<p>파이프라인의 사용 방식이 동일하므로, 코드에는 거의 영향을 주지 않습니다.</p>
<p>파이프라인은 배치 처리를 자동으로 수행하기 때문에 입력이 몇 번의 포워드 패스를 발생시키는지 고려할 필요 없이, <code>배치 크기</code>는 입력과 무관하게 최적화할 수 있습니다.
다만 앞서 언급한 주의사항은 여전히 유효합니다.</p>
<h2 id="fp16-pipeline-fp16-inference">파이프라인 FP16 추론 [[pipeline-fp16-inference]]</h2>
<p>모델은 FP16 모드로 실행할 수 있으며, GPU에서 메모리를 절약하면서 처리 속도를 크게 향상시킬 수 있습니다. 대부분의 모델은 성능 저하 없이 FP16을 지원하며, 모델이 클수록 성능 저하 가능성은 더 낮아집니다.</p>
<p>FP16 추론을 활성화하려면 파이프라인 생성자에 <code>dtype=torch.float16</code> 또는 <code>dtype='float16'</code>을 전달하세요. 이 기능은 파이토치 백엔드를 사용하는 모델에서만 작동하며, 입력은 내부적으로 FP16 형식으로 변환됩니다.</p>
<h2 id="pipeline-custom-code">파이프라인 사용자 정의 코드 [[pipeline-custom-code]]</h2>
<p>특정 파이프라인을 오버라이드하려면, 먼저 해당 작업에 대한 이슈를 등록해 주세요. 파이프라인의 목표는 대부분의 사용 사례를 지원하는 것이므로, <code>transformers</code> 팀이 추가 지원을 고려할 수 있습니다.</p>
<p>간단히 시도하려면 파이프라인 클래스를 상속하세요.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">MyPipeline</span><span class="p">(</span><span class="n">TextClassificationPipeline</span><span class="p">):</span>
</span><span id="__span-12-2"><a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">postprocess</span><span class="p">():</span>
</span><span id="__span-12-3"><a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a>        <span class="c1"># 사용자 정의 후처리 코드 작성</span>
</span><span id="__span-12-4"><a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a>        <span class="n">scores</span> <span class="o">=</span> <span class="n">scores</span> <span class="o">*</span> <span class="mi">100</span>
</span><span id="__span-12-5"><a id="__codelineno-12-5" name="__codelineno-12-5" href="#__codelineno-12-5"></a>        <span class="c1"># 추가 코드 작성</span>
</span><span id="__span-12-6"><a id="__codelineno-12-6" name="__codelineno-12-6" href="#__codelineno-12-6"></a>
</span><span id="__span-12-7"><a id="__codelineno-12-7" name="__codelineno-12-7" href="#__codelineno-12-7"></a><span class="n">my_pipeline</span> <span class="o">=</span> <span class="n">MyPipeline</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span> <span class="n">tokenizer</span><span class="o">=</span><span class="n">tokenizer</span><span class="p">,</span> <span class="o">...</span><span class="p">)</span>
</span><span id="__span-12-8"><a id="__codelineno-12-8" name="__codelineno-12-8" href="#__codelineno-12-8"></a><span class="c1"># 또는 *pipeline* 함수를 사용할 경우:</span>
</span><span id="__span-12-9"><a id="__codelineno-12-9" name="__codelineno-12-9" href="#__codelineno-12-9"></a><span class="n">my_pipeline</span> <span class="o">=</span> <span class="n">pipeline</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="s2">&quot;xxxx&quot;</span><span class="p">,</span> <span class="n">pipeline_class</span><span class="o">=</span><span class="n">MyPipeline</span><span class="p">)</span>
</span></code></pre></div>
<p>이를 통해 원하는 모든 커스텀 코드를 적용할 수 있습니다.</p>
<h2 id="implementing-a-pipeline">파이프라인 구현하기 [[implementing-a-pipeline]]</h2>
<p><a href="../add_new_pipeline">새 파이프라인 구현</a></p>
<h2 id="audio">오디오 [[audio]]</h2>
<p>오디오 작업에 사용할 수 있는 파이프라인은 다음과 같습니다.</p>
<h3 id="audioclassificationpipeline-transformersaudioclassificationpipeline">AudioClassificationPipeline [[transformers.AudioClassificationPipeline]]</h3>
<p>[[autodoc]] AudioClassificationPipeline
    - <strong>call</strong>
    - all</p>
<h3 id="automaticspeechrecognitionpipeline-transformersautomaticspeechrecognitionpipeline">AutomaticSpeechRecognitionPipeline [[transformers.AutomaticSpeechRecognitionPipeline]]</h3>
<p>[[autodoc]] AutomaticSpeechRecognitionPipeline
    - <strong>call</strong>
    - all</p>
<h3 id="texttoaudiopipeline-transformerstexttoaudiopipeline">TextToAudioPipeline [[transformers.TextToAudioPipeline]]</h3>
<p>[[autodoc]] TextToAudioPipeline
    - <strong>call</strong>
    - all</p>
<h3 id="zeroshotaudioclassificationpipeline-transformerszeroshotaudioclassificationpipeline">ZeroShotAudioClassificationPipeline [[transformers.ZeroShotAudioClassificationPipeline]]</h3>
<p>[[autodoc]] ZeroShotAudioClassificationPipeline
    - <strong>call</strong>
    - all</p>
<h2 id="computer-vision">컴퓨터 비전 [[computer-vision]]</h2>
<p>컴퓨터 비전 작업에 사용할 수 있는 파이프라인은 다음과 같습니다.</p>
<h3 id="depthestimationpipeline-transformersdepthestimationpipeline">DepthEstimationPipeline [[transformers.DepthEstimationPipeline]]</h3>
<p>[[autodoc]] DepthEstimationPipeline
    - <strong>call</strong>
    - all</p>
<h3 id="imageclassificationpipeline-transformersimageclassificationpipeline">ImageClassificationPipeline [[transformers.ImageClassificationPipeline]]</h3>
<p>[[autodoc]] ImageClassificationPipeline
    - <strong>call</strong>
    - all</p>
<h3 id="imagesegmentationpipeline-transformersimagesegmentationpipeline">ImageSegmentationPipeline [[transformers.ImageSegmentationPipeline]]</h3>
<p>[[autodoc]] ImageSegmentationPipeline
    - <strong>call</strong>
    - all</p>
<h3 id="imagetoimagepipeline-transformersimagetoimagepipeline">ImageToImagePipeline [[transformers.ImageToImagePipeline]]</h3>
<p>[[autodoc]] ImageToImagePipeline
    - <strong>call</strong>
    - all</p>
<h3 id="objectdetectionpipeline-transformersobjectdetectionpipeline">ObjectDetectionPipeline [[transformers.ObjectDetectionPipeline]]</h3>
<p>[[autodoc]] ObjectDetectionPipeline
    - <strong>call</strong>
    - all</p>
<h3 id="videoclassificationpipeline-transformersvideoclassificationpipeline">VideoClassificationPipeline [[transformers.VideoClassificationPipeline]]</h3>
<p>[[autodoc]] VideoClassificationPipeline
    - <strong>call</strong>
    - all</p>
<h3 id="zeroshotimageclassificationpipeline-transformerszeroshotimageclassificationpipeline">ZeroShotImageClassificationPipeline [[transformers.ZeroShotImageClassificationPipeline]]</h3>
<p>[[autodoc]] ZeroShotImageClassificationPipeline
    - <strong>call</strong>
    - all</p>
<h3 id="zeroshotobjectdetectionpipeline-transformerszeroshotobjectdetectionpipeline">ZeroShotObjectDetectionPipeline [[transformers.ZeroShotObjectDetectionPipeline]]</h3>
<p>[[autodoc]] ZeroShotObjectDetectionPipeline
    - <strong>call</strong>
    - all</p>
<h2 id="natural-language-processing">자연어 처리 [[natural-language-processing]]</h2>
<p>자연어 처리 작업에 사용할 수 있는 파이프라인은 다음과 같습니다.</p>
<h3 id="fillmaskpipeline-transformersfillmaskpipeline">FillMaskPipeline [[transformers.FillMaskPipeline]]</h3>
<p>[[autodoc]] FillMaskPipeline
    - <strong>call</strong>
    - all</p>
<h3 id="questionansweringpipeline-transformersquestionansweringpipeline">QuestionAnsweringPipeline [[transformers.QuestionAnsweringPipeline]]</h3>
<p>[[autodoc]] QuestionAnsweringPipeline
    - <strong>call</strong>
    - all</p>
<h3 id="summarizationpipeline-transformerssummarizationpipeline">SummarizationPipeline [[transformers.SummarizationPipeline]]</h3>
<p>[[autodoc]] SummarizationPipeline
    - <strong>call</strong>
    - all</p>
<h3 id="tablequestionansweringpipeline-transformerstablequestionansweringpipeline">TableQuestionAnsweringPipeline [[transformers.TableQuestionAnsweringPipeline]]</h3>
<p>[[autodoc]] TableQuestionAnsweringPipeline
    - <strong>call</strong></p>
<h3 id="textclassificationpipeline-transformerstextclassificationpipeline">TextClassificationPipeline [[transformers.TextClassificationPipeline]]</h3>
<p>[[autodoc]] TextClassificationPipeline
    - <strong>call</strong>
    - all</p>
<h3 id="textgenerationpipeline-transformerstextgenerationpipeline">TextGenerationPipeline [[transformers.TextGenerationPipeline]]</h3>
<p>[[autodoc]] TextGenerationPipeline
    - <strong>call</strong>
    - all</p>
<h3 id="text2textgenerationpipeline-transformerstext2textgenerationpipeline">Text2TextGenerationPipeline [[transformers.Text2TextGenerationPipeline]]</h3>
<p>[[autodoc]] Text2TextGenerationPipeline
    - <strong>call</strong>
    - all</p>
<h3 id="tokenclassificationpipeline-transformerstokenclassificationpipeline">TokenClassificationPipeline [[transformers.TokenClassificationPipeline]]</h3>
<p>[[autodoc]] TokenClassificationPipeline
    - <strong>call</strong>
    - all</p>
<h3 id="translationpipeline-transformerstranslationpipeline">TranslationPipeline [[transformers.TranslationPipeline]]</h3>
<p>[[autodoc]] TranslationPipeline
    - <strong>call</strong>
    - all</p>
<h3 id="zeroshotclassificationpipeline-transformerszeroshotclassificationpipeline">ZeroShotClassificationPipeline [[transformers.ZeroShotClassificationPipeline]]</h3>
<p>[[autodoc]] ZeroShotClassificationPipeline
    - <strong>call</strong>
    - all</p>
<h2 id="multimodal">멀티모달 [[multimodal]]</h2>
<p>멀티모달 작업에 사용할 수 있는 파이프라인은 다음과 같습니다.</p>
<h3 id="documentquestionansweringpipeline-transformersdocumentquestionansweringpipeline">DocumentQuestionAnsweringPipeline [[transformers.DocumentQuestionAnsweringPipeline]]</h3>
<p>[[autodoc]] DocumentQuestionAnsweringPipeline
    - <strong>call</strong>
    - all</p>
<h3 id="featureextractionpipeline-transformersfeatureextractionpipeline">FeatureExtractionPipeline [[transformers.FeatureExtractionPipeline]]</h3>
<p>[[autodoc]] FeatureExtractionPipeline
    - <strong>call</strong>
    - all</p>
<h3 id="imagefeatureextractionpipeline-transformersimagefeatureextractionpipeline">ImageFeatureExtractionPipeline [[transformers.ImageFeatureExtractionPipeline]]</h3>
<p>[[autodoc]] ImageFeatureExtractionPipeline
    - <strong>call</strong>
    - all</p>
<h3 id="imagetotextpipeline-transformersimagetotextpipeline">ImageToTextPipeline [[transformers.ImageToTextPipeline]]</h3>
<p>[[autodoc]] ImageToTextPipeline
    - <strong>call</strong>
    - all</p>
<h3 id="imagetexttotextpipeline-transformersimagetexttotextpipeline">ImageTextToTextPipeline [[transformers.ImageTextToTextPipeline]]</h3>
<p>[[autodoc]] ImageTextToTextPipeline
    - <strong>call</strong>
    - all</p>
<h3 id="maskgenerationpipeline-transformersmaskgenerationpipeline">MaskGenerationPipeline [[transformers.MaskGenerationPipeline]]</h3>
<p>[[autodoc]] MaskGenerationPipeline
    - <strong>call</strong>
    - all</p>
<h3 id="visualquestionansweringpipeline-transformersvisualquestionansweringpipeline">VisualQuestionAnsweringPipeline [[transformers.VisualQuestionAnsweringPipeline]]</h3>
<p>[[autodoc]] VisualQuestionAnsweringPipeline
    - <strong>call</strong>
    - all</p>
<h2 id="parent-class-pipeline-transformerspipeline">Parent class: <code>Pipeline</code> [[transformers.Pipeline]]</h2>
<p>[[autodoc]] Pipeline</p>












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../../../../../../..", "features": ["navigation.tabs", "navigation.indexes", "navigation.instant", "navigation.sections", "navigation.top", "navigation.tracking", "search.highlight", "search.share", "search.suggest", "toc.follow", "content.tabs.link", "content.code.copy"], "search": "../../../../../../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../../../../../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
    
  </body>
</html>