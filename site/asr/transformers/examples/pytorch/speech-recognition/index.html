
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      
      
      <link rel="icon" href="../../../../../assets/favicon.ico">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.22">
    
    
      
        <title>Index - Ohayou</title>
      
    
    
      <link rel="stylesheet" href="../../../../../assets/stylesheets/main.84d31ad4.min.css">
      
        
        <link rel="stylesheet" href="../../../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../../../assets/extra.css">
    
    <script>__md_scope=new URL("../../../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#automatic-speech-recognition-examples" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../../.." title="Ohayou" class="md-header__button md-logo" aria-label="Ohayou" data-md-component="logo">
      
  <img src="../../../../../assets/logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Ohayou
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Index
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../../ohayou/" class="md-tabs__link">
        
  
  
    
  
  Ohayou

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../../vllm/open_ai_vllm_example_a_v_t/" class="md-tabs__link">
          
  
  
    
  
  vLLM

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../../llm/speculative_decoding/" class="md-tabs__link">
          
  
  
    
  
  LLM

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../../vlm/qwen3_vl_4B_object_detection/" class="md-tabs__link">
          
  
  
    
  
  VLM

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../../md_format_helpers/" class="md-tabs__link">
        
  
  
    
  
  MD format helpers

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../../docker/" class="md-tabs__link">
        
  
  
    
  
  Docker

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../../linux/" class="md-tabs__link">
        
  
  
    
  
  Linux

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../../moe/" class="md-tabs__link">
        
  
  
    
  
  Mixture of Experts

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../../slurm/" class="md-tabs__link">
        
  
  
    
  
  Slurm

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../../japanese-phrases/" class="md-tabs__link">
          
  
  
    
  
  Japanese Phrases

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../../hackathon/index.md" class="md-tabs__link">
        
  
  
    
  
  Hack

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../../.." title="Ohayou" class="md-nav__button md-logo" aria-label="Ohayou" data-md-component="logo">
      
  <img src="../../../../../assets/logo.png" alt="logo">

    </a>
    Ohayou
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../ohayou/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Ohayou
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    vLLM
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            vLLM
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../vllm/open_ai_vllm_example_a_v_t/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Single Request
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../vllm/bash_vllm_serve/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Bash online serve
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../vllm/benchmarks/performance_eval/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Benchmarks
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    LLM
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            LLM
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../llm/speculative_decoding/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Speculative Decoding
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    VLM
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            VLM
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../vlm/qwen3_vl_4B_object_detection/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Qwen3VL
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../md_format_helpers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    MD format helpers
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../docker/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Docker
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../linux/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Linux
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../moe/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Mixture of Experts
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../slurm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Slurm
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../../japanese-phrases/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Japanese Phrases
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_11" id="__nav_11_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_11">
            <span class="md-nav__icon md-icon"></span>
            Japanese Phrases
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11_2" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../../japanese-phrases/daily-life/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Daily Life
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_11_2" id="__nav_11_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_11_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_11_2">
            <span class="md-nav__icon md-icon"></span>
            Daily Life
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../japanese-phrases/daily-life/shopping/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Shopping
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11_3" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../../japanese-phrases/greetings/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Greetings
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_11_3" id="__nav_11_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_11_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_11_3">
            <span class="md-nav__icon md-icon"></span>
            Greetings
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../japanese-phrases/greetings/casual/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Casual
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../japanese-phrases/emotions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Emotions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../japanese-phrases/anime-manga/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Anime/Manga
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../hackathon/index.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Hack
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#table-of-contents" class="md-nav__link">
    <span class="md-ellipsis">
      Table of Contents
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#connectionist-temporal-classification" class="md-nav__link">
    <span class="md-ellipsis">
      Connectionist Temporal Classification
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Connectionist Temporal Classification">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#single-gpu-ctc" class="md-nav__link">
    <span class="md-ellipsis">
      Single GPU CTC
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#multi-gpu-ctc" class="md-nav__link">
    <span class="md-ellipsis">
      Multi GPU CTC
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#multi-gpu-ctc-with-dataset-streaming" class="md-nav__link">
    <span class="md-ellipsis">
      Multi GPU CTC with Dataset Streaming
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#examples-ctc" class="md-nav__link">
    <span class="md-ellipsis">
      Examples CTC
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Examples CTC">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#timit-ctc" class="md-nav__link">
    <span class="md-ellipsis">
      TIMIT CTC
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#librispeech-ctc" class="md-nav__link">
    <span class="md-ellipsis">
      Librispeech CTC
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#common-voice-ctc" class="md-nav__link">
    <span class="md-ellipsis">
      Common Voice CTC
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#multilingual-librispeech-ctc" class="md-nav__link">
    <span class="md-ellipsis">
      Multilingual Librispeech CTC
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#connectionist-temporal-classification-with-adapters" class="md-nav__link">
    <span class="md-ellipsis">
      Connectionist Temporal Classification With Adapters
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Connectionist Temporal Classification With Adapters">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mms-model" class="md-nav__link">
    <span class="md-ellipsis">
      MMS Model
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#examples-ctc-adapter" class="md-nav__link">
    <span class="md-ellipsis">
      Examples CTC Adapter
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Examples CTC Adapter">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#common-voice-ctc-adapter" class="md-nav__link">
    <span class="md-ellipsis">
      Common Voice CTC Adapter
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sequence-to-sequence" class="md-nav__link">
    <span class="md-ellipsis">
      Sequence to Sequence
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Sequence to Sequence">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#whisper-model" class="md-nav__link">
    <span class="md-ellipsis">
      Whisper Model
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Whisper Model">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#single-gpu-whisper-training" class="md-nav__link">
    <span class="md-ellipsis">
      Single GPU Whisper Training
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#multi-gpu-whisper-training" class="md-nav__link">
    <span class="md-ellipsis">
      Multi GPU Whisper Training
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#warm-started-speech-encoder-decoder-model" class="md-nav__link">
    <span class="md-ellipsis">
      Warm-Started Speech-Encoder-Decoder Model
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Warm-Started Speech-Encoder-Decoder Model">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#single-gpu-seq2seq" class="md-nav__link">
    <span class="md-ellipsis">
      Single GPU Seq2Seq
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#multi-gpu-seq2seq" class="md-nav__link">
    <span class="md-ellipsis">
      Multi GPU Seq2Seq
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#examples-seq2seq" class="md-nav__link">
    <span class="md-ellipsis">
      Examples Seq2Seq
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Examples Seq2Seq">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#librispeech-seq2seq" class="md-nav__link">
    <span class="md-ellipsis">
      Librispeech Seq2Seq
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<!---
Copyright 2021 The HuggingFace Team. All rights reserved.

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
-->

<h1 id="automatic-speech-recognition-examples">Automatic Speech Recognition Examples</h1>
<h2 id="table-of-contents">Table of Contents</h2>
<ul>
<li><a href="#connectionist-temporal-classification">Automatic Speech Recognition with CTC</a><ul>
<li><a href="#single-gpu-ctc">Single GPU example</a></li>
<li><a href="#multi-gpu-ctc">Multi GPU example</a></li>
<li><a href="#examples-ctc">Examples</a><ul>
<li><a href="#timit-ctc">TIMIT</a></li>
<li><a href="#librispeech-ctc">Librispeech</a></li>
<li><a href="#common-voice-ctc">Common Voice</a></li>
<li><a href="#multilingual-librispeech-ctc">Multilingual Librispeech</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#connectionist-temporal-classification-with-adapters">Automatic Speech Recognition with CTC and Adapter Layers</a><ul>
<li><a href="#mms-model">Massive Multilingual Speech (MMS)</a></li>
<li><a href="#examples-ctc-adapter">Examples</a><ul>
<li><a href="#common-voice-ctc-adapter">Common Voice</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#sequence-to-sequence">Automatic Speech Recognition with Sequence-to-Sequence</a><ul>
<li><a href="#whisper-model">Whisper Model</a></li>
<li><a href="#warm-started-speech-encoder-decoder-model">Speech-Encoder-Decoder Model</a></li>
<li><a href="#examples-seq2seq">Examples</a><ul>
<li><a href="#librispeech-seq2seq">Librispeech</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="connectionist-temporal-classification">Connectionist Temporal Classification</h2>
<p>The script <a href="https://github.com/huggingface/transformers/blob/main/examples/pytorch/speech-recognition/run_speech_recognition_ctc.py"><code>run_speech_recognition_ctc.py</code></a> can be used to fine-tune any pretrained <a href="https://huggingface.co/docs/transformers/main/en/model_doc/auto#transformers.AutoModelForCTC">Connectionist Temporal Classification Model</a> for automatic speech 
recognition on one of the <a href="https://huggingface.co/datasets?task_ids=task_ids:automatic-speech-recognition">official speech recognition datasets</a> or a custom dataset.</p>
<p>Speech recognition models that have been pretrained in unsupervised fashion on audio data alone, <em>e.g.</em> <a href="https://huggingface.co/transformers/main/model_doc/wav2vec2.html">Wav2Vec2</a>, <a href="https://huggingface.co/transformers/main/model_doc/hubert.html">HuBERT</a>, <a href="https://huggingface.co/transformers/main/model_doc/xlsr_wav2vec2.html">XLSR-Wav2Vec2</a>, have shown to require only 
very little annotated data to yield good performance on automatic speech recognition datasets.</p>
<p>In the script [<code>run_speech_recognition_ctc</code>], we first create a vocabulary from all unique characters of both the training data and evaluation data. Then, we preprocesses the speech recognition dataset, which includes correct resampling, normalization and padding. Finally, the pretrained speech recognition model is fine-tuned on the annotated speech recognition datasets using CTC loss.</p>
<hr />
<p><strong>NOTE</strong></p>
<p>If you encounter problems with data preprocessing by setting <code>--preprocessing_num_workers</code> &gt; 1, 
you might want to set the environment variable <code>OMP_NUM_THREADS</code> to 1 as follows:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nv">OMP_NUM_THREADS</span><span class="o">=</span><span class="m">1</span><span class="w"> </span>python<span class="w"> </span>run_speech_recognition_ctc<span class="w"> </span>...
</span></code></pre></div>
<p>If the environment variable is not set, the training script might freeze, <em>i.e.</em> see: https://github.com/pytorch/audio/issues/1021#issuecomment-726915239</p>
<hr />
<h3 id="single-gpu-ctc">Single GPU CTC</h3>
<p>The following command shows how to fine-tune <a href="https://huggingface.co/transformers/main/model_doc/xlsr_wav2vec2.html">XLSR-Wav2Vec2</a> on <a href="https://huggingface.co/datasets/common_voice">Common Voice</a> using a single GPU in half-precision.</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>python<span class="w"> </span>run_speech_recognition_ctc.py<span class="w"> </span><span class="se">\</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="w">    </span>--dataset_name<span class="o">=</span><span class="s2">&quot;mozilla-foundation/common_voice_17_0&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="w">    </span>--model_name_or_path<span class="o">=</span><span class="s2">&quot;facebook/wav2vec2-large-xlsr-53&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="w">    </span>--dataset_config_name<span class="o">=</span><span class="s2">&quot;tr&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-1-5"><a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a><span class="w">    </span>--output_dir<span class="o">=</span><span class="s2">&quot;./wav2vec2-common_voice-tr-demo&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-1-6"><a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a><span class="w">    </span>--num_train_epochs<span class="o">=</span><span class="s2">&quot;15&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-1-7"><a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a><span class="w">    </span>--per_device_train_batch_size<span class="o">=</span><span class="s2">&quot;16&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-1-8"><a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a><span class="w">    </span>--gradient_accumulation_steps<span class="o">=</span><span class="s2">&quot;2&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-1-9"><a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a><span class="w">    </span>--learning_rate<span class="o">=</span><span class="s2">&quot;3e-4&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-1-10"><a id="__codelineno-1-10" name="__codelineno-1-10" href="#__codelineno-1-10"></a><span class="w">    </span>--warmup_steps<span class="o">=</span><span class="s2">&quot;500&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-1-11"><a id="__codelineno-1-11" name="__codelineno-1-11" href="#__codelineno-1-11"></a><span class="w">    </span>--eval_strategy<span class="o">=</span><span class="s2">&quot;steps&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-1-12"><a id="__codelineno-1-12" name="__codelineno-1-12" href="#__codelineno-1-12"></a><span class="w">    </span>--text_column_name<span class="o">=</span><span class="s2">&quot;sentence&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-1-13"><a id="__codelineno-1-13" name="__codelineno-1-13" href="#__codelineno-1-13"></a><span class="w">    </span>--length_column_name<span class="o">=</span><span class="s2">&quot;input_length&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-1-14"><a id="__codelineno-1-14" name="__codelineno-1-14" href="#__codelineno-1-14"></a><span class="w">    </span>--save_steps<span class="o">=</span><span class="s2">&quot;400&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-1-15"><a id="__codelineno-1-15" name="__codelineno-1-15" href="#__codelineno-1-15"></a><span class="w">    </span>--eval_steps<span class="o">=</span><span class="s2">&quot;100&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-1-16"><a id="__codelineno-1-16" name="__codelineno-1-16" href="#__codelineno-1-16"></a><span class="w">    </span>--layerdrop<span class="o">=</span><span class="s2">&quot;0.0&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-1-17"><a id="__codelineno-1-17" name="__codelineno-1-17" href="#__codelineno-1-17"></a><span class="w">    </span>--save_total_limit<span class="o">=</span><span class="s2">&quot;3&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-1-18"><a id="__codelineno-1-18" name="__codelineno-1-18" href="#__codelineno-1-18"></a><span class="w">    </span>--freeze_feature_encoder<span class="w"> </span><span class="se">\</span>
</span><span id="__span-1-19"><a id="__codelineno-1-19" name="__codelineno-1-19" href="#__codelineno-1-19"></a><span class="w">    </span>--gradient_checkpointing<span class="w"> </span><span class="se">\</span>
</span><span id="__span-1-20"><a id="__codelineno-1-20" name="__codelineno-1-20" href="#__codelineno-1-20"></a><span class="w">    </span>--chars_to_ignore<span class="w"> </span>,<span class="w"> </span>?<span class="w"> </span>.<span class="w"> </span>!<span class="w"> </span>-<span class="w"> </span><span class="se">\;</span><span class="w"> </span><span class="se">\:</span><span class="w"> </span><span class="se">\&quot;</span><span class="w"> </span>“<span class="w"> </span>%<span class="w"> </span>‘<span class="w"> </span>”<span class="w"> </span>�<span class="w"> </span><span class="se">\</span>
</span><span id="__span-1-21"><a id="__codelineno-1-21" name="__codelineno-1-21" href="#__codelineno-1-21"></a><span class="w">    </span>--fp16<span class="w"> </span><span class="se">\</span>
</span><span id="__span-1-22"><a id="__codelineno-1-22" name="__codelineno-1-22" href="#__codelineno-1-22"></a><span class="w">    </span>--group_by_length<span class="w"> </span><span class="se">\</span>
</span><span id="__span-1-23"><a id="__codelineno-1-23" name="__codelineno-1-23" href="#__codelineno-1-23"></a><span class="w">    </span>--push_to_hub<span class="w"> </span><span class="se">\</span>
</span><span id="__span-1-24"><a id="__codelineno-1-24" name="__codelineno-1-24" href="#__codelineno-1-24"></a><span class="w">    </span>--do_train<span class="w"> </span>--do_eval<span class="w"> </span>
</span></code></pre></div>
<p>On a single V100 GPU, this script should run in <em>ca.</em> 1 hour 20 minutes and yield a CTC loss of <strong>0.39</strong> and word error rate
of <strong>0.35</strong>.</p>
<h3 id="multi-gpu-ctc">Multi GPU CTC</h3>
<p>The following command shows how to fine-tune <a href="https://huggingface.co/transformers/main/model_doc/xlsr_wav2vec2.html">XLSR-Wav2Vec2</a> on <a href="https://huggingface.co/datasets/common_voice">Common Voice</a> using 8 GPUs in half-precision.</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>torchrun<span class="w"> </span><span class="se">\</span>
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="w">    </span>--nproc_per_node<span class="w"> </span><span class="m">8</span><span class="w"> </span>run_speech_recognition_ctc.py<span class="w"> </span><span class="se">\</span>
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a><span class="w">    </span>--dataset_name<span class="o">=</span><span class="s2">&quot;mozilla-foundation/common_voice_17_0&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a><span class="w">    </span>--model_name_or_path<span class="o">=</span><span class="s2">&quot;facebook/wav2vec2-large-xlsr-53&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a><span class="w">    </span>--dataset_config_name<span class="o">=</span><span class="s2">&quot;tr&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-2-6"><a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a><span class="w">    </span>--output_dir<span class="o">=</span><span class="s2">&quot;./wav2vec2-common_voice-tr-demo-dist&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-2-7"><a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a><span class="w">    </span>--num_train_epochs<span class="o">=</span><span class="s2">&quot;15&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-2-8"><a id="__codelineno-2-8" name="__codelineno-2-8" href="#__codelineno-2-8"></a><span class="w">    </span>--per_device_train_batch_size<span class="o">=</span><span class="s2">&quot;4&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-2-9"><a id="__codelineno-2-9" name="__codelineno-2-9" href="#__codelineno-2-9"></a><span class="w">    </span>--learning_rate<span class="o">=</span><span class="s2">&quot;3e-4&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-2-10"><a id="__codelineno-2-10" name="__codelineno-2-10" href="#__codelineno-2-10"></a><span class="w">    </span>--warmup_steps<span class="o">=</span><span class="s2">&quot;500&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-2-11"><a id="__codelineno-2-11" name="__codelineno-2-11" href="#__codelineno-2-11"></a><span class="w">    </span>--eval_strategy<span class="o">=</span><span class="s2">&quot;steps&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-2-12"><a id="__codelineno-2-12" name="__codelineno-2-12" href="#__codelineno-2-12"></a><span class="w">    </span>--text_column_name<span class="o">=</span><span class="s2">&quot;sentence&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-2-13"><a id="__codelineno-2-13" name="__codelineno-2-13" href="#__codelineno-2-13"></a><span class="w">    </span>--length_column_name<span class="o">=</span><span class="s2">&quot;input_length&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-2-14"><a id="__codelineno-2-14" name="__codelineno-2-14" href="#__codelineno-2-14"></a><span class="w">    </span>--save_steps<span class="o">=</span><span class="s2">&quot;400&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-2-15"><a id="__codelineno-2-15" name="__codelineno-2-15" href="#__codelineno-2-15"></a><span class="w">    </span>--eval_steps<span class="o">=</span><span class="s2">&quot;100&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-2-16"><a id="__codelineno-2-16" name="__codelineno-2-16" href="#__codelineno-2-16"></a><span class="w">    </span>--logging_steps<span class="o">=</span><span class="s2">&quot;1&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-2-17"><a id="__codelineno-2-17" name="__codelineno-2-17" href="#__codelineno-2-17"></a><span class="w">    </span>--layerdrop<span class="o">=</span><span class="s2">&quot;0.0&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-2-18"><a id="__codelineno-2-18" name="__codelineno-2-18" href="#__codelineno-2-18"></a><span class="w">    </span>--save_total_limit<span class="o">=</span><span class="s2">&quot;3&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-2-19"><a id="__codelineno-2-19" name="__codelineno-2-19" href="#__codelineno-2-19"></a><span class="w">    </span>--freeze_feature_encoder<span class="w"> </span><span class="se">\</span>
</span><span id="__span-2-20"><a id="__codelineno-2-20" name="__codelineno-2-20" href="#__codelineno-2-20"></a><span class="w">    </span>--gradient_checkpointing<span class="w"> </span><span class="se">\</span>
</span><span id="__span-2-21"><a id="__codelineno-2-21" name="__codelineno-2-21" href="#__codelineno-2-21"></a><span class="w">    </span>--chars_to_ignore<span class="w"> </span>,<span class="w"> </span>?<span class="w"> </span>.<span class="w"> </span>!<span class="w"> </span>-<span class="w"> </span><span class="se">\;</span><span class="w"> </span><span class="se">\:</span><span class="w"> </span><span class="se">\&quot;</span><span class="w"> </span>“<span class="w"> </span>%<span class="w"> </span>‘<span class="w"> </span>”<span class="w"> </span>�<span class="w"> </span><span class="se">\</span>
</span><span id="__span-2-22"><a id="__codelineno-2-22" name="__codelineno-2-22" href="#__codelineno-2-22"></a><span class="w">    </span>--fp16<span class="w"> </span><span class="se">\</span>
</span><span id="__span-2-23"><a id="__codelineno-2-23" name="__codelineno-2-23" href="#__codelineno-2-23"></a><span class="w">    </span>--group_by_length<span class="w"> </span><span class="se">\</span>
</span><span id="__span-2-24"><a id="__codelineno-2-24" name="__codelineno-2-24" href="#__codelineno-2-24"></a><span class="w">    </span>--push_to_hub<span class="w"> </span><span class="se">\</span>
</span><span id="__span-2-25"><a id="__codelineno-2-25" name="__codelineno-2-25" href="#__codelineno-2-25"></a><span class="w">    </span>--do_train<span class="w"> </span>--do_eval
</span></code></pre></div>
<p>On 8 V100 GPUs, this script should run in <em>ca.</em> 18 minutes and yield a CTC loss of <strong>0.39</strong> and word error rate
of <strong>0.36</strong>.</p>
<h3 id="multi-gpu-ctc-with-dataset-streaming">Multi GPU CTC with Dataset Streaming</h3>
<p>The following command shows how to use <a href="https://huggingface.co/docs/datasets/dataset_streaming">Dataset Streaming mode</a>
to fine-tune <a href="https://huggingface.co/transformers/main/model_doc/xls_r.html">XLS-R</a> 
on <a href="https://huggingface.co/datasets/common_voice">Common Voice</a> using 4 GPUs in half-precision.</p>
<p>Streaming mode imposes several constraints on training:
1. We need to construct a tokenizer beforehand and define it via <code>--tokenizer_name_or_path</code>.
2. <code>--num_train_epochs</code> has to be replaced by <code>--max_steps</code>. Similarly, all other epoch-based arguments have to be 
replaced by step-based ones.
3. Full dataset shuffling on each epoch is not possible, since we don't have the whole dataset available at once. 
However, the <code>--shuffle_buffer_size</code> argument controls how many examples we can pre-download before shuffling them.</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>**torchrun<span class="w"> </span><span class="se">\</span>
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="w">    </span>--nproc_per_node<span class="w"> </span><span class="m">4</span><span class="w"> </span>run_speech_recognition_ctc_streaming.py<span class="w"> </span><span class="se">\</span>
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a><span class="w">    </span>--dataset_name<span class="o">=</span><span class="s2">&quot;mozilla-foundation/common_voice_17_0&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a><span class="w">    </span>--model_name_or_path<span class="o">=</span><span class="s2">&quot;facebook/wav2vec2-xls-r-300m&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-3-5"><a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a><span class="w">    </span>--tokenizer_name_or_path<span class="o">=</span><span class="s2">&quot;anton-l/wav2vec2-tokenizer-turkish&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-3-6"><a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a><span class="w">    </span>--dataset_config_name<span class="o">=</span><span class="s2">&quot;tr&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-3-7"><a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a><span class="w">    </span>--train_split_name<span class="o">=</span><span class="s2">&quot;train+validation&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-3-8"><a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a><span class="w">    </span>--eval_split_name<span class="o">=</span><span class="s2">&quot;test&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-3-9"><a id="__codelineno-3-9" name="__codelineno-3-9" href="#__codelineno-3-9"></a><span class="w">    </span>--output_dir<span class="o">=</span><span class="s2">&quot;wav2vec2-xls-r-common_voice-tr-ft&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-3-10"><a id="__codelineno-3-10" name="__codelineno-3-10" href="#__codelineno-3-10"></a><span class="w">    </span>--max_steps<span class="o">=</span><span class="s2">&quot;5000&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-3-11"><a id="__codelineno-3-11" name="__codelineno-3-11" href="#__codelineno-3-11"></a><span class="w">    </span>--per_device_train_batch_size<span class="o">=</span><span class="s2">&quot;8&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-3-12"><a id="__codelineno-3-12" name="__codelineno-3-12" href="#__codelineno-3-12"></a><span class="w">    </span>--gradient_accumulation_steps<span class="o">=</span><span class="s2">&quot;2&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-3-13"><a id="__codelineno-3-13" name="__codelineno-3-13" href="#__codelineno-3-13"></a><span class="w">    </span>--learning_rate<span class="o">=</span><span class="s2">&quot;5e-4&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-3-14"><a id="__codelineno-3-14" name="__codelineno-3-14" href="#__codelineno-3-14"></a><span class="w">    </span>--warmup_steps<span class="o">=</span><span class="s2">&quot;500&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-3-15"><a id="__codelineno-3-15" name="__codelineno-3-15" href="#__codelineno-3-15"></a><span class="w">    </span>--eval_strategy<span class="o">=</span><span class="s2">&quot;steps&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-3-16"><a id="__codelineno-3-16" name="__codelineno-3-16" href="#__codelineno-3-16"></a><span class="w">    </span>--text_column_name<span class="o">=</span><span class="s2">&quot;sentence&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-3-17"><a id="__codelineno-3-17" name="__codelineno-3-17" href="#__codelineno-3-17"></a><span class="w">    </span>--save_steps<span class="o">=</span><span class="s2">&quot;500&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-3-18"><a id="__codelineno-3-18" name="__codelineno-3-18" href="#__codelineno-3-18"></a><span class="w">    </span>--eval_steps<span class="o">=</span><span class="s2">&quot;500&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-3-19"><a id="__codelineno-3-19" name="__codelineno-3-19" href="#__codelineno-3-19"></a><span class="w">    </span>--logging_steps<span class="o">=</span><span class="s2">&quot;1&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-3-20"><a id="__codelineno-3-20" name="__codelineno-3-20" href="#__codelineno-3-20"></a><span class="w">    </span>--layerdrop<span class="o">=</span><span class="s2">&quot;0.0&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-3-21"><a id="__codelineno-3-21" name="__codelineno-3-21" href="#__codelineno-3-21"></a><span class="w">    </span>--eval_metrics<span class="w"> </span>wer<span class="w"> </span>cer<span class="w"> </span><span class="se">\</span>
</span><span id="__span-3-22"><a id="__codelineno-3-22" name="__codelineno-3-22" href="#__codelineno-3-22"></a><span class="w">    </span>--save_total_limit<span class="o">=</span><span class="s2">&quot;1&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-3-23"><a id="__codelineno-3-23" name="__codelineno-3-23" href="#__codelineno-3-23"></a><span class="w">    </span>--mask_time_prob<span class="o">=</span><span class="s2">&quot;0.3&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-3-24"><a id="__codelineno-3-24" name="__codelineno-3-24" href="#__codelineno-3-24"></a><span class="w">    </span>--mask_time_length<span class="o">=</span><span class="s2">&quot;10&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-3-25"><a id="__codelineno-3-25" name="__codelineno-3-25" href="#__codelineno-3-25"></a><span class="w">    </span>--mask_feature_prob<span class="o">=</span><span class="s2">&quot;0.1&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-3-26"><a id="__codelineno-3-26" name="__codelineno-3-26" href="#__codelineno-3-26"></a><span class="w">    </span>--mask_feature_length<span class="o">=</span><span class="s2">&quot;64&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-3-27"><a id="__codelineno-3-27" name="__codelineno-3-27" href="#__codelineno-3-27"></a><span class="w">    </span>--freeze_feature_encoder<span class="w"> </span><span class="se">\</span>
</span><span id="__span-3-28"><a id="__codelineno-3-28" name="__codelineno-3-28" href="#__codelineno-3-28"></a><span class="w">    </span>--chars_to_ignore<span class="w"> </span>,<span class="w"> </span>?<span class="w"> </span>.<span class="w"> </span>!<span class="w"> </span>-<span class="w"> </span><span class="se">\;</span><span class="w"> </span><span class="se">\:</span><span class="w"> </span><span class="se">\&quot;</span><span class="w"> </span>“<span class="w"> </span>%<span class="w"> </span>‘<span class="w"> </span>”<span class="w"> </span>�<span class="w"> </span><span class="se">\</span>
</span><span id="__span-3-29"><a id="__codelineno-3-29" name="__codelineno-3-29" href="#__codelineno-3-29"></a><span class="w">    </span>--max_duration_in_seconds<span class="o">=</span><span class="s2">&quot;20&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-3-30"><a id="__codelineno-3-30" name="__codelineno-3-30" href="#__codelineno-3-30"></a><span class="w">    </span>--shuffle_buffer_size<span class="o">=</span><span class="s2">&quot;500&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-3-31"><a id="__codelineno-3-31" name="__codelineno-3-31" href="#__codelineno-3-31"></a><span class="w">    </span>--fp16<span class="w"> </span><span class="se">\</span>
</span><span id="__span-3-32"><a id="__codelineno-3-32" name="__codelineno-3-32" href="#__codelineno-3-32"></a><span class="w">    </span>--push_to_hub<span class="w"> </span><span class="se">\</span>
</span><span id="__span-3-33"><a id="__codelineno-3-33" name="__codelineno-3-33" href="#__codelineno-3-33"></a><span class="w">    </span>--do_train<span class="w"> </span>--do_eval<span class="w"> </span><span class="se">\</span>
</span><span id="__span-3-34"><a id="__codelineno-3-34" name="__codelineno-3-34" href="#__codelineno-3-34"></a><span class="w">    </span>--gradient_checkpointing**
</span></code></pre></div>
<p>On 4 V100 GPUs, this script should run in <em>ca.</em> 3h 31min and yield a CTC loss of <strong>0.35</strong> and word error rate
of <strong>0.29</strong>.</p>
<h3 id="examples-ctc">Examples CTC</h3>
<p>The following tables present a couple of example runs on the most popular speech-recognition datasets. 
The presented performances are by no means optimal as no hyper-parameter tuning was done. Nevertheless, 
they can serve as a baseline to improve upon.</p>
<h4 id="timit-ctc">TIMIT CTC</h4>
<ul>
<li><a href="https://huggingface.co/datasets/timit_asr">TIMIT</a></li>
</ul>
<table>
<thead>
<tr>
<th>Dataset</th>
<th>Dataset Config</th>
<th>Pretrained Model</th>
<th>Word error rate on eval</th>
<th>Phoneme error rate on eval</th>
<th>GPU setup</th>
<th>Training time</th>
<th>Fine-tuned Model &amp; Logs</th>
<th>Command to reproduce</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="https://huggingface.co/datasets/timit_asr">TIMIT</a></td>
<td>-</td>
<td><a href="https://huggingface.co/facebook/wav2vec2-base">wav2vec2-base</a></td>
<td>0.21</td>
<td>-</td>
<td>1 GPU TITAN RTX</td>
<td>32min</td>
<td><a href="https://huggingface.co/patrickvonplaten/wav2vec2-base-timit-fine-tuned">here</a></td>
<td><a href="https://huggingface.co/patrickvonplaten/wav2vec2-base-timit-fine-tuned/blob/main/run.sh">run.sh</a></td>
</tr>
<tr>
<td><a href="https://huggingface.co/datasets/timit_asr">TIMIT</a></td>
<td>-</td>
<td><a href="https://huggingface.co/facebook/wav2vec2-base">wav2vec2-base</a></td>
<td>0.21</td>
<td>-</td>
<td>1 GPU TITAN RTX</td>
<td>32min</td>
<td><a href="https://huggingface.co/patrickvonplaten/wav2vec2-base-timit-fine-tuned">here</a></td>
<td><a href="https://huggingface.co/patrickvonplaten/wav2vec2-base-timit-fine-tuned/blob/main/run.sh">run.sh</a></td>
</tr>
<tr>
<td><a href="https://huggingface.co/datasets/timit_asr">TIMIT</a></td>
<td>-</td>
<td><a href="https://huggingface.co/microsoft/unispeech-large-1500h-cv">unispeech-large-1500h-cv</a></td>
<td>0.22</td>
<td>-</td>
<td>1 GPU TITAN RTX</td>
<td>35min</td>
<td><a href="https://huggingface.co/patrickvonplaten/unispeech-large-1500h-cv-timit">here</a></td>
<td><a href="https://huggingface.co/patrickvonplaten/unispeech-large-1500h-cv-timit/blob/main/run.sh">run.sh</a></td>
</tr>
<tr>
<td><a href="https://huggingface.co/datasets/timit_asr">TIMIT</a></td>
<td>-</td>
<td><a href="https://huggingface.co/asapp/sew-mid-100k">asapp/sew-mid-100k</a></td>
<td>0.30</td>
<td>-</td>
<td>1 GPU TITAN RTX</td>
<td>28min</td>
<td><a href="https://huggingface.co/patrickvonplaten/sew-small-100k-timit">here</a></td>
<td><a href="https://huggingface.co/patrickvonplaten/sew-small-100k-timit/blob/main/run.sh">run.sh</a></td>
</tr>
<tr>
<td><a href="https://huggingface.co/datasets/timit_asr">TIMIT</a></td>
<td>-</td>
<td><a href="https://huggingface.co/ntu-spml/distilhubert">ntu-spml/distilhubert</a></td>
<td>0.68</td>
<td>-</td>
<td>1 GPU TITAN RTX</td>
<td>26min</td>
<td><a href="https://huggingface.co/patrickvonplaten/distilhubert-timit">here</a></td>
<td><a href="https://huggingface.co/patrickvonplaten/distilhubert-timit/blob/main/run.sh">run.sh</a></td>
</tr>
</tbody>
</table>
<h4 id="librispeech-ctc">Librispeech CTC</h4>
<ul>
<li><a href="https://huggingface.co/datasets/librispeech_asr">Librispeech</a></li>
</ul>
<table>
<thead>
<tr>
<th>Dataset</th>
<th>Dataset Config</th>
<th>Pretrained Model</th>
<th>Word error rate on eval</th>
<th>Phoneme error rate on eval</th>
<th>GPU setup</th>
<th>Training time</th>
<th>Fine-tuned Model &amp; Logs</th>
<th>Command to reproduce</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="https://huggingface.co/datasets/librispeech_asr">Librispeech</a></td>
<td><code>"clean"</code> - <code>"train.100"</code></td>
<td><a href="https://huggingface.co/microsoft/wavlm-large">microsoft/wavlm-large</a></td>
<td>0.049</td>
<td>-</td>
<td>8 GPU V100</td>
<td>1h30min</td>
<td><a href="https://huggingface.co/patrickvonplaten/wavlm-libri-clean-100h-large">here</a></td>
<td><a href="https://huggingface.co/patrickvonplaten/wavlm-libri-clean-100h-large/blob/main/run.sh">run.sh</a></td>
</tr>
<tr>
<td><a href="https://huggingface.co/datasets/librispeech_asr">Librispeech</a></td>
<td><code>"clean"</code> - <code>"train.100"</code></td>
<td><a href="https://huggingface.co/microsoft/wavlm-base-plus">microsoft/wavlm-base-plus</a></td>
<td>0.068</td>
<td>-</td>
<td>8 GPU V100</td>
<td>1h30min</td>
<td><a href="https://huggingface.co/patrickvonplaten/wavlm-libri-clean-100h-base-plus">here</a></td>
<td><a href="https://huggingface.co/patrickvonplaten/wavlm-libri-clean-100h-base-plus/blob/main/run.sh">run.sh</a></td>
</tr>
<tr>
<td><a href="https://huggingface.co/datasets/librispeech_asr">Librispeech</a></td>
<td><code>"clean"</code> - <code>"train.100"</code></td>
<td><a href="https://huggingface.co/facebook/wav2vec2-large-lv60">facebook/wav2vec2-large-lv60</a></td>
<td>0.042</td>
<td>-</td>
<td>8 GPU V100</td>
<td>1h30min</td>
<td><a href="https://huggingface.co/patrickvonplaten/wav2vec2-librispeech-clean-100h-demo-dist">here</a></td>
<td><a href="https://huggingface.co/patrickvonplaten/wav2vec2-librispeech-clean-100h-demo-dist/blob/main/run.sh">run.sh</a></td>
</tr>
<tr>
<td><a href="https://huggingface.co/datasets/librispeech_asr">Librispeech</a></td>
<td><code>"clean"</code> - <code>"train.100"</code></td>
<td><a href="https://huggingface.co/facebook/wav2vec2-large-lv60">facebook/wav2vec2-large-lv60</a></td>
<td>0.042</td>
<td>-</td>
<td>8 GPU V100</td>
<td>1h30min</td>
<td><a href="https://huggingface.co/patrickvonplaten/wav2vec2-librispeech-clean-100h-demo-dist">here</a></td>
<td><a href="https://huggingface.co/patrickvonplaten/wav2vec2-librispeech-clean-100h-demo-dist/blob/main/run.sh">run.sh</a></td>
</tr>
<tr>
<td><a href="https://huggingface.co/datasets/librispeech_asr">Librispeech</a></td>
<td><code>"clean"</code> - <code>"train.100"</code></td>
<td><a href="https://huggingface.co/facebook/hubert-large-ll60k">facebook/hubert-large-ll60k</a></td>
<td>0.088</td>
<td>-</td>
<td>8 GPU V100</td>
<td>1h30min</td>
<td><a href="https://huggingface.co/patrickvonplaten/hubert-librispeech-clean-100h-demo-dist">here</a></td>
<td><a href="https://huggingface.co/patrickvonplaten/hubert-librispeech-clean-100h-demo-dist/blob/main/run.sh">run.sh</a></td>
</tr>
<tr>
<td><a href="https://huggingface.co/datasets/librispeech_asr">Librispeech</a></td>
<td><code>"clean"</code> - <code>"train.100"</code></td>
<td><a href="https://huggingface.co/asapp/sew-mid-100k">asapp/sew-mid-100k</a></td>
<td>0.167</td>
<td></td>
<td>8 GPU V100</td>
<td>54min</td>
<td><a href="https://huggingface.co/patrickvonplaten/sew-mid-100k-librispeech-clean-100h-ft">here</a></td>
<td><a href="https://huggingface.co/patrickvonplaten/sew-mid-100k-librispeech-clean-100h-ft/blob/main/run.sh">run.sh</a></td>
</tr>
</tbody>
</table>
<h4 id="common-voice-ctc">Common Voice CTC</h4>
<ul>
<li><a href="https://huggingface.co/datasets/common_voice">Common Voice</a></li>
</ul>
<table>
<thead>
<tr>
<th>Dataset</th>
<th>Dataset Config</th>
<th>Pretrained Model</th>
<th>Word error rate on eval</th>
<th>Phoneme error rate on eval</th>
<th>GPU setup</th>
<th>Training time</th>
<th>Fine-tuned Model &amp; Logs</th>
<th>Command to reproduce</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="https://huggingface.co/datasets/mozilla-foundation/common_voice_3_0">Common Voice</a></td>
<td><code>"tr"</code></td>
<td><a href="https://huggingface.co/facebook/wav2vec2-xls-r-300m">facebook/wav2vec2-large-xls-r-300m</a></td>
<td>-</td>
<td>0.099</td>
<td>8 GPU V100</td>
<td>23min</td>
<td><a href="https://huggingface.co/patrickvonplaten/xls-r-300m-tr-phoneme">here</a></td>
<td><a href="https://huggingface.co/patrickvonplaten/xls-r-300m-tr-phoneme/blob/main/run.sh">run.sh</a></td>
</tr>
<tr>
<td><a href="https://huggingface.co/datasets/mozilla-foundation/common_voice_3_0">Common Voice</a></td>
<td><code>"it"</code></td>
<td><a href="https://huggingface.co/facebook/wav2vec2-xls-r-300m">facebook/wav2vec2-large-xls-r-300m</a></td>
<td>-</td>
<td>0.077</td>
<td>8 GPU V100</td>
<td>23min</td>
<td><a href="https://huggingface.co/patrickvonplaten/xls-r-300m-it-phoneme">here</a></td>
<td><a href="https://huggingface.co/patrickvonplaten/xls-r-300m-it-phoneme/blob/main/run.sh">run.sh</a></td>
</tr>
<tr>
<td><a href="https://huggingface.co/datasets/mozilla-foundation/common_voice_3_0">Common Voice</a></td>
<td><code>"sv-SE"</code></td>
<td><a href="https://huggingface.co/facebook/wav2vec2-xls-r-300m">facebook/wav2vec2-large-xls-r-300m</a></td>
<td>-</td>
<td>0.099</td>
<td>8 GPU V100</td>
<td>23min</td>
<td><a href="https://huggingface.co/patrickvonplaten/xls-r-300m-sv-phoneme">here</a></td>
<td><a href="https://huggingface.co/patrickvonplaten/xls-r-300m-sv-phoneme/blob/main/run.sh">run.sh</a></td>
</tr>
<tr>
<td><a href="https://huggingface.co/datasets/common_voice">Common Voice</a></td>
<td><code>"tr"</code></td>
<td><a href="https://huggingface.co/facebook/wav2vec2-large-xlsr-53">facebook/wav2vec2-large-xlsr-53</a></td>
<td>0.36</td>
<td>-</td>
<td>8 GPU V100</td>
<td>18min</td>
<td><a href="https://huggingface.co/patrickvonplaten/wav2vec2-common_voice-tr-demo-dist">here</a></td>
<td><a href="https://huggingface.co/patrickvonplaten/wav2vec2-common_voice-tr-demo-dist/blob/main/run_dist.sh">run.sh</a></td>
</tr>
<tr>
<td><a href="https://huggingface.co/datasets/common_voice">Common Voice</a></td>
<td><code>"tr"</code></td>
<td><a href="https://huggingface.co/facebook/wav2vec2-large-xlsr-53">facebook/wav2vec2-large-xlsr-53</a></td>
<td>0.31</td>
<td>-</td>
<td>8 GPU V100</td>
<td>1h05</td>
<td><a href="https://huggingface.co/patrickvonplaten/wav2vec2-large-xlsr-53-common_voice-tr-ft">here</a></td>
<td><a href="https://huggingface.co/patrickvonplaten/wav2vec2-large-xlsr-53-common_voice-tr-ft/blob/main/run.sh">run.sh</a></td>
</tr>
<tr>
<td><a href="https://huggingface.co/datasets/common_voice">Common Voice</a></td>
<td><code>"tr"</code></td>
<td><a href="https://huggingface.co/facebook/wav2vec2-large-xlsr-53">facebook/wav2vec2-large-xlsr-53</a></td>
<td>0.35</td>
<td>-</td>
<td>1 GPU V100</td>
<td>1h20min</td>
<td><a href="https://huggingface.co/patrickvonplaten/wav2vec2-common_voice-tr-demo">here</a></td>
<td><a href="https://huggingface.co/patrickvonplaten/wav2vec2-common_voice-tr-demo/blob/main/run.sh">run.sh</a></td>
</tr>
<tr>
<td><a href="https://huggingface.co/datasets/common_voice">Common Voice</a></td>
<td><code>"tr"</code></td>
<td><a href="https://huggingface.co/facebook/wav2vec2-xls-r-300m">facebook/wav2vec2-xls-r-300m</a></td>
<td>0.31</td>
<td>-</td>
<td>8 GPU V100</td>
<td>1h05</td>
<td><a href="https://huggingface.co/patrickvonplaten/wav2vec2-large-xls-r-300m-common_voice-tr-ft">here</a></td>
<td><a href="https://huggingface.co/patrickvonplaten/wav2vec2-large-xls-r-300m-common_voice-tr-ft/blob/main/run.sh">run.sh</a></td>
</tr>
<tr>
<td><a href="https://huggingface.co/datasets/common_voice">Common Voice</a></td>
<td><code>"tr"</code></td>
<td><a href="https://huggingface.co/facebook/wav2vec2-xls-r-1b">facebook/wav2vec2-xls-r-1b</a></td>
<td>0.21</td>
<td>-</td>
<td>2 GPU Titan 24 GB RAM</td>
<td>15h10</td>
<td><a href="https://huggingface.co/patrickvonplaten/wav2vec2-xls-r-1b-common_voice-tr-ft">here</a></td>
<td><a href="https://huggingface.co/patrickvonplaten/wav2vec2-large-xls-r-1b-common_voice-tr-ft/blob/main/run.sh">run.sh</a></td>
</tr>
<tr>
<td><a href="https://huggingface.co/datasets/common_voice">Common Voice</a></td>
<td><code>"tr"</code> in streaming mode</td>
<td><a href="https://huggingface.co/facebook/wav2vec2-xls-r-300m">facebook/wav2vec2-xls-r-300m</a></td>
<td>0.29</td>
<td>-</td>
<td>4 GPU V100</td>
<td>3h31</td>
<td><a href="https://huggingface.co/anton-l/wav2vec2-xls-r-common_voice-tr-ft-stream">here</a></td>
<td><a href="https://huggingface.co/anton-l/wav2vec2-xls-r-common_voice-tr-ft-stream/blob/main/run.sh">run.sh</a></td>
</tr>
</tbody>
</table>
<h4 id="multilingual-librispeech-ctc">Multilingual Librispeech CTC</h4>
<ul>
<li><a href="https://huggingface.co/datasets/multilingual_librispeech">Multilingual Librispeech</a></li>
</ul>
<table>
<thead>
<tr>
<th>Dataset</th>
<th>Dataset Config</th>
<th>Pretrained Model</th>
<th>Word error rate on eval</th>
<th>Phoneme error rate on eval</th>
<th>GPU setup</th>
<th>Training time</th>
<th>Fine-tuned Model &amp; Logs</th>
<th>Command to reproduce</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="https://huggingface.co/datasets/multilingual_librispeech">Multilingual Librispeech</a></td>
<td><code>"german"</code></td>
<td><a href="https://huggingface.co/facebook/wav2vec2-large-xlsr-53">facebook/wav2vec2-large-xlsr-53</a></td>
<td>0.13</td>
<td>-</td>
<td>1 GPU Titan 24 GB RAM</td>
<td>15h04</td>
<td><a href="https://huggingface.co/patrickvonplaten/wav2vec2-xlsr-53-300m-mls-german-ft">here</a></td>
<td><a href="https://huggingface.co/patrickvonplaten/wav2vec2-xlsr-53-300m-mls-german-ft/blob/main/run.sh">run.sh</a></td>
</tr>
<tr>
<td><a href="https://huggingface.co/datasets/multilingual_librispeech">Multilingual Librispeech</a></td>
<td><code>"german"</code></td>
<td><a href="https://huggingface.co/facebook/wav2vec2-xls-r-300m">facebook/wav2vec2-xls-r-300m</a></td>
<td>0.15</td>
<td>-</td>
<td>1 GPU Titan 24 GB RAM</td>
<td>15h04</td>
<td><a href="https://huggingface.co/patrickvonplaten/wav2vec2-300m-mls-german-ft">here</a></td>
<td><a href="https://huggingface.co/patrickvonplaten/wav2vec2-300m-mls-german-ft/blob/main/run.sh">run.sh</a></td>
</tr>
</tbody>
</table>
<h2 id="connectionist-temporal-classification-with-adapters">Connectionist Temporal Classification With Adapters</h2>
<p>The script <a href="https://github.com/huggingface/transformers/blob/main/examples/pytorch/speech-recognition/run_speech_recognition_ctc_adapter.py"><code>run_speech_recognition_ctc_adapter.py</code></a> can be used to fine-tune adapter layers for <a href="https://huggingface.co/docs/transformers/main/en/model_doc/mms">Wav2Vec2-like models like MMS</a> for automatic speech recognition.</p>
<h3 id="mms-model">MMS Model</h3>
<p>The <a href="https://huggingface.co/facebook/mms-1b-all">Massive Multilingual Speech (MMS) model</a> has been pre-trained and fine-tuned
on 1000+ languages. The model makes use of adapter attention layers to fine-tune only a small part 
of the model on a specific language. The model already comes with fine-tuned adapter layers for 1000+ languages and 
can be used for inference for 1000+ languages out of the box.</p>
<p>However, for improved performance or more specific use cases one can re-initialize the adapter weights, freeze all 
other weights and fine-tune them on a specific dataset as shown in the <a href="#examples-ctc-adapter">example below</a>.</p>
<p>Note that the adapter weights include low dimensional linear layers for every attention block as well as the final language
model head layers.</p>
<h3 id="examples-ctc-adapter">Examples CTC Adapter</h3>
<p>In the following we will look at how one can fine-tune adapter weights for any of the 
<a href="https://huggingface.co/models?pipeline_tag=automatic-speech-recognition&amp;other=mms&amp;sort=downloads">MMS CTC checkpoints</a> in less than 1 hour.</p>
<h4 id="common-voice-ctc-adapter">Common Voice CTC Adapter</h4>
<p>As in the examples <a href="#examples-ctc">above</a>, we fine-tune on Common Voice's 6 dataset in Turkish as an example.
Contrary to <a href="https://github.com/huggingface/transformers/blob/main/examples/pytorch/speech-recognition/run_speech_recognition_ctc.py"><code>run_speech_recognition_ctc.py</code></a> before there is a <code>--target_language</code> which has to be defined to state for which 
language or concept the adapter layers shall be trained. The adapter weights will then 
accordingly be called <code>adapter.{&lt;target_language}.safetensors</code>.</p>
<p>Let's run an example script. Make sure to be logged in so that your model can be directly uploaded to the Hub.
<div class="language-bash highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a>hf<span class="w"> </span>auth<span class="w"> </span>login
</span></code></pre></div></p>
<p>Now, let's run an example and upload it to the Hub under <code>wav2vec2-common_voice-tr-mms-demo</code>.</p>
<div class="language-sh highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a>python<span class="w"> </span>run_speech_recognition_ctc.py<span class="w"> </span><span class="se">\</span>
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a><span class="w">    </span>--dataset_name<span class="o">=</span><span class="s2">&quot;common_voice&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a><span class="w">    </span>--model_name_or_path<span class="o">=</span><span class="s2">&quot;facebook/mms-1b-all&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-5-4"><a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a><span class="w">    </span>--dataset_config_name<span class="o">=</span><span class="s2">&quot;tr&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-5-5"><a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a><span class="w">    </span>--output_dir<span class="o">=</span><span class="s2">&quot;./wav2vec2-common_voice-tr-mms-demo&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-5-6"><a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a><span class="w">    </span>--num_train_epochs<span class="o">=</span><span class="s2">&quot;4&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-5-7"><a id="__codelineno-5-7" name="__codelineno-5-7" href="#__codelineno-5-7"></a><span class="w">    </span>--per_device_train_batch_size<span class="o">=</span><span class="s2">&quot;32&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-5-8"><a id="__codelineno-5-8" name="__codelineno-5-8" href="#__codelineno-5-8"></a><span class="w">    </span>--learning_rate<span class="o">=</span><span class="s2">&quot;1e-3&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-5-9"><a id="__codelineno-5-9" name="__codelineno-5-9" href="#__codelineno-5-9"></a><span class="w">    </span>--warmup_steps<span class="o">=</span><span class="s2">&quot;100&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-5-10"><a id="__codelineno-5-10" name="__codelineno-5-10" href="#__codelineno-5-10"></a><span class="w">    </span>--eval_strategy<span class="o">=</span><span class="s2">&quot;steps&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-5-11"><a id="__codelineno-5-11" name="__codelineno-5-11" href="#__codelineno-5-11"></a><span class="w">    </span>--text_column_name<span class="o">=</span><span class="s2">&quot;sentence&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-5-12"><a id="__codelineno-5-12" name="__codelineno-5-12" href="#__codelineno-5-12"></a><span class="w">    </span>--length_column_name<span class="o">=</span><span class="s2">&quot;input_length&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-5-13"><a id="__codelineno-5-13" name="__codelineno-5-13" href="#__codelineno-5-13"></a><span class="w">    </span>--save_steps<span class="o">=</span><span class="s2">&quot;200&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-5-14"><a id="__codelineno-5-14" name="__codelineno-5-14" href="#__codelineno-5-14"></a><span class="w">    </span>--eval_steps<span class="o">=</span><span class="s2">&quot;100&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-5-15"><a id="__codelineno-5-15" name="__codelineno-5-15" href="#__codelineno-5-15"></a><span class="w">    </span>--save_total_limit<span class="o">=</span><span class="s2">&quot;3&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-5-16"><a id="__codelineno-5-16" name="__codelineno-5-16" href="#__codelineno-5-16"></a><span class="w">  </span>--target_language<span class="o">=</span><span class="s2">&quot;tur&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-5-17"><a id="__codelineno-5-17" name="__codelineno-5-17" href="#__codelineno-5-17"></a><span class="w">    </span>--gradient_checkpointing<span class="w"> </span><span class="se">\</span>
</span><span id="__span-5-18"><a id="__codelineno-5-18" name="__codelineno-5-18" href="#__codelineno-5-18"></a><span class="w">    </span>--chars_to_ignore<span class="w"> </span>,<span class="w"> </span>?<span class="w"> </span>.<span class="w"> </span>!<span class="w"> </span>-<span class="w"> </span><span class="se">\;</span><span class="w"> </span><span class="se">\:</span><span class="w"> </span><span class="se">\&quot;</span><span class="w"> </span>“<span class="w"> </span>%<span class="w"> </span>‘<span class="w"> </span>”<span class="w"> </span>�<span class="w"> </span><span class="se">\</span>
</span><span id="__span-5-19"><a id="__codelineno-5-19" name="__codelineno-5-19" href="#__codelineno-5-19"></a><span class="w">    </span>--fp16<span class="w"> </span><span class="se">\</span>
</span><span id="__span-5-20"><a id="__codelineno-5-20" name="__codelineno-5-20" href="#__codelineno-5-20"></a><span class="w">    </span>--group_by_length<span class="w"> </span><span class="se">\</span>
</span><span id="__span-5-21"><a id="__codelineno-5-21" name="__codelineno-5-21" href="#__codelineno-5-21"></a><span class="w">    </span>--do_train<span class="w"> </span>--do_eval<span class="w"> </span><span class="se">\</span>
</span><span id="__span-5-22"><a id="__codelineno-5-22" name="__codelineno-5-22" href="#__codelineno-5-22"></a><span class="w">  </span>--push_to_hub
</span></code></pre></div>
<p>This should take less than 10 minutes on most GPUs and you should very quickly get word error rates 
below 27%.</p>
<p>For an example run, you can have a look at <a href="https://huggingface.co/patrickvonplaten/wav2vec2-common_voice-tr-mms-demo"><code>patrickvonplaten/wav2vec2-common_voice-tr-mms-demo</code></a>.</p>
<p>If you'd like to train another adapter model with the same base model, you can simply reuse the same <code>--output_dir</code>,
but make sure to pass the <code>--output_dir</code> folder also to <code>--tokenizer_name_or_path</code> so that the vocabulary is not 
overwritten but <strong>extended</strong>. Assuming you would like to train adapter weights on Swedish in addition to Turkish and save 
the adapter weights in the same model repo, you can run:</p>
<div class="language-sh highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a>python<span class="w"> </span>run_speech_recognition_ctc.py<span class="w"> </span><span class="se">\</span>
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a><span class="w">    </span>--dataset_name<span class="o">=</span><span class="s2">&quot;common_voice&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a><span class="w">    </span>--model_name_or_path<span class="o">=</span><span class="s2">&quot;facebook/mms-1b-all&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-6-4"><a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a><span class="w">    </span>--dataset_config_name<span class="o">=</span><span class="s2">&quot;sw&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-6-5"><a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a><span class="w">    </span>--output_dir<span class="o">=</span><span class="s2">&quot;./wav2vec2-common_voice-tr-mms-demo&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-6-6"><a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a><span class="w">    </span>--tokenizer_name_or_path<span class="o">=</span><span class="s2">&quot;./wav2vec2-common_voice-tr-mms-demo&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-6-7"><a id="__codelineno-6-7" name="__codelineno-6-7" href="#__codelineno-6-7"></a><span class="w">    </span>--num_train_epochs<span class="o">=</span><span class="s2">&quot;4&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-6-8"><a id="__codelineno-6-8" name="__codelineno-6-8" href="#__codelineno-6-8"></a><span class="w">    </span>--per_device_train_batch_size<span class="o">=</span><span class="s2">&quot;32&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-6-9"><a id="__codelineno-6-9" name="__codelineno-6-9" href="#__codelineno-6-9"></a><span class="w">    </span>--learning_rate<span class="o">=</span><span class="s2">&quot;1e-3&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-6-10"><a id="__codelineno-6-10" name="__codelineno-6-10" href="#__codelineno-6-10"></a><span class="w">    </span>--warmup_steps<span class="o">=</span><span class="s2">&quot;100&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-6-11"><a id="__codelineno-6-11" name="__codelineno-6-11" href="#__codelineno-6-11"></a><span class="w">    </span>--eval_strategy<span class="o">=</span><span class="s2">&quot;steps&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-6-12"><a id="__codelineno-6-12" name="__codelineno-6-12" href="#__codelineno-6-12"></a><span class="w">    </span>--text_column_name<span class="o">=</span><span class="s2">&quot;sentence&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-6-13"><a id="__codelineno-6-13" name="__codelineno-6-13" href="#__codelineno-6-13"></a><span class="w">    </span>--length_column_name<span class="o">=</span><span class="s2">&quot;input_length&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-6-14"><a id="__codelineno-6-14" name="__codelineno-6-14" href="#__codelineno-6-14"></a><span class="w">    </span>--save_steps<span class="o">=</span><span class="s2">&quot;200&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-6-15"><a id="__codelineno-6-15" name="__codelineno-6-15" href="#__codelineno-6-15"></a><span class="w">    </span>--eval_steps<span class="o">=</span><span class="s2">&quot;100&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-6-16"><a id="__codelineno-6-16" name="__codelineno-6-16" href="#__codelineno-6-16"></a><span class="w">    </span>--save_total_limit<span class="o">=</span><span class="s2">&quot;3&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-6-17"><a id="__codelineno-6-17" name="__codelineno-6-17" href="#__codelineno-6-17"></a><span class="w">  </span>--target_language<span class="o">=</span><span class="s2">&quot;swe&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-6-18"><a id="__codelineno-6-18" name="__codelineno-6-18" href="#__codelineno-6-18"></a><span class="w">    </span>--gradient_checkpointing<span class="w"> </span><span class="se">\</span>
</span><span id="__span-6-19"><a id="__codelineno-6-19" name="__codelineno-6-19" href="#__codelineno-6-19"></a><span class="w">    </span>--chars_to_ignore<span class="w"> </span>,<span class="w"> </span>?<span class="w"> </span>.<span class="w"> </span>!<span class="w"> </span>-<span class="w"> </span><span class="se">\;</span><span class="w"> </span><span class="se">\:</span><span class="w"> </span><span class="se">\&quot;</span><span class="w"> </span>“<span class="w"> </span>%<span class="w"> </span>‘<span class="w"> </span>”<span class="w"> </span>�<span class="w"> </span><span class="se">\</span>
</span><span id="__span-6-20"><a id="__codelineno-6-20" name="__codelineno-6-20" href="#__codelineno-6-20"></a><span class="w">    </span>--fp16<span class="w"> </span><span class="se">\</span>
</span><span id="__span-6-21"><a id="__codelineno-6-21" name="__codelineno-6-21" href="#__codelineno-6-21"></a><span class="w">    </span>--group_by_length<span class="w"> </span><span class="se">\</span>
</span><span id="__span-6-22"><a id="__codelineno-6-22" name="__codelineno-6-22" href="#__codelineno-6-22"></a><span class="w">    </span>--do_train<span class="w"> </span>--do_eval<span class="w"> </span><span class="se">\</span>
</span><span id="__span-6-23"><a id="__codelineno-6-23" name="__codelineno-6-23" href="#__codelineno-6-23"></a><span class="w">  </span>--push_to_hub
</span></code></pre></div>
<p>Now you should have both <code>adapter.tur.safetensors</code> and <code>adapter.swe.safetensors</code> in the model repo
and you can load the respective language with:
<div class="language-py highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="n">model</span><span class="o">.</span><span class="n">load_adapter</span><span class="p">(</span><span class="s2">&quot;tur&quot;</span><span class="p">)</span>  <span class="c1"># or &quot;swe&quot;</span>
</span></code></pre></div>
respectively.</p>
<h2 id="sequence-to-sequence">Sequence to Sequence</h2>
<p>The script <a href="https://github.com/huggingface/transformers/blob/main/examples/pytorch/speech-recognition/run_speech_recognition_seq2seq.py"><code>run_speech_recognition_seq2seq.py</code></a> can be used to fine-tune any <a href="https://huggingface.co/docs/transformers/main/en/model_doc/auto#transformers.AutoModelForSpeechSeq2Seq">Speech Sequence-to-Sequence Model</a> for automatic speech 
recognition on one of the <a href="https://huggingface.co/datasets?task_ids=task_ids:automatic-speech-recognition">official speech recognition datasets</a> or a custom dataset. This includes the Whisper model from OpenAI or a warm-started Speech-Encoder-Decoder Model, examples for which are included below.</p>
<h3 id="whisper-model">Whisper Model</h3>
<p>We can load all components of the Whisper model directly from the pretrained checkpoint, including the pretrained model weights, feature extractor and tokenizer. We simply have to specify our fine-tuning dataset and training hyperparameters.</p>
<h4 id="single-gpu-whisper-training">Single GPU Whisper Training</h4>
<p>The following example shows how to fine-tune the <a href="https://huggingface.co/openai/whisper-small">Whisper small</a> checkpoint on the Hindi subset of <a href="https://huggingface.co/datasets/mozilla-foundation/common_voice_11_0">Common Voice 11</a> using a single GPU device in half-precision:
<div class="language-bash highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a>python<span class="w"> </span>run_speech_recognition_seq2seq.py<span class="w"> </span><span class="se">\</span>
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a><span class="w">    </span>--model_name_or_path<span class="o">=</span><span class="s2">&quot;openai/whisper-small&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-8-3"><a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a><span class="w">    </span>--dataset_name<span class="o">=</span><span class="s2">&quot;mozilla-foundation/common_voice_11_0&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-8-4"><a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a><span class="w">    </span>--dataset_config_name<span class="o">=</span><span class="s2">&quot;hi&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-8-5"><a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a><span class="w">    </span>--language<span class="o">=</span><span class="s2">&quot;hindi&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-8-6"><a id="__codelineno-8-6" name="__codelineno-8-6" href="#__codelineno-8-6"></a><span class="w">    </span>--task<span class="o">=</span><span class="s2">&quot;transcribe&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-8-7"><a id="__codelineno-8-7" name="__codelineno-8-7" href="#__codelineno-8-7"></a><span class="w">    </span>--train_split_name<span class="o">=</span><span class="s2">&quot;train+validation&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-8-8"><a id="__codelineno-8-8" name="__codelineno-8-8" href="#__codelineno-8-8"></a><span class="w">    </span>--eval_split_name<span class="o">=</span><span class="s2">&quot;test&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-8-9"><a id="__codelineno-8-9" name="__codelineno-8-9" href="#__codelineno-8-9"></a><span class="w">    </span>--max_steps<span class="o">=</span><span class="s2">&quot;5000&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-8-10"><a id="__codelineno-8-10" name="__codelineno-8-10" href="#__codelineno-8-10"></a><span class="w">    </span>--output_dir<span class="o">=</span><span class="s2">&quot;./whisper-small-hi&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-8-11"><a id="__codelineno-8-11" name="__codelineno-8-11" href="#__codelineno-8-11"></a><span class="w">    </span>--per_device_train_batch_size<span class="o">=</span><span class="s2">&quot;16&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-8-12"><a id="__codelineno-8-12" name="__codelineno-8-12" href="#__codelineno-8-12"></a><span class="w">    </span>--gradient_accumulation_steps<span class="o">=</span><span class="s2">&quot;2&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-8-13"><a id="__codelineno-8-13" name="__codelineno-8-13" href="#__codelineno-8-13"></a><span class="w">    </span>--per_device_eval_batch_size<span class="o">=</span><span class="s2">&quot;16&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-8-14"><a id="__codelineno-8-14" name="__codelineno-8-14" href="#__codelineno-8-14"></a><span class="w">    </span>--logging_steps<span class="o">=</span><span class="s2">&quot;25&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-8-15"><a id="__codelineno-8-15" name="__codelineno-8-15" href="#__codelineno-8-15"></a><span class="w">    </span>--learning_rate<span class="o">=</span><span class="s2">&quot;1e-5&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-8-16"><a id="__codelineno-8-16" name="__codelineno-8-16" href="#__codelineno-8-16"></a><span class="w">    </span>--warmup_steps<span class="o">=</span><span class="s2">&quot;500&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-8-17"><a id="__codelineno-8-17" name="__codelineno-8-17" href="#__codelineno-8-17"></a><span class="w">    </span>--eval_strategy<span class="o">=</span><span class="s2">&quot;steps&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-8-18"><a id="__codelineno-8-18" name="__codelineno-8-18" href="#__codelineno-8-18"></a><span class="w">    </span>--eval_steps<span class="o">=</span><span class="s2">&quot;1000&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-8-19"><a id="__codelineno-8-19" name="__codelineno-8-19" href="#__codelineno-8-19"></a><span class="w">    </span>--save_strategy<span class="o">=</span><span class="s2">&quot;steps&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-8-20"><a id="__codelineno-8-20" name="__codelineno-8-20" href="#__codelineno-8-20"></a><span class="w">    </span>--save_steps<span class="o">=</span><span class="s2">&quot;1000&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-8-21"><a id="__codelineno-8-21" name="__codelineno-8-21" href="#__codelineno-8-21"></a><span class="w">    </span>--generation_max_length<span class="o">=</span><span class="s2">&quot;225&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-8-22"><a id="__codelineno-8-22" name="__codelineno-8-22" href="#__codelineno-8-22"></a><span class="w">    </span>--preprocessing_num_workers<span class="o">=</span><span class="s2">&quot;16&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-8-23"><a id="__codelineno-8-23" name="__codelineno-8-23" href="#__codelineno-8-23"></a><span class="w">    </span>--max_duration_in_seconds<span class="o">=</span><span class="s2">&quot;30&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-8-24"><a id="__codelineno-8-24" name="__codelineno-8-24" href="#__codelineno-8-24"></a><span class="w">    </span>--text_column_name<span class="o">=</span><span class="s2">&quot;sentence&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-8-25"><a id="__codelineno-8-25" name="__codelineno-8-25" href="#__codelineno-8-25"></a><span class="w">    </span>--freeze_feature_encoder<span class="o">=</span><span class="s2">&quot;False&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-8-26"><a id="__codelineno-8-26" name="__codelineno-8-26" href="#__codelineno-8-26"></a><span class="w">    </span>--gradient_checkpointing<span class="w"> </span><span class="se">\</span>
</span><span id="__span-8-27"><a id="__codelineno-8-27" name="__codelineno-8-27" href="#__codelineno-8-27"></a><span class="w">    </span>--fp16<span class="w"> </span><span class="se">\</span>
</span><span id="__span-8-28"><a id="__codelineno-8-28" name="__codelineno-8-28" href="#__codelineno-8-28"></a><span class="w">    </span>--do_train<span class="w"> </span><span class="se">\</span>
</span><span id="__span-8-29"><a id="__codelineno-8-29" name="__codelineno-8-29" href="#__codelineno-8-29"></a><span class="w">    </span>--do_eval<span class="w"> </span><span class="se">\</span>
</span><span id="__span-8-30"><a id="__codelineno-8-30" name="__codelineno-8-30" href="#__codelineno-8-30"></a><span class="w">    </span>--predict_with_generate
</span></code></pre></div>
On a single V100, training should take approximately 8 hours, with a final cross-entropy loss of <strong>1e-4</strong> and word error rate of <strong>32.6%</strong>.</p>
<p>If training on a different language, you should be sure to change the <code>language</code> argument. The <code>language</code> and <code>task</code> 
arguments should be omitted for English speech recognition.</p>
<h4 id="multi-gpu-whisper-training">Multi GPU Whisper Training</h4>
<p>The following example shows how to fine-tune the <a href="https://huggingface.co/openai/whisper-small">Whisper small</a> checkpoint on the Hindi subset of <a href="https://huggingface.co/datasets/mozilla-foundation/common_voice_11_0">Common Voice 11</a> using 2 GPU devices in half-precision:
<div class="language-bash highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a>torchrun<span class="w"> </span><span class="se">\</span>
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a><span class="w">    </span>--nproc_per_node<span class="w"> </span><span class="m">2</span><span class="w"> </span>run_speech_recognition_seq2seq.py<span class="w"> </span><span class="se">\</span>
</span><span id="__span-9-3"><a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a><span class="w">    </span>--model_name_or_path<span class="o">=</span><span class="s2">&quot;openai/whisper-small&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-9-4"><a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a><span class="w">    </span>--dataset_name<span class="o">=</span><span class="s2">&quot;mozilla-foundation/common_voice_11_0&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-9-5"><a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a><span class="w">    </span>--dataset_config_name<span class="o">=</span><span class="s2">&quot;hi&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-9-6"><a id="__codelineno-9-6" name="__codelineno-9-6" href="#__codelineno-9-6"></a><span class="w">    </span>--language<span class="o">=</span><span class="s2">&quot;hindi&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-9-7"><a id="__codelineno-9-7" name="__codelineno-9-7" href="#__codelineno-9-7"></a><span class="w">    </span>--task<span class="o">=</span><span class="s2">&quot;transcribe&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-9-8"><a id="__codelineno-9-8" name="__codelineno-9-8" href="#__codelineno-9-8"></a><span class="w">    </span>--train_split_name<span class="o">=</span><span class="s2">&quot;train+validation&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-9-9"><a id="__codelineno-9-9" name="__codelineno-9-9" href="#__codelineno-9-9"></a><span class="w">    </span>--eval_split_name<span class="o">=</span><span class="s2">&quot;test&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-9-10"><a id="__codelineno-9-10" name="__codelineno-9-10" href="#__codelineno-9-10"></a><span class="w">    </span>--max_steps<span class="o">=</span><span class="s2">&quot;5000&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-9-11"><a id="__codelineno-9-11" name="__codelineno-9-11" href="#__codelineno-9-11"></a><span class="w">    </span>--output_dir<span class="o">=</span><span class="s2">&quot;./whisper-small-hi&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-9-12"><a id="__codelineno-9-12" name="__codelineno-9-12" href="#__codelineno-9-12"></a><span class="w">    </span>--per_device_train_batch_size<span class="o">=</span><span class="s2">&quot;16&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-9-13"><a id="__codelineno-9-13" name="__codelineno-9-13" href="#__codelineno-9-13"></a><span class="w">    </span>--per_device_eval_batch_size<span class="o">=</span><span class="s2">&quot;16&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-9-14"><a id="__codelineno-9-14" name="__codelineno-9-14" href="#__codelineno-9-14"></a><span class="w">    </span>--logging_steps<span class="o">=</span><span class="s2">&quot;25&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-9-15"><a id="__codelineno-9-15" name="__codelineno-9-15" href="#__codelineno-9-15"></a><span class="w">    </span>--learning_rate<span class="o">=</span><span class="s2">&quot;1e-5&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-9-16"><a id="__codelineno-9-16" name="__codelineno-9-16" href="#__codelineno-9-16"></a><span class="w">    </span>--warmup_steps<span class="o">=</span><span class="s2">&quot;500&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-9-17"><a id="__codelineno-9-17" name="__codelineno-9-17" href="#__codelineno-9-17"></a><span class="w">    </span>--eval_strategy<span class="o">=</span><span class="s2">&quot;steps&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-9-18"><a id="__codelineno-9-18" name="__codelineno-9-18" href="#__codelineno-9-18"></a><span class="w">    </span>--eval_steps<span class="o">=</span><span class="s2">&quot;1000&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-9-19"><a id="__codelineno-9-19" name="__codelineno-9-19" href="#__codelineno-9-19"></a><span class="w">    </span>--save_strategy<span class="o">=</span><span class="s2">&quot;steps&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-9-20"><a id="__codelineno-9-20" name="__codelineno-9-20" href="#__codelineno-9-20"></a><span class="w">    </span>--save_steps<span class="o">=</span><span class="s2">&quot;1000&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-9-21"><a id="__codelineno-9-21" name="__codelineno-9-21" href="#__codelineno-9-21"></a><span class="w">    </span>--generation_max_length<span class="o">=</span><span class="s2">&quot;225&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-9-22"><a id="__codelineno-9-22" name="__codelineno-9-22" href="#__codelineno-9-22"></a><span class="w">    </span>--preprocessing_num_workers<span class="o">=</span><span class="s2">&quot;16&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-9-23"><a id="__codelineno-9-23" name="__codelineno-9-23" href="#__codelineno-9-23"></a><span class="w">    </span>--max_duration_in_seconds<span class="o">=</span><span class="s2">&quot;30&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-9-24"><a id="__codelineno-9-24" name="__codelineno-9-24" href="#__codelineno-9-24"></a><span class="w">    </span>--text_column_name<span class="o">=</span><span class="s2">&quot;sentence&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-9-25"><a id="__codelineno-9-25" name="__codelineno-9-25" href="#__codelineno-9-25"></a><span class="w">    </span>--freeze_feature_encoder<span class="o">=</span><span class="s2">&quot;False&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-9-26"><a id="__codelineno-9-26" name="__codelineno-9-26" href="#__codelineno-9-26"></a><span class="w">    </span>--gradient_checkpointing<span class="w"> </span><span class="se">\</span>
</span><span id="__span-9-27"><a id="__codelineno-9-27" name="__codelineno-9-27" href="#__codelineno-9-27"></a><span class="w">    </span>--fp16<span class="w"> </span><span class="se">\</span>
</span><span id="__span-9-28"><a id="__codelineno-9-28" name="__codelineno-9-28" href="#__codelineno-9-28"></a><span class="w">    </span>--do_train<span class="w"> </span><span class="se">\</span>
</span><span id="__span-9-29"><a id="__codelineno-9-29" name="__codelineno-9-29" href="#__codelineno-9-29"></a><span class="w">    </span>--do_eval<span class="w"> </span><span class="se">\</span>
</span><span id="__span-9-30"><a id="__codelineno-9-30" name="__codelineno-9-30" href="#__codelineno-9-30"></a><span class="w">    </span>--predict_with_generate
</span></code></pre></div>
On two V100s, training should take approximately 4 hours, with a final cross-entropy loss of <strong>1e-4</strong> and word error rate of <strong>32.6%</strong>.</p>
<h3 id="warm-started-speech-encoder-decoder-model">Warm-Started Speech-Encoder-Decoder Model</h3>
<p>A very common use case is to leverage a pretrained speech encoder model,
<em>e.g.</em> <a href="https://huggingface.co/transformers/main/model_doc/wav2vec2.html">Wav2Vec2</a>, <a href="https://huggingface.co/transformers/main/model_doc/hubert.html">HuBERT</a> or <a href="https://huggingface.co/transformers/main/model_doc/xlsr_wav2vec2.html">XLSR-Wav2Vec2</a>, with a pretrained text decoder model, <em>e.g.</em> <a href="https://huggingface.co/docs/transformers/main/en/model_doc/bart#transformers.BartForCausalLM">BART</a> or <a href="https://huggingface.co/docs/transformers/main/en/model_doc/gpt2#transformers.GPT2ForCausalLM">GPT-2</a>, to create a <a href="https://huggingface.co/docs/transformers/main/en/model_doc/speech-encoder-decoder#speech-encoder-decoder-models">Speech-Encoder-Decoder Model</a>.</p>
<p>By pairing a pretrained speech model with a pretrained text model, the warm-started model has prior knowledge of both the source audio and target text domains. However, the cross-attention weights between the encoder and decoder are randomly initialised. Thus, the model requires fine-tuning to learn the cross-attention weights and align the encoder mapping with that of the decoder. We can perform this very fine-tuning procedure using the example script.</p>
<p>As an example, let's instantiate a <em>Wav2Vec2-2-Bart</em> model with the <code>SpeechEncoderDecoderModel</code> framework. First create an empty repo on <code>hf.co</code>:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a>hf<span class="w"> </span>repo<span class="w"> </span>create<span class="w"> </span>wav2vec2-2-bart-base
</span><span id="__span-10-2"><a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a>git<span class="w"> </span>clone<span class="w"> </span>https://huggingface.co/&lt;your-user-name&gt;/wav2vec2-2-bart-base
</span><span id="__span-10-3"><a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a><span class="nb">cd</span><span class="w"> </span>wav2vec2-2-bart-base
</span></code></pre></div>
<p>Next, run the following script <strong>inside</strong> the just cloned repo:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">transformers</span><span class="w"> </span><span class="kn">import</span> <span class="n">SpeechEncoderDecoderModel</span><span class="p">,</span> <span class="n">AutoFeatureExtractor</span><span class="p">,</span> <span class="n">AutoTokenizer</span><span class="p">,</span> <span class="n">Wav2Vec2Processor</span>
</span><span id="__span-11-2"><a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a>
</span><span id="__span-11-3"><a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a><span class="c1"># checkpoints to leverage</span>
</span><span id="__span-11-4"><a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a><span class="n">encoder_id</span> <span class="o">=</span> <span class="s2">&quot;facebook/wav2vec2-base&quot;</span>
</span><span id="__span-11-5"><a id="__codelineno-11-5" name="__codelineno-11-5" href="#__codelineno-11-5"></a><span class="n">decoder_id</span> <span class="o">=</span> <span class="s2">&quot;facebook/bart-base&quot;</span>
</span><span id="__span-11-6"><a id="__codelineno-11-6" name="__codelineno-11-6" href="#__codelineno-11-6"></a>
</span><span id="__span-11-7"><a id="__codelineno-11-7" name="__codelineno-11-7" href="#__codelineno-11-7"></a><span class="c1"># load and save speech-encoder-decoder model</span>
</span><span id="__span-11-8"><a id="__codelineno-11-8" name="__codelineno-11-8" href="#__codelineno-11-8"></a><span class="c1"># set some hyper-parameters for training and evaluation</span>
</span><span id="__span-11-9"><a id="__codelineno-11-9" name="__codelineno-11-9" href="#__codelineno-11-9"></a><span class="n">model</span> <span class="o">=</span> <span class="n">SpeechEncoderDecoderModel</span><span class="o">.</span><span class="n">from_encoder_decoder_pretrained</span><span class="p">(</span><span class="n">encoder_id</span><span class="p">,</span> <span class="n">decoder_id</span><span class="p">,</span> <span class="n">encoder_add_adapter</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">encoder_feat_proj_dropout</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">encoder_layerdrop</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">max_length</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">num_beams</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</span><span id="__span-11-10"><a id="__codelineno-11-10" name="__codelineno-11-10" href="#__codelineno-11-10"></a><span class="n">model</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">decoder_start_token_id</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">decoder</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">bos_token_id</span>
</span><span id="__span-11-11"><a id="__codelineno-11-11" name="__codelineno-11-11" href="#__codelineno-11-11"></a><span class="n">model</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">pad_token_id</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">decoder</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">pad_token_id</span>
</span><span id="__span-11-12"><a id="__codelineno-11-12" name="__codelineno-11-12" href="#__codelineno-11-12"></a><span class="n">model</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">eos_token_id</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">decoder</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">eos_token_id</span>
</span><span id="__span-11-13"><a id="__codelineno-11-13" name="__codelineno-11-13" href="#__codelineno-11-13"></a><span class="n">model</span><span class="o">.</span><span class="n">save_pretrained</span><span class="p">(</span><span class="s2">&quot;./&quot;</span><span class="p">)</span>
</span><span id="__span-11-14"><a id="__codelineno-11-14" name="__codelineno-11-14" href="#__codelineno-11-14"></a>
</span><span id="__span-11-15"><a id="__codelineno-11-15" name="__codelineno-11-15" href="#__codelineno-11-15"></a><span class="c1"># load and save processor</span>
</span><span id="__span-11-16"><a id="__codelineno-11-16" name="__codelineno-11-16" href="#__codelineno-11-16"></a><span class="n">feature_extractor</span> <span class="o">=</span> <span class="n">AutoFeatureExtractor</span><span class="o">.</span><span class="n">from_pretrained</span><span class="p">(</span><span class="n">encoder_id</span><span class="p">)</span>
</span><span id="__span-11-17"><a id="__codelineno-11-17" name="__codelineno-11-17" href="#__codelineno-11-17"></a><span class="n">tokenizer</span> <span class="o">=</span> <span class="n">AutoTokenizer</span><span class="o">.</span><span class="n">from_pretrained</span><span class="p">(</span><span class="n">decoder_id</span><span class="p">)</span>
</span><span id="__span-11-18"><a id="__codelineno-11-18" name="__codelineno-11-18" href="#__codelineno-11-18"></a><span class="n">processor</span> <span class="o">=</span> <span class="n">Wav2Vec2Processor</span><span class="p">(</span><span class="n">feature_extractor</span><span class="p">,</span> <span class="n">tokenizer</span><span class="p">)</span>
</span><span id="__span-11-19"><a id="__codelineno-11-19" name="__codelineno-11-19" href="#__codelineno-11-19"></a><span class="n">processor</span><span class="o">.</span><span class="n">save_pretrained</span><span class="p">(</span><span class="s2">&quot;./&quot;</span><span class="p">)</span>
</span></code></pre></div>
<p>Finally, we can upload all files:
<div class="language-bash highlight"><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a>git<span class="w"> </span>lfs<span class="w"> </span>install
</span><span id="__span-12-2"><a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a>git<span class="w"> </span>add<span class="w"> </span>.<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>git<span class="w"> </span>commit<span class="w"> </span>-m<span class="w"> </span><span class="s2">&quot;upload model files&quot;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>git<span class="w"> </span>push
</span></code></pre></div></p>
<p>and link the official <code>run_speech_recognition_seq2seq.py</code> script to the folder:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a>ln<span class="w"> </span>-s<span class="w"> </span><span class="k">$(</span>realpath<span class="w"> </span>&lt;path/to/transformers&gt;/examples/pytorch/speech-recognition/run_speech_recognition_seq2seq.py<span class="k">)</span><span class="w"> </span>./
</span></code></pre></div>
<p>Note that we have added a randomly initialized <em>adapter layer</em> to <code>wav2vec2-base</code> with the argument
<code>encoder_add_adapter=True</code>. This adapter sub-samples the output sequence of 
<code>wav2vec2-base</code> along the time dimension. By default, a single
output vector of <code>wav2vec2-base</code> has a receptive field of <em>ca.</em> 25ms (<em>cf.</em> 
Section <em>4.2</em> of the <a href="https://huggingface.co/papers/2006.11477">official Wav2Vec2 paper</a>), which represents a little less a single character. On the other hand, BART
makes use of a sentence-piece tokenizer as an input processor, so that a single 
hidden vector of <code>bart-base</code> represents <em>ca.</em> 4 characters. To better align the 
receptive field of the <em>Wav2Vec2</em> output vectors with <em>BART</em>'s hidden-states in the cross-attention 
mechanism, we further subsample <em>Wav2Vec2</em>'s output by a factor of 8 by 
adding a convolution-based adapter.</p>
<p>Having warm-started the speech-encoder-decoder model under <code>&lt;your-user-name&gt;/wav2vec2-2-bart</code>, we can now fine-tune it on the task of speech recognition.</p>
<p>In the script [<code>run_speech_recognition_seq2seq</code>], we load the warm-started model, 
feature extractor, and tokenizer, process a speech recognition dataset, 
and subsequently make use of the <a href="https://huggingface.co/docs/transformers/main/en/main_classes/trainer#transformers.Seq2SeqTrainer"><code>Seq2SeqTrainer</code></a> to train our system.
Note that it is important to align the target transcriptions with the decoder's vocabulary. For example, the <a href="https://huggingface.co/datasets/librispeech_asr"><code>Librispeech</code></a> dataset only contains capitalized letters in the transcriptions,
whereas BART was pretrained mostly on normalized text. Thus, it is recommended to add the argument 
<code>--do_lower_case</code> to the fine-tuning script when using a warm-started <code>SpeechEncoderDecoderModel</code>. 
The model is fine-tuned on the standard cross-entropy language modeling
loss for sequence-to-sequence (just like <em>T5</em> or <em>BART</em> in natural language processing).</p>
<hr />
<p><strong>NOTE</strong></p>
<p>If you encounter problems with data preprocessing by setting <code>--preprocessing_num_workers</code> &gt; 1, 
you might want to set the environment variable <code>OMP_NUM_THREADS</code> to 1 as follows:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a><span class="nv">OMP_NUM_THREADS</span><span class="o">=</span><span class="m">1</span><span class="w"> </span>python<span class="w"> </span>run_speech_recognition_ctc<span class="w"> </span>...
</span></code></pre></div>
<p>If the environment variable is not set, the training script might freeze, <em>i.e.</em> see: https://github.com/pytorch/audio/issues/1021#issuecomment-726915239.</p>
<hr />
<h4 id="single-gpu-seq2seq">Single GPU Seq2Seq</h4>
<p>The following command shows how to fine-tune <a href="https://huggingface.co/transformers/main/model_doc/xlsr_wav2vec2.html">XLSR-Wav2Vec2</a> on <a href="https://huggingface.co/datasets/common_voice">Common Voice</a> using a single GPU in half-precision.</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a>python<span class="w"> </span>run_speech_recognition_seq2seq.py<span class="w"> </span><span class="se">\</span>
</span><span id="__span-15-2"><a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a><span class="w">    </span>--dataset_name<span class="o">=</span><span class="s2">&quot;librispeech_asr&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-15-3"><a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a><span class="w">    </span>--model_name_or_path<span class="o">=</span><span class="s2">&quot;./&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-15-4"><a id="__codelineno-15-4" name="__codelineno-15-4" href="#__codelineno-15-4"></a><span class="w">    </span>--dataset_config_name<span class="o">=</span><span class="s2">&quot;clean&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-15-5"><a id="__codelineno-15-5" name="__codelineno-15-5" href="#__codelineno-15-5"></a><span class="w">    </span>--train_split_name<span class="o">=</span><span class="s2">&quot;train.100&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-15-6"><a id="__codelineno-15-6" name="__codelineno-15-6" href="#__codelineno-15-6"></a><span class="w">    </span>--eval_split_name<span class="o">=</span><span class="s2">&quot;validation&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-15-7"><a id="__codelineno-15-7" name="__codelineno-15-7" href="#__codelineno-15-7"></a><span class="w">    </span>--output_dir<span class="o">=</span><span class="s2">&quot;./&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-15-8"><a id="__codelineno-15-8" name="__codelineno-15-8" href="#__codelineno-15-8"></a><span class="w">    </span>--preprocessing_num_workers<span class="o">=</span><span class="s2">&quot;16&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-15-9"><a id="__codelineno-15-9" name="__codelineno-15-9" href="#__codelineno-15-9"></a><span class="w">    </span>--length_column_name<span class="o">=</span><span class="s2">&quot;input_length&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-15-10"><a id="__codelineno-15-10" name="__codelineno-15-10" href="#__codelineno-15-10"></a><span class="w">    </span>--num_train_epochs<span class="o">=</span><span class="s2">&quot;5&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-15-11"><a id="__codelineno-15-11" name="__codelineno-15-11" href="#__codelineno-15-11"></a><span class="w">    </span>--per_device_train_batch_size<span class="o">=</span><span class="s2">&quot;8&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-15-12"><a id="__codelineno-15-12" name="__codelineno-15-12" href="#__codelineno-15-12"></a><span class="w">    </span>--per_device_eval_batch_size<span class="o">=</span><span class="s2">&quot;8&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-15-13"><a id="__codelineno-15-13" name="__codelineno-15-13" href="#__codelineno-15-13"></a><span class="w">    </span>--gradient_accumulation_steps<span class="o">=</span><span class="s2">&quot;8&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-15-14"><a id="__codelineno-15-14" name="__codelineno-15-14" href="#__codelineno-15-14"></a><span class="w">    </span>--learning_rate<span class="o">=</span><span class="s2">&quot;3e-4&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-15-15"><a id="__codelineno-15-15" name="__codelineno-15-15" href="#__codelineno-15-15"></a><span class="w">    </span>--warmup_steps<span class="o">=</span><span class="s2">&quot;400&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-15-16"><a id="__codelineno-15-16" name="__codelineno-15-16" href="#__codelineno-15-16"></a><span class="w">    </span>--eval_strategy<span class="o">=</span><span class="s2">&quot;steps&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-15-17"><a id="__codelineno-15-17" name="__codelineno-15-17" href="#__codelineno-15-17"></a><span class="w">    </span>--text_column_name<span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-15-18"><a id="__codelineno-15-18" name="__codelineno-15-18" href="#__codelineno-15-18"></a><span class="w">    </span>--save_steps<span class="o">=</span><span class="s2">&quot;400&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-15-19"><a id="__codelineno-15-19" name="__codelineno-15-19" href="#__codelineno-15-19"></a><span class="w">    </span>--eval_steps<span class="o">=</span><span class="s2">&quot;400&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-15-20"><a id="__codelineno-15-20" name="__codelineno-15-20" href="#__codelineno-15-20"></a><span class="w">    </span>--logging_steps<span class="o">=</span><span class="s2">&quot;10&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-15-21"><a id="__codelineno-15-21" name="__codelineno-15-21" href="#__codelineno-15-21"></a><span class="w">    </span>--save_total_limit<span class="o">=</span><span class="s2">&quot;1&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-15-22"><a id="__codelineno-15-22" name="__codelineno-15-22" href="#__codelineno-15-22"></a><span class="w">    </span>--freeze_feature_encoder<span class="w"> </span><span class="se">\</span>
</span><span id="__span-15-23"><a id="__codelineno-15-23" name="__codelineno-15-23" href="#__codelineno-15-23"></a><span class="w">    </span>--gradient_checkpointing<span class="w"> </span><span class="se">\</span>
</span><span id="__span-15-24"><a id="__codelineno-15-24" name="__codelineno-15-24" href="#__codelineno-15-24"></a><span class="w">    </span>--fp16<span class="w"> </span><span class="se">\</span>
</span><span id="__span-15-25"><a id="__codelineno-15-25" name="__codelineno-15-25" href="#__codelineno-15-25"></a><span class="w">    </span>--group_by_length<span class="w"> </span><span class="se">\</span>
</span><span id="__span-15-26"><a id="__codelineno-15-26" name="__codelineno-15-26" href="#__codelineno-15-26"></a><span class="w">    </span>--predict_with_generate<span class="w"> </span><span class="se">\</span>
</span><span id="__span-15-27"><a id="__codelineno-15-27" name="__codelineno-15-27" href="#__codelineno-15-27"></a><span class="w">    </span>--generation_max_length<span class="o">=</span><span class="s2">&quot;40&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-15-28"><a id="__codelineno-15-28" name="__codelineno-15-28" href="#__codelineno-15-28"></a><span class="w">    </span>--generation_num_beams<span class="o">=</span><span class="s2">&quot;1&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-15-29"><a id="__codelineno-15-29" name="__codelineno-15-29" href="#__codelineno-15-29"></a><span class="w">    </span>--do_train<span class="w"> </span>--do_eval<span class="w"> </span><span class="se">\</span>
</span><span id="__span-15-30"><a id="__codelineno-15-30" name="__codelineno-15-30" href="#__codelineno-15-30"></a><span class="w">    </span>--do_lower_case
</span></code></pre></div>
<p>On a single V100 GPU, this script should run in <em>ca.</em> 5 hours and yield a 
cross-entropy loss of <strong>0.405</strong> and word error rate of <strong>0.0728</strong>.</p>
<h4 id="multi-gpu-seq2seq">Multi GPU Seq2Seq</h4>
<p>The following command shows how to fine-tune <a href="https://huggingface.co/transformers/main/model_doc/xlsr_wav2vec2.html">XLSR-Wav2Vec2</a> on <a href="https://huggingface.co/datasets/common_voice">Common Voice</a> using 8 GPUs in half-precision.</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-16-1"><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a>torchrun<span class="w"> </span><span class="se">\</span>
</span><span id="__span-16-2"><a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a><span class="w">    </span>--nproc_per_node<span class="w"> </span><span class="m">8</span><span class="w"> </span>run_speech_recognition_seq2seq.py<span class="w"> </span><span class="se">\</span>
</span><span id="__span-16-3"><a id="__codelineno-16-3" name="__codelineno-16-3" href="#__codelineno-16-3"></a><span class="w">    </span>--dataset_name<span class="o">=</span><span class="s2">&quot;librispeech_asr&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-16-4"><a id="__codelineno-16-4" name="__codelineno-16-4" href="#__codelineno-16-4"></a><span class="w">    </span>--model_name_or_path<span class="o">=</span><span class="s2">&quot;./&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-16-5"><a id="__codelineno-16-5" name="__codelineno-16-5" href="#__codelineno-16-5"></a><span class="w">    </span>--dataset_config_name<span class="o">=</span><span class="s2">&quot;clean&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-16-6"><a id="__codelineno-16-6" name="__codelineno-16-6" href="#__codelineno-16-6"></a><span class="w">    </span>--train_split_name<span class="o">=</span><span class="s2">&quot;train.100&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-16-7"><a id="__codelineno-16-7" name="__codelineno-16-7" href="#__codelineno-16-7"></a><span class="w">    </span>--eval_split_name<span class="o">=</span><span class="s2">&quot;validation&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-16-8"><a id="__codelineno-16-8" name="__codelineno-16-8" href="#__codelineno-16-8"></a><span class="w">    </span>--output_dir<span class="o">=</span><span class="s2">&quot;./&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-16-9"><a id="__codelineno-16-9" name="__codelineno-16-9" href="#__codelineno-16-9"></a><span class="w">    </span>--preprocessing_num_workers<span class="o">=</span><span class="s2">&quot;16&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-16-10"><a id="__codelineno-16-10" name="__codelineno-16-10" href="#__codelineno-16-10"></a><span class="w">    </span>--length_column_name<span class="o">=</span><span class="s2">&quot;input_length&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-16-11"><a id="__codelineno-16-11" name="__codelineno-16-11" href="#__codelineno-16-11"></a><span class="w">    </span>--num_train_epochs<span class="o">=</span><span class="s2">&quot;5&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-16-12"><a id="__codelineno-16-12" name="__codelineno-16-12" href="#__codelineno-16-12"></a><span class="w">    </span>--per_device_train_batch_size<span class="o">=</span><span class="s2">&quot;8&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-16-13"><a id="__codelineno-16-13" name="__codelineno-16-13" href="#__codelineno-16-13"></a><span class="w">    </span>--per_device_eval_batch_size<span class="o">=</span><span class="s2">&quot;8&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-16-14"><a id="__codelineno-16-14" name="__codelineno-16-14" href="#__codelineno-16-14"></a><span class="w">    </span>--gradient_accumulation_steps<span class="o">=</span><span class="s2">&quot;1&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-16-15"><a id="__codelineno-16-15" name="__codelineno-16-15" href="#__codelineno-16-15"></a><span class="w">    </span>--learning_rate<span class="o">=</span><span class="s2">&quot;3e-4&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-16-16"><a id="__codelineno-16-16" name="__codelineno-16-16" href="#__codelineno-16-16"></a><span class="w">    </span>--warmup_steps<span class="o">=</span><span class="s2">&quot;400&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-16-17"><a id="__codelineno-16-17" name="__codelineno-16-17" href="#__codelineno-16-17"></a><span class="w">    </span>--eval_strategy<span class="o">=</span><span class="s2">&quot;steps&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-16-18"><a id="__codelineno-16-18" name="__codelineno-16-18" href="#__codelineno-16-18"></a><span class="w">    </span>--text_column_name<span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-16-19"><a id="__codelineno-16-19" name="__codelineno-16-19" href="#__codelineno-16-19"></a><span class="w">    </span>--save_steps<span class="o">=</span><span class="s2">&quot;400&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-16-20"><a id="__codelineno-16-20" name="__codelineno-16-20" href="#__codelineno-16-20"></a><span class="w">    </span>--eval_steps<span class="o">=</span><span class="s2">&quot;400&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-16-21"><a id="__codelineno-16-21" name="__codelineno-16-21" href="#__codelineno-16-21"></a><span class="w">    </span>--logging_steps<span class="o">=</span><span class="s2">&quot;10&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-16-22"><a id="__codelineno-16-22" name="__codelineno-16-22" href="#__codelineno-16-22"></a><span class="w">    </span>--save_total_limit<span class="o">=</span><span class="s2">&quot;1&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-16-23"><a id="__codelineno-16-23" name="__codelineno-16-23" href="#__codelineno-16-23"></a><span class="w">    </span>--freeze_feature_encoder<span class="w"> </span><span class="se">\</span>
</span><span id="__span-16-24"><a id="__codelineno-16-24" name="__codelineno-16-24" href="#__codelineno-16-24"></a><span class="w">    </span>--gradient_checkpointing<span class="w"> </span><span class="se">\</span>
</span><span id="__span-16-25"><a id="__codelineno-16-25" name="__codelineno-16-25" href="#__codelineno-16-25"></a><span class="w">    </span>--fp16<span class="w"> </span><span class="se">\</span>
</span><span id="__span-16-26"><a id="__codelineno-16-26" name="__codelineno-16-26" href="#__codelineno-16-26"></a><span class="w">    </span>--group_by_length<span class="w"> </span><span class="se">\</span>
</span><span id="__span-16-27"><a id="__codelineno-16-27" name="__codelineno-16-27" href="#__codelineno-16-27"></a><span class="w">    </span>--predict_with_generate<span class="w"> </span><span class="se">\</span>
</span><span id="__span-16-28"><a id="__codelineno-16-28" name="__codelineno-16-28" href="#__codelineno-16-28"></a><span class="w">    </span>--do_train<span class="w"> </span>--do_eval<span class="w"> </span><span class="se">\</span>
</span><span id="__span-16-29"><a id="__codelineno-16-29" name="__codelineno-16-29" href="#__codelineno-16-29"></a><span class="w">    </span>--do_lower_case
</span></code></pre></div>
<p>On 8 V100 GPUs, this script should run in <em>ca.</em> 45 minutes and yield a cross-entropy loss of <strong>0.405</strong> and word error rate of <strong>0.0728</strong></p>
<h3 id="examples-seq2seq">Examples Seq2Seq</h3>
<h4 id="librispeech-seq2seq">Librispeech Seq2Seq</h4>
<ul>
<li><a href="https://huggingface.co/datasets/librispeech_asr">Librispeech</a></li>
</ul>
<table>
<thead>
<tr>
<th>Dataset</th>
<th>Dataset Config</th>
<th>Pretrained Model</th>
<th>Word error rate on eval</th>
<th>Phoneme error rate on eval</th>
<th>GPU setup</th>
<th>Training time</th>
<th>Fine-tuned Model &amp; Logs</th>
<th>Command to reproduce</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="https://huggingface.co/datasets/librispeech_asr">Librispeech</a></td>
<td><code>"clean"</code> - <code>"train.100"</code></td>
<td><a href="https://huggingface.co/facebook/wav2vec2-base">facebook/wav2vec2-base</a> and <a href="https://huggingface.co/facebook/bart-base">facebook/bart-base</a></td>
<td>0.0728</td>
<td>-</td>
<td>8 GPU V100</td>
<td>45min</td>
<td><a href="https://huggingface.co/patrickvonplaten/wav2vec2-2-bart-base">here</a></td>
<td><a href="https://huggingface.co/patrickvonplaten/wav2vec2-2-bart-base/blob/main/create_model.py">create_model.py</a> &amp; <a href="https://huggingface.co/patrickvonplaten/wav2vec2-2-bart-base/blob/main/run_librispeech.sh">run.sh</a></td>
</tr>
<tr>
<td><a href="https://huggingface.co/datasets/librispeech_asr">Librispeech</a></td>
<td><code>"clean"</code> - <code>"train.100"</code></td>
<td><a href="https://huggingface.co/facebook/wav2vec2-large-lv60">facebook/wav2vec2-large-lv60</a> and <a href="https://huggingface.co/facebook/bart-large">facebook/bart-large</a></td>
<td>0.0486</td>
<td>-</td>
<td>8 GPU V100</td>
<td>1h20min</td>
<td><a href="https://huggingface.co/patrickvonplaten/wav2vec2-2-bart-large">here</a></td>
<td><a href="https://huggingface.co/patrickvonplaten/wav2vec2-2-bart-large/blob/main/create_model.py">create_model.py</a> &amp; <a href="https://huggingface.co/patrickvonplaten/wav2vec2-2-bart-large/blob/main/run_librispeech.sh">run.sh</a></td>
</tr>
</tbody>
</table>












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../../../../..", "features": ["navigation.tabs", "navigation.indexes", "navigation.instant", "navigation.sections", "navigation.top", "navigation.tracking", "search.highlight", "search.share", "search.suggest", "toc.follow", "content.tabs.link", "content.code.copy"], "search": "../../../../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../../../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
    
  </body>
</html>