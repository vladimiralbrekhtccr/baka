
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      
      
      <link rel="icon" href="../../../../../../assets/favicon.ico">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.22">
    
    
      
        <title>Custom models - Ohayou</title>
      
    
    
      <link rel="stylesheet" href="../../../../../../assets/stylesheets/main.84d31ad4.min.css">
      
        
        <link rel="stylesheet" href="../../../../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../../../../assets/extra.css">
    
    <script>__md_scope=new URL("../../../../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#sharing-custom-models" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../../../.." title="Ohayou" class="md-header__button md-logo" aria-label="Ohayou" data-md-component="logo">
      
  <img src="../../../../../../assets/logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Ohayou
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Custom models
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../../../ohayou/" class="md-tabs__link">
        
  
  
    
  
  Ohayou

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../../../vllm/open_ai_vllm_example_a_v_t/" class="md-tabs__link">
          
  
  
    
  
  vLLM

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../../../llm/speculative_decoding/" class="md-tabs__link">
          
  
  
    
  
  LLM

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../../../vlm/qwen3_vl_4B_object_detection/" class="md-tabs__link">
          
  
  
    
  
  VLM

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../../../md_format_helpers/" class="md-tabs__link">
        
  
  
    
  
  MD format helpers

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../../../docker/" class="md-tabs__link">
        
  
  
    
  
  Docker

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../../../linux/" class="md-tabs__link">
        
  
  
    
  
  Linux

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../../../moe/" class="md-tabs__link">
        
  
  
    
  
  Mixture of Experts

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../../../slurm/" class="md-tabs__link">
        
  
  
    
  
  Slurm

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../../../japanese-phrases/" class="md-tabs__link">
          
  
  
    
  
  Japanese Phrases

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../../../hackathon/index.md" class="md-tabs__link">
        
  
  
    
  
  Hack

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../../../.." title="Ohayou" class="md-nav__button md-logo" aria-label="Ohayou" data-md-component="logo">
      
  <img src="../../../../../../assets/logo.png" alt="logo">

    </a>
    Ohayou
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../ohayou/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Ohayou
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    vLLM
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            vLLM
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../vllm/open_ai_vllm_example_a_v_t/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Single Request
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../vllm/bash_vllm_serve/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Bash online serve
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../vllm/benchmarks/performance_eval/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Benchmarks
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    LLM
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            LLM
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../llm/speculative_decoding/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Speculative Decoding
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    VLM
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            VLM
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../vlm/qwen3_vl_4B_object_detection/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Qwen3VL
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../md_format_helpers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    MD format helpers
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../docker/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Docker
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../linux/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Linux
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../moe/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Mixture of Experts
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../slurm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Slurm
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../../../japanese-phrases/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Japanese Phrases
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_11" id="__nav_11_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_11">
            <span class="md-nav__icon md-icon"></span>
            Japanese Phrases
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11_2" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../../../japanese-phrases/daily-life/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Daily Life
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_11_2" id="__nav_11_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_11_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_11_2">
            <span class="md-nav__icon md-icon"></span>
            Daily Life
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../japanese-phrases/daily-life/shopping/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Shopping
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11_3" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../../../japanese-phrases/greetings/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Greetings
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_11_3" id="__nav_11_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_11_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_11_3">
            <span class="md-nav__icon md-icon"></span>
            Greetings
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../japanese-phrases/greetings/casual/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Casual
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../japanese-phrases/emotions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Emotions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../japanese-phrases/anime-manga/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Anime/Manga
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../hackathon/index.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Hack
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#writing-a-custom-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      Writing a custom configuration
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#writing-a-custom-model" class="md-nav__link">
    <span class="md-ellipsis">
      Writing a custom model
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sending-the-code-to-the-hub" class="md-nav__link">
    <span class="md-ellipsis">
      Sending the code to the Hub
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#using-a-model-with-custom-code" class="md-nav__link">
    <span class="md-ellipsis">
      Using a model with custom code
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#registering-a-model-with-custom-code-to-the-auto-classes" class="md-nav__link">
    <span class="md-ellipsis">
      Registering a model with custom code to the auto classes
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<!--Copyright 2023 The HuggingFace Team. All rights reserved.

Licensed under the Apache License, Version 2.0 (the "License"); you may not use this file except in compliance with
the License. You may obtain a copy of the License at

http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on
an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the
specific language governing permissions and limitations under the License.

âš ï¸ Note that this file is in Markdown but contain specific syntax for our doc-builder (similar to MDX) that may not be
rendered properly in your Markdown viewer.

-->

<h1 id="sharing-custom-models">Sharing custom models</h1>
<p>ğŸ¤— Transformersãƒ©ã‚¤ãƒ–ãƒ©ãƒªã¯ã€ç°¡å˜ã«æ‹¡å¼µã§ãã‚‹ã‚ˆã†ã«è¨­è¨ˆã•ã‚Œã¦ã„ã¾ã™ã€‚ã™ã¹ã¦ã®ãƒ¢ãƒ‡ãƒ«ã¯ãƒªãƒã‚¸ãƒˆãƒªã®ç‰¹å®šã®ã‚µãƒ–ãƒ•ã‚©ãƒ«ãƒ€ã«å®Œå…¨ã«ã‚³ãƒ¼ãƒ‰åŒ–ã•ã‚Œã¦ãŠã‚Šã€æŠ½è±¡åŒ–ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚ã—ãŸãŒã£ã¦ã€ãƒ¢ãƒ‡ãƒªãƒ³ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚³ãƒ”ãƒ¼ã—ã¦èª¿æ•´ã™ã‚‹ã“ã¨ãŒç°¡å˜ã§ã™ã€‚</p>
<p>æ–°ã—ã„ãƒ¢ãƒ‡ãƒ«ã‚’æ›¸ã„ã¦ã„ã‚‹å ´åˆã€ã‚¼ãƒ­ã‹ã‚‰å§‹ã‚ã‚‹æ–¹ãŒç°¡å˜ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚ã“ã®ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«ã§ã¯ã€ã‚«ã‚¹ã‚¿ãƒ ãƒ¢ãƒ‡ãƒ«ã¨ãã®è¨­å®šã‚’ã©ã®ã‚ˆã†ã«æ›¸ãã€Transformerså†…ã§ä½¿ç”¨ã§ãã‚‹ã‚ˆã†ã«ã—ã€ã‚³ãƒ¼ãƒ‰ã«ä¾å­˜ã™ã‚‹å…±åŒä½“ã¨å…±æœ‰ã™ã‚‹æ–¹æ³•ã‚’èª¬æ˜ã—ã¾ã™ã€‚ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã«å­˜åœ¨ã—ãªã„å ´åˆã§ã‚‚ã€èª°ã§ã‚‚ä½¿ç”¨ã§ãã‚‹ã‚ˆã†ã«ã—ã¾ã™ã€‚</p>
<p>ã“ã‚Œã‚’å®Ÿè¨¼ã™ã‚‹ãŸã‚ã«ã€<a href="https://github.com/rwightman/pytorch-image-models">timmãƒ©ã‚¤ãƒ–ãƒ©ãƒª</a>ã®ResNetã‚¯ãƒ©ã‚¹ã‚’[<code>PreTrainedModel</code>]ã«ãƒ©ãƒƒãƒ—ã™ã‚‹ã“ã¨ã«ã‚ˆã£ã¦ã€ResNetãƒ¢ãƒ‡ãƒ«ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚</p>
<h2 id="writing-a-custom-configuration">Writing a custom configuration</h2>
<p>ãƒ¢ãƒ‡ãƒ«ã«å–ã‚Šçµ„ã‚€å‰ã«ã€ã¾ãšãã®è¨­å®šã‚’æ›¸ãã¾ã—ã‚‡ã†ã€‚ãƒ¢ãƒ‡ãƒ«ã®è¨­å®šã¯ã€ãƒ¢ãƒ‡ãƒ«ã‚’æ§‹ç¯‰ã™ã‚‹ãŸã‚ã«å¿…è¦ãªã™ã¹ã¦ã®æƒ…å ±ã‚’å«ã‚€ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã§ã™ã€‚æ¬¡ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã§è¦‹ã‚‹ã‚ˆã†ã«ã€ãƒ¢ãƒ‡ãƒ«ã¯åˆæœŸåŒ–ã™ã‚‹ãŸã‚ã«<code>config</code>ã—ã‹å—ã‘å–ã‚‹ã“ã¨ãŒã§ããªã„ãŸã‚ã€ãã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãŒã§ãã‚‹ã ã‘å®Œå…¨ã§ã‚ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚</p>
<p>ã“ã®ä¾‹ã§ã¯ã€ResNetã‚¯ãƒ©ã‚¹ã®ã„ãã¤ã‹ã®å¼•æ•°ã‚’å–å¾—ã—ã€èª¿æ•´ã—ãŸã„ã‹ã‚‚ã—ã‚Œãªã„ã¨ã—ã¾ã™ã€‚ç•°ãªã‚‹è¨­å®šã¯ã€ç•°ãªã‚‹ã‚¿ã‚¤ãƒ—ã®ResNetã‚’æä¾›ã—ã¾ã™ã€‚ãã®å¾Œã€ã“ã‚Œã‚‰ã®å¼•æ•°ã‚’ç¢ºèªã—ãŸå¾Œã€ãã‚Œã‚‰ã®å¼•æ•°ã‚’å˜ã«æ ¼ç´ã—ã¾ã™ã€‚</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">transformers</span><span class="w"> </span><span class="kn">import</span> <span class="n">PreTrainedConfig</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">List</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="k">class</span><span class="w"> </span><span class="nc">ResnetConfig</span><span class="p">(</span><span class="n">PreTrainedConfig</span><span class="p">):</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>    <span class="n">model_type</span> <span class="o">=</span> <span class="s2">&quot;resnet&quot;</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>        <span class="n">block_type</span><span class="o">=</span><span class="s2">&quot;bottleneck&quot;</span><span class="p">,</span>
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a>        <span class="n">layers</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
</span><span id="__span-0-12"><a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>        <span class="n">num_classes</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">,</span>
</span><span id="__span-0-13"><a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a>        <span class="n">input_channels</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
</span><span id="__span-0-14"><a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a>        <span class="n">cardinality</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
</span><span id="__span-0-15"><a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a>        <span class="n">base_width</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">64</span><span class="p">,</span>
</span><span id="__span-0-16"><a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a>        <span class="n">stem_width</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">64</span><span class="p">,</span>
</span><span id="__span-0-17"><a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a>        <span class="n">stem_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="__span-0-18"><a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a>        <span class="n">avg_down</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="__span-0-19"><a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a>        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="__span-0-20"><a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a>    <span class="p">):</span>
</span><span id="__span-0-21"><a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a>        <span class="k">if</span> <span class="n">block_type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;basic&quot;</span><span class="p">,</span> <span class="s2">&quot;bottleneck&quot;</span><span class="p">]:</span>
</span><span id="__span-0-22"><a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;`block_type` must be &#39;basic&#39; or bottleneck&#39;, got </span><span class="si">{</span><span class="n">block_type</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
</span><span id="__span-0-23"><a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a>        <span class="k">if</span> <span class="n">stem_type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;deep&quot;</span><span class="p">,</span> <span class="s2">&quot;deep-tiered&quot;</span><span class="p">]:</span>
</span><span id="__span-0-24"><a id="__codelineno-0-24" name="__codelineno-0-24" href="#__codelineno-0-24"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;`stem_type` must be &#39;&#39;, &#39;deep&#39; or &#39;deep-tiered&#39;, got </span><span class="si">{</span><span class="n">stem_type</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
</span><span id="__span-0-25"><a id="__codelineno-0-25" name="__codelineno-0-25" href="#__codelineno-0-25"></a>
</span><span id="__span-0-26"><a id="__codelineno-0-26" name="__codelineno-0-26" href="#__codelineno-0-26"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">block_type</span> <span class="o">=</span> <span class="n">block_type</span>
</span><span id="__span-0-27"><a id="__codelineno-0-27" name="__codelineno-0-27" href="#__codelineno-0-27"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">layers</span> <span class="o">=</span> <span class="n">layers</span>
</span><span id="__span-0-28"><a id="__codelineno-0-28" name="__codelineno-0-28" href="#__codelineno-0-28"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">num_classes</span> <span class="o">=</span> <span class="n">num_classes</span>
</span><span id="__span-0-29"><a id="__codelineno-0-29" name="__codelineno-0-29" href="#__codelineno-0-29"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">input_channels</span> <span class="o">=</span> <span class="n">input_channels</span>
</span><span id="__span-0-30"><a id="__codelineno-0-30" name="__codelineno-0-30" href="#__codelineno-0-30"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">cardinality</span> <span class="o">=</span> <span class="n">cardinality</span>
</span><span id="__span-0-31"><a id="__codelineno-0-31" name="__codelineno-0-31" href="#__codelineno-0-31"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">base_width</span> <span class="o">=</span> <span class="n">base_width</span>
</span><span id="__span-0-32"><a id="__codelineno-0-32" name="__codelineno-0-32" href="#__codelineno-0-32"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stem_width</span> <span class="o">=</span> <span class="n">stem_width</span>
</span><span id="__span-0-33"><a id="__codelineno-0-33" name="__codelineno-0-33" href="#__codelineno-0-33"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stem_type</span> <span class="o">=</span> <span class="n">stem_type</span>
</span><span id="__span-0-34"><a id="__codelineno-0-34" name="__codelineno-0-34" href="#__codelineno-0-34"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">avg_down</span> <span class="o">=</span> <span class="n">avg_down</span>
</span><span id="__span-0-35"><a id="__codelineno-0-35" name="__codelineno-0-35" href="#__codelineno-0-35"></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span></code></pre></div>
<p>é‡è¦ãªã“ã¨ã‚’3ã¤è¦šãˆã¦ãŠãã¹ããƒã‚¤ãƒ³ãƒˆã¯æ¬¡ã®ã¨ãŠã‚Šã§ã™ï¼š
- <code>PreTrainedConfig</code> ã‚’ç¶™æ‰¿ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚
- ã‚ãªãŸã® <code>PreTrainedConfig</code> ã® <code>__init__</code> ã¯ä»»æ„ã® kwargs ã‚’å—ã‘å…¥ã‚Œã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚
- ã“ã‚Œã‚‰ã® <code>kwargs</code> ã¯è¦ªã‚¯ãƒ©ã‚¹ã® <code>__init__</code> ã«æ¸¡ã™å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚</p>
<p>ç¶™æ‰¿ã¯ã€ğŸ¤— Transformers ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®ã™ã¹ã¦ã®æ©Ÿèƒ½ã‚’å–å¾—ã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹ãŸã‚ã§ã™ã€‚ä»–ã®2ã¤ã®åˆ¶ç´„ã¯ã€
<code>PreTrainedConfig</code> ãŒè¨­å®šã—ã¦ã„ã‚‹ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ä»¥å¤–ã«ã‚‚å¤šãã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’æŒã£ã¦ã„ã‚‹ã“ã¨ã‹ã‚‰æ¥ã¦ã„ã¾ã™ã€‚
<code>from_pretrained</code> ãƒ¡ã‚½ãƒƒãƒ‰ã§è¨­å®šã‚’å†ãƒ­ãƒ¼ãƒ‰ã™ã‚‹å ´åˆã€ã“ã‚Œã‚‰ã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã¯ã‚ãªãŸã®è¨­å®šã«å—ã‘å…¥ã‚Œã‚‰ã‚Œã€
ãã®å¾Œã€è¦ªã‚¯ãƒ©ã‚¹ã«é€ä¿¡ã•ã‚Œã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚</p>
<p>è¨­å®šã® <code>model_type</code> ã‚’å®šç¾©ã™ã‚‹ã“ã¨ï¼ˆã“ã“ã§ã¯ <code>model_type="resnet"</code>ï¼‰ã¯ã€
è‡ªå‹•ã‚¯ãƒ©ã‚¹ã«ãƒ¢ãƒ‡ãƒ«ã‚’ç™»éŒ²ã—ãŸã„å ´åˆã‚’é™¤ã„ã¦ã¯å¿…é ˆã§ã¯ã‚ã‚Šã¾ã›ã‚“ï¼ˆæœ€å¾Œã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚’å‚ç…§ï¼‰ã€‚</p>
<p>ã“ã‚Œã§ã€ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®ä»–ã®ãƒ¢ãƒ‡ãƒ«è¨­å®šã¨åŒæ§˜ã«ã€è¨­å®šã‚’ç°¡å˜ã«ä½œæˆã—ã¦ä¿å­˜ã§ãã¾ã™ã€‚
ä»¥ä¸‹ã¯ã€resnet50d è¨­å®šã‚’ä½œæˆã—ã¦ä¿å­˜ã™ã‚‹æ–¹æ³•ã®ä¾‹ã§ã™ï¼š</p>
<div class="language-py highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="n">resnet50d_config</span> <span class="o">=</span> <span class="n">ResnetConfig</span><span class="p">(</span><span class="n">block_type</span><span class="o">=</span><span class="s2">&quot;bottleneck&quot;</span><span class="p">,</span> <span class="n">stem_width</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span> <span class="n">stem_type</span><span class="o">=</span><span class="s2">&quot;deep&quot;</span><span class="p">,</span> <span class="n">avg_down</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="n">resnet50d_config</span><span class="o">.</span><span class="n">save_pretrained</span><span class="p">(</span><span class="s2">&quot;custom-resnet&quot;</span><span class="p">)</span>
</span></code></pre></div>
<p>ã“ã‚Œã«ã‚ˆã‚Šã€<code>custom-resnet</code> ãƒ•ã‚©ãƒ«ãƒ€å†…ã« <code>config.json</code> ã¨ã„ã†åå‰ã®ãƒ•ã‚¡ã‚¤ãƒ«ãŒä¿å­˜ã•ã‚Œã¾ã™ã€‚ãã®å¾Œã€<code>from_pretrained</code> ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ä½¿ç”¨ã—ã¦æ§‹æˆã‚’å†ãƒ­ãƒ¼ãƒ‰ã§ãã¾ã™ã€‚</p>
<div class="language-py highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="n">resnet50d_config</span> <span class="o">=</span> <span class="n">ResnetConfig</span><span class="o">.</span><span class="n">from_pretrained</span><span class="p">(</span><span class="s2">&quot;custom-resnet&quot;</span><span class="p">)</span>
</span></code></pre></div>
<p>ã¾ãŸã€[<code>PreTrainedConfig</code>] ã‚¯ãƒ©ã‚¹ã®ä»–ã®ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ã€‚ãŸã¨ãˆã°ã€[<code>~PreTrainedConfig.push_to_hub</code>] ã‚’ä½¿ç”¨ã—ã¦ã€è¨­å®šã‚’ç›´æ¥ Hub ã«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã§ãã¾ã™ã€‚</p>
<h2 id="writing-a-custom-model">Writing a custom model</h2>
<p>ResNet ã®è¨­å®šãŒã§ããŸã®ã§ã€ãƒ¢ãƒ‡ãƒ«ã‚’æ›¸ãå§‹ã‚ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚å®Ÿéš›ã«ã¯2ã¤ã®ãƒ¢ãƒ‡ãƒ«ã‚’æ›¸ãã¾ã™ã€‚1ã¤ã¯ãƒãƒƒãƒã®ç”»åƒã‹ã‚‰éš ã‚ŒãŸç‰¹å¾´ã‚’æŠ½å‡ºã™ã‚‹ãƒ¢ãƒ‡ãƒ«ï¼ˆ[<code>BertModel</code>] ã®ã‚ˆã†ãªã‚‚ã®ï¼‰ã§ã€ã‚‚ã†1ã¤ã¯ç”»åƒåˆ†é¡ã«é©ã—ãŸãƒ¢ãƒ‡ãƒ«ï¼ˆ[<code>BertForSequenceClassification</code>] ã®ã‚ˆã†ãªã‚‚ã®ï¼‰ã§ã™ã€‚</p>
<p>å‰è¿°ã—ãŸã‚ˆã†ã«ã€ã“ã®ä¾‹ã‚’ã‚·ãƒ³ãƒ—ãƒ«ã«ä¿ã¤ãŸã‚ã«ã€ãƒ¢ãƒ‡ãƒ«ã®ç·©ã„ãƒ©ãƒƒãƒ‘ãƒ¼ã®ã¿ã‚’æ›¸ãã¾ã™ã€‚ã“ã®ã‚¯ãƒ©ã‚¹ã‚’æ›¸ãå‰ã«è¡Œã†å¿…è¦ãŒã‚ã‚‹å”¯ä¸€ã®ã“ã¨ã¯ã€ãƒ–ãƒ­ãƒƒã‚¯ã‚¿ã‚¤ãƒ—ã¨å®Ÿéš›ã®ãƒ–ãƒ­ãƒƒã‚¯ã‚¯ãƒ©ã‚¹ã®é–“ã®ãƒãƒƒãƒ—ã§ã™ã€‚ãã®å¾Œã€ã™ã¹ã¦ã‚’ <code>ResNet</code> ã‚¯ãƒ©ã‚¹ã«æ¸¡ã—ã¦è¨­å®šã‹ã‚‰ãƒ¢ãƒ‡ãƒ«ã‚’å®šç¾©ã—ã¾ã™ï¼š</p>
<div class="language-py highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">transformers</span><span class="w"> </span><span class="kn">import</span> <span class="n">PreTrainedModel</span>
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">timm.models.resnet</span><span class="w"> </span><span class="kn">import</span> <span class="n">BasicBlock</span><span class="p">,</span> <span class="n">Bottleneck</span><span class="p">,</span> <span class="n">ResNet</span>
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a><span class="kn">from</span><span class="w"> </span><span class="nn">.configuration_resnet</span><span class="w"> </span><span class="kn">import</span> <span class="n">ResnetConfig</span>
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a>
</span><span id="__span-3-5"><a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a>
</span><span id="__span-3-6"><a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a><span class="n">BLOCK_MAPPING</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;basic&quot;</span><span class="p">:</span> <span class="n">BasicBlock</span><span class="p">,</span> <span class="s2">&quot;bottleneck&quot;</span><span class="p">:</span> <span class="n">Bottleneck</span><span class="p">}</span>
</span><span id="__span-3-7"><a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a>
</span><span id="__span-3-8"><a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a>
</span><span id="__span-3-9"><a id="__codelineno-3-9" name="__codelineno-3-9" href="#__codelineno-3-9"></a><span class="k">class</span><span class="w"> </span><span class="nc">ResnetModel</span><span class="p">(</span><span class="n">PreTrainedModel</span><span class="p">):</span>
</span><span id="__span-3-10"><a id="__codelineno-3-10" name="__codelineno-3-10" href="#__codelineno-3-10"></a>    <span class="n">config_class</span> <span class="o">=</span> <span class="n">ResnetConfig</span>
</span><span id="__span-3-11"><a id="__codelineno-3-11" name="__codelineno-3-11" href="#__codelineno-3-11"></a>
</span><span id="__span-3-12"><a id="__codelineno-3-12" name="__codelineno-3-12" href="#__codelineno-3-12"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config</span><span class="p">):</span>
</span><span id="__span-3-13"><a id="__codelineno-3-13" name="__codelineno-3-13" href="#__codelineno-3-13"></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
</span><span id="__span-3-14"><a id="__codelineno-3-14" name="__codelineno-3-14" href="#__codelineno-3-14"></a>        <span class="n">block_layer</span> <span class="o">=</span> <span class="n">BLOCK_MAPPING</span><span class="p">[</span><span class="n">config</span><span class="o">.</span><span class="n">block_type</span><span class="p">]</span>
</span><span id="__span-3-15"><a id="__codelineno-3-15" name="__codelineno-3-15" href="#__codelineno-3-15"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">ResNet</span><span class="p">(</span>
</span><span id="__span-3-16"><a id="__codelineno-3-16" name="__codelineno-3-16" href="#__codelineno-3-16"></a>            <span class="n">block_layer</span><span class="p">,</span>
</span><span id="__span-3-17"><a id="__codelineno-3-17" name="__codelineno-3-17" href="#__codelineno-3-17"></a>            <span class="n">config</span><span class="o">.</span><span class="n">layers</span><span class="p">,</span>
</span><span id="__span-3-18"><a id="__codelineno-3-18" name="__codelineno-3-18" href="#__codelineno-3-18"></a>            <span class="n">num_classes</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">num_classes</span><span class="p">,</span>
</span><span id="__span-3-19"><a id="__codelineno-3-19" name="__codelineno-3-19" href="#__codelineno-3-19"></a>            <span class="n">in_chans</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">input_channels</span><span class="p">,</span>
</span><span id="__span-3-20"><a id="__codelineno-3-20" name="__codelineno-3-20" href="#__codelineno-3-20"></a>            <span class="n">cardinality</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">cardinality</span><span class="p">,</span>
</span><span id="__span-3-21"><a id="__codelineno-3-21" name="__codelineno-3-21" href="#__codelineno-3-21"></a>            <span class="n">base_width</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">base_width</span><span class="p">,</span>
</span><span id="__span-3-22"><a id="__codelineno-3-22" name="__codelineno-3-22" href="#__codelineno-3-22"></a>            <span class="n">stem_width</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">stem_width</span><span class="p">,</span>
</span><span id="__span-3-23"><a id="__codelineno-3-23" name="__codelineno-3-23" href="#__codelineno-3-23"></a>            <span class="n">stem_type</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">stem_type</span><span class="p">,</span>
</span><span id="__span-3-24"><a id="__codelineno-3-24" name="__codelineno-3-24" href="#__codelineno-3-24"></a>            <span class="n">avg_down</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">avg_down</span><span class="p">,</span>
</span><span id="__span-3-25"><a id="__codelineno-3-25" name="__codelineno-3-25" href="#__codelineno-3-25"></a>        <span class="p">)</span>
</span><span id="__span-3-26"><a id="__codelineno-3-26" name="__codelineno-3-26" href="#__codelineno-3-26"></a>
</span><span id="__span-3-27"><a id="__codelineno-3-27" name="__codelineno-3-27" href="#__codelineno-3-27"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tensor</span><span class="p">):</span>
</span><span id="__span-3-28"><a id="__codelineno-3-28" name="__codelineno-3-28" href="#__codelineno-3-28"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">forward_features</span><span class="p">(</span><span class="n">tensor</span><span class="p">)</span>
</span></code></pre></div>
<p>ç”»åƒã‚’åˆ†é¡ã™ã‚‹ãƒ¢ãƒ‡ãƒ«ã®å ´åˆã€forwardãƒ¡ã‚½ãƒƒãƒ‰ã‚’å¤‰æ›´ã™ã‚‹ã ã‘ã§ã™ï¼š</p>
<div class="language-py highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a>
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a>
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a><span class="k">class</span><span class="w"> </span><span class="nc">ResnetModelForImageClassification</span><span class="p">(</span><span class="n">PreTrainedModel</span><span class="p">):</span>
</span><span id="__span-4-5"><a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a>    <span class="n">config_class</span> <span class="o">=</span> <span class="n">ResnetConfig</span>
</span><span id="__span-4-6"><a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a>
</span><span id="__span-4-7"><a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config</span><span class="p">):</span>
</span><span id="__span-4-8"><a id="__codelineno-4-8" name="__codelineno-4-8" href="#__codelineno-4-8"></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
</span><span id="__span-4-9"><a id="__codelineno-4-9" name="__codelineno-4-9" href="#__codelineno-4-9"></a>        <span class="n">block_layer</span> <span class="o">=</span> <span class="n">BLOCK_MAPPING</span><span class="p">[</span><span class="n">config</span><span class="o">.</span><span class="n">block_type</span><span class="p">]</span>
</span><span id="__span-4-10"><a id="__codelineno-4-10" name="__codelineno-4-10" href="#__codelineno-4-10"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">ResNet</span><span class="p">(</span>
</span><span id="__span-4-11"><a id="__codelineno-4-11" name="__codelineno-4-11" href="#__codelineno-4-11"></a>            <span class="n">block_layer</span><span class="p">,</span>
</span><span id="__span-4-12"><a id="__codelineno-4-12" name="__codelineno-4-12" href="#__codelineno-4-12"></a>            <span class="n">config</span><span class="o">.</span><span class="n">layers</span><span class="p">,</span>
</span><span id="__span-4-13"><a id="__codelineno-4-13" name="__codelineno-4-13" href="#__codelineno-4-13"></a>            <span class="n">num_classes</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">num_classes</span><span class="p">,</span>
</span><span id="__span-4-14"><a id="__codelineno-4-14" name="__codelineno-4-14" href="#__codelineno-4-14"></a>            <span class="n">in_chans</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">input_channels</span><span class="p">,</span>
</span><span id="__span-4-15"><a id="__codelineno-4-15" name="__codelineno-4-15" href="#__codelineno-4-15"></a>            <span class="n">cardinality</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">cardinality</span><span class="p">,</span>
</span><span id="__span-4-16"><a id="__codelineno-4-16" name="__codelineno-4-16" href="#__codelineno-4-16"></a>            <span class="n">base_width</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">base_width</span><span class="p">,</span>
</span><span id="__span-4-17"><a id="__codelineno-4-17" name="__codelineno-4-17" href="#__codelineno-4-17"></a>            <span class="n">stem_width</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">stem_width</span><span class="p">,</span>
</span><span id="__span-4-18"><a id="__codelineno-4-18" name="__codelineno-4-18" href="#__codelineno-4-18"></a>            <span class="n">stem_type</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">stem_type</span><span class="p">,</span>
</span><span id="__span-4-19"><a id="__codelineno-4-19" name="__codelineno-4-19" href="#__codelineno-4-19"></a>            <span class="n">avg_down</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">avg_down</span><span class="p">,</span>
</span><span id="__span-4-20"><a id="__codelineno-4-20" name="__codelineno-4-20" href="#__codelineno-4-20"></a>        <span class="p">)</span>
</span><span id="__span-4-21"><a id="__codelineno-4-21" name="__codelineno-4-21" href="#__codelineno-4-21"></a>
</span><span id="__span-4-22"><a id="__codelineno-4-22" name="__codelineno-4-22" href="#__codelineno-4-22"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tensor</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="__span-4-23"><a id="__codelineno-4-23" name="__codelineno-4-23" href="#__codelineno-4-23"></a>        <span class="n">logits</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">(</span><span class="n">tensor</span><span class="p">)</span>
</span><span id="__span-4-24"><a id="__codelineno-4-24" name="__codelineno-4-24" href="#__codelineno-4-24"></a>        <span class="k">if</span> <span class="n">labels</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-4-25"><a id="__codelineno-4-25" name="__codelineno-4-25" href="#__codelineno-4-25"></a>            <span class="n">loss</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">functional</span><span class="o">.</span><span class="n">cross_entropy</span><span class="p">(</span><span class="n">logits</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span>
</span><span id="__span-4-26"><a id="__codelineno-4-26" name="__codelineno-4-26" href="#__codelineno-4-26"></a>            <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;loss&quot;</span><span class="p">:</span> <span class="n">loss</span><span class="p">,</span> <span class="s2">&quot;logits&quot;</span><span class="p">:</span> <span class="n">logits</span><span class="p">}</span>
</span><span id="__span-4-27"><a id="__codelineno-4-27" name="__codelineno-4-27" href="#__codelineno-4-27"></a>        <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;logits&quot;</span><span class="p">:</span> <span class="n">logits</span><span class="p">}</span>
</span></code></pre></div>
<p>ä¸¡æ–¹ã®å ´åˆã€<code>PreTrainedModel</code>ã‹ã‚‰ç¶™æ‰¿ã—ã€<code>config</code>ã‚’ä½¿ç”¨ã—ã¦ã‚¹ãƒ¼ãƒ‘ãƒ¼ã‚¯ãƒ©ã‚¹ã®åˆæœŸåŒ–ã‚’å‘¼ã³å‡ºã—ã¾ã™ï¼ˆé€šå¸¸ã®<code>torch.nn.Module</code>ã‚’æ›¸ãã¨ãã®ã‚ˆã†ãªæ„Ÿã˜ã§ã™ï¼‰ã€‚
<code>config_class</code>ã‚’è¨­å®šã™ã‚‹è¡Œã¯å¿…é ˆã§ã¯ã‚ã‚Šã¾ã›ã‚“ãŒã€ï¼ˆæœ€å¾Œã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚’å‚ç…§ï¼‰ã€ãƒ¢ãƒ‡ãƒ«ã‚’è‡ªå‹•ã‚¯ãƒ©ã‚¹ã«ç™»éŒ²ã—ãŸã„å ´åˆã«ä½¿ç”¨ã§ãã¾ã™ã€‚</p>
<p><Tip></p>
<p>ãƒ¢ãƒ‡ãƒ«ãŒãƒ©ã‚¤ãƒ–ãƒ©ãƒªå†…ã®ãƒ¢ãƒ‡ãƒ«ã¨éå¸¸ã«ä¼¼ã¦ã„ã‚‹å ´åˆã€ã“ã®ãƒ¢ãƒ‡ãƒ«ã¨åŒã˜æ§‹æˆã‚’å†åˆ©ç”¨ã§ãã¾ã™ã€‚</p>
<p></Tip></p>
<p>ãƒ¢ãƒ‡ãƒ«ãŒè¿”ã™å†…å®¹ã¯ä½•ã§ã‚‚æ§‹ã„ã¾ã›ã‚“ãŒã€ãƒ©ãƒ™ãƒ«ãŒæ¸¡ã•ã‚Œã‚‹ã¨ãã«æå¤±ã‚’å«ã‚€è¾æ›¸ã‚’è¿”ã™ï¼ˆ<code>ResnetModelForImageClassification</code>ã®ã‚ˆã†ã«è¡Œã£ãŸã‚‚ã®ï¼‰ã¨ã€
ãƒ¢ãƒ‡ãƒ«ã‚’[<code>Trainer</code>]ã‚¯ãƒ©ã‚¹å†…ã§ç›´æ¥ä½¿ç”¨ã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚ç‹¬è‡ªã®ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ãƒ«ãƒ¼ãƒ—ã¾ãŸã¯ä»–ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ç”¨ã™ã‚‹äºˆå®šã§ã‚ã‚‹é™ã‚Šã€
åˆ¥ã®å‡ºåŠ›å½¢å¼ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã‚‚å•é¡Œã‚ã‚Šã¾ã›ã‚“ã€‚</p>
<p>ã•ã¦ã€ãƒ¢ãƒ‡ãƒ«ã‚¯ãƒ©ã‚¹ãŒã§ããŸã®ã§ã€1ã¤ä½œæˆã—ã¾ã—ã‚‡ã†ï¼š</p>
<div class="language-py highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="n">resnet50d</span> <span class="o">=</span> <span class="n">ResnetModelForImageClassification</span><span class="p">(</span><span class="n">resnet50d_config</span><span class="p">)</span>
</span></code></pre></div>
<p>å†åº¦ã€[<code>PreTrainedModel</code>]ã®ã„ãšã‚Œã‹ã®ãƒ¡ã‚½ãƒƒãƒ‰ã€ä¾‹ãˆã°[<code>~PreTrainedModel.save_pretrained</code>]ã‚„
[<code>~PreTrainedModel.push_to_hub</code>]ãªã©ã‚’ä½¿ç”¨ã§ãã¾ã™ã€‚æ¬¡ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã§ã¯ã€ãƒ¢ãƒ‡ãƒ«ã®é‡ã¿ã‚’ã‚³ãƒ¼ãƒ‰ã¨ä¸€ç·’ã«
Hugging Face Hub ã«ãƒ—ãƒƒã‚·ãƒ¥ã™ã‚‹æ–¹æ³•ã‚’è¦‹ã¦ã¿ã¾ã™ã€‚
ã—ã‹ã—ã€ã¾ãšã¯ãƒ¢ãƒ‡ãƒ«å†…ã«äº‹å‰å­¦ç¿’æ¸ˆã¿ã®é‡ã¿ã‚’ãƒ­ãƒ¼ãƒ‰ã—ã¾ã—ã‚‡ã†ã€‚</p>
<p>ç‹¬è‡ªã®ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹ã§ã¯ã€ãŠãã‚‰ãç‹¬è‡ªã®ãƒ‡ãƒ¼ã‚¿ã§ã‚«ã‚¹ã‚¿ãƒ ãƒ¢ãƒ‡ãƒ«ã‚’ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ã™ã‚‹ã“ã¨ã«ãªã‚‹ã§ã—ã‚‡ã†ã€‚
ã“ã®ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«ã§ã¯ã‚¹ãƒ”ãƒ¼ãƒ‰ã‚¢ãƒƒãƒ—ã®ãŸã‚ã«ã€resnet50dã®äº‹å‰å­¦ç¿’æ¸ˆã¿ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚
ç§ãŸã¡ã®ãƒ¢ãƒ‡ãƒ«ã¯ãã‚Œã‚’ãƒ©ãƒƒãƒ—ã™ã‚‹ã ã‘ãªã®ã§ã€ã“ã‚Œã‚‰ã®é‡ã¿ã‚’è»¢é€ã™ã‚‹ã®ã¯ç°¡å˜ã§ã™ï¼š</p>
<div class="language-py highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">timm</span>
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a>
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a><span class="n">pretrained_model</span> <span class="o">=</span> <span class="n">timm</span><span class="o">.</span><span class="n">create_model</span><span class="p">(</span><span class="s2">&quot;resnet50d&quot;</span><span class="p">,</span> <span class="n">pretrained</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-6-4"><a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a><span class="n">resnet50d</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">load_state_dict</span><span class="p">(</span><span class="n">pretrained_model</span><span class="o">.</span><span class="n">state_dict</span><span class="p">())</span>
</span></code></pre></div>
<p>ã•ã¦ã€[<code>~PreTrainedModel.save_pretrained</code>]ã¾ãŸã¯[<code>~PreTrainedModel.push_to_hub</code>]ã‚’å®Ÿè¡Œã—ãŸã¨ãã«ã€
ãƒ¢ãƒ‡ãƒ«ã®ã‚³ãƒ¼ãƒ‰ãŒä¿å­˜ã•ã‚Œã‚‹ã‚ˆã†ã«ã™ã‚‹æ–¹æ³•ã‚’è¦‹ã¦ã¿ã¾ã—ã‚‡ã†ã€‚</p>
<h2 id="sending-the-code-to-the-hub">Sending the code to the Hub</h2>
<p><Tip warning={true}></p>
<p>ã“ã®APIã¯å®Ÿé¨“çš„ã§ã‚ã‚Šã€æ¬¡ã®ãƒªãƒªãƒ¼ã‚¹ã§ã‚ãšã‹ãªå¤‰æ›´ãŒã‚ã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚</p>
<p></Tip></p>
<p>ã¾ãšã€ãƒ¢ãƒ‡ãƒ«ãŒ<code>.py</code>ãƒ•ã‚¡ã‚¤ãƒ«ã«å®Œå…¨ã«å®šç¾©ã•ã‚Œã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚
ãƒ•ã‚¡ã‚¤ãƒ«ã¯ç›¸å¯¾ã‚¤ãƒ³ãƒãƒ¼ãƒˆã‚’ä»–ã®ãƒ•ã‚¡ã‚¤ãƒ«ã«ä¾å­˜ã§ãã¾ã™ãŒã€ã™ã¹ã¦ã®ãƒ•ã‚¡ã‚¤ãƒ«ãŒåŒã˜ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ã‚ã‚‹é™ã‚Šï¼ˆã¾ã ã“ã®æ©Ÿèƒ½ã§ã¯ã‚µãƒ–ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã¯ã‚µãƒãƒ¼ãƒˆã—ã¦ã„ã¾ã›ã‚“ï¼‰ã€å•é¡Œã‚ã‚Šã¾ã›ã‚“ã€‚
ã“ã®ä¾‹ã§ã¯ã€ç¾åœ¨ã®ä½œæ¥­ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªå†…ã«åå‰ãŒã€Œresnet_modelã€ã®ãƒ•ã‚©ãƒ«ãƒ€ã‚’ä½œæˆã—ã€ãã®ä¸­ã«<code>modeling_resnet.py</code>ãƒ•ã‚¡ã‚¤ãƒ«ã¨<code>configuration_resnet.py</code>ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å®šç¾©ã—ã¾ã™ã€‚
æ§‹æˆãƒ•ã‚¡ã‚¤ãƒ«ã«ã¯<code>ResnetConfig</code>ã®ã‚³ãƒ¼ãƒ‰ãŒå«ã¾ã‚Œã€ãƒ¢ãƒ‡ãƒªãƒ³ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ã«ã¯<code>ResnetModel</code>ã¨<code>ResnetModelForImageClassification</code>ã®ã‚³ãƒ¼ãƒ‰ãŒå«ã¾ã‚Œã¦ã„ã¾ã™ã€‚</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a>.
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a>â””â”€â”€<span class="w"> </span>resnet_model
</span><span id="__span-7-3"><a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a><span class="w">    </span>â”œâ”€â”€<span class="w"> </span>__init__.py
</span><span id="__span-7-4"><a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a><span class="w">    </span>â”œâ”€â”€<span class="w"> </span>configuration_resnet.py
</span><span id="__span-7-5"><a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a><span class="w">    </span>â””â”€â”€<span class="w"> </span>modeling_resnet.py
</span></code></pre></div>
<p><code>__init__.py</code>ã¯ç©ºã§ã‚ã£ã¦ã‚‚å•é¡Œã‚ã‚Šã¾ã›ã‚“ã€‚PythonãŒ<code>resnet_model</code>ã‚’ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã¨ã—ã¦æ¤œå‡ºã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹ãŸã‚ã«å­˜åœ¨ã—ã¾ã™ã€‚</p>
<p><Tip warning={true}></p>
<p>ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‹ã‚‰ãƒ¢ãƒ‡ãƒªãƒ³ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚³ãƒ”ãƒ¼ã™ã‚‹å ´åˆã€ãƒ•ã‚¡ã‚¤ãƒ«ã®å…ˆé ­ã«ã‚ã‚‹ã™ã¹ã¦ã®ç›¸å¯¾ã‚¤ãƒ³ãƒãƒ¼ãƒˆã‚’<code>transformers</code>ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‹ã‚‰ã‚¤ãƒ³ãƒãƒ¼ãƒˆã«ç½®ãæ›ãˆã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚</p>
<p></Tip></p>
<p>æ—¢å­˜ã®è¨­å®šã‚„ãƒ¢ãƒ‡ãƒ«ã‚’å†åˆ©ç”¨ï¼ˆã¾ãŸã¯ã‚µãƒ–ã‚¯ãƒ©ã‚¹åŒ–ï¼‰ã§ãã‚‹ã“ã¨ã«æ³¨æ„ã—ã¦ãã ã•ã„ã€‚</p>
<p>ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ã¨ãƒ¢ãƒ‡ãƒ«ã‚’å…±æœ‰ã™ã‚‹ãŸã‚ã«ã€æ¬¡ã®æ‰‹é †ã«å¾“ã£ã¦ãã ã•ã„ï¼šã¾ãšã€æ–°ã—ãä½œæˆã—ãŸãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰ResNetãƒ¢ãƒ‡ãƒ«ã¨è¨­å®šã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ã¾ã™ï¼š</p>
<div class="language-py highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">resnet_model.configuration_resnet</span><span class="w"> </span><span class="kn">import</span> <span class="n">ResnetConfig</span>
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">resnet_model.modeling_resnet</span><span class="w"> </span><span class="kn">import</span> <span class="n">ResnetModel</span><span class="p">,</span> <span class="n">ResnetModelForImageClassification</span>
</span></code></pre></div>
<p>æ¬¡ã«ã€<code>save_pretrained</code>ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ä½¿ç”¨ã—ã¦ã“ã‚Œã‚‰ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ã‚³ãƒ¼ãƒ‰ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚³ãƒ”ãƒ¼ã—ã€ç‰¹å®šã®Autoã‚¯ãƒ©ã‚¹ï¼ˆç‰¹ã«ãƒ¢ãƒ‡ãƒ«ã®å ´åˆï¼‰ã«æ­£ã—ãç™»éŒ²ã™ã‚‹ã‚ˆã†ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã«æŒ‡ç¤ºã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚æ¬¡ã®ã‚ˆã†ã«å®Ÿè¡Œã—ã¾ã™ï¼š</p>
<div class="language-py highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="n">ResnetConfig</span><span class="o">.</span><span class="n">register_for_auto_class</span><span class="p">()</span>
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a><span class="n">ResnetModel</span><span class="o">.</span><span class="n">register_for_auto_class</span><span class="p">(</span><span class="s2">&quot;AutoModel&quot;</span><span class="p">)</span>
</span><span id="__span-9-3"><a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a><span class="n">ResnetModelForImageClassification</span><span class="o">.</span><span class="n">register_for_auto_class</span><span class="p">(</span><span class="s2">&quot;AutoModelForImageClassification&quot;</span><span class="p">)</span>
</span></code></pre></div>
<p>æ³¨æ„: è¨­å®šã«ã¤ã„ã¦ã¯è‡ªå‹•ã‚¯ãƒ©ã‚¹ã‚’æŒ‡å®šã™ã‚‹å¿…è¦ã¯ã‚ã‚Šã¾ã›ã‚“ï¼ˆè¨­å®šç”¨ã®è‡ªå‹•ã‚¯ãƒ©ã‚¹ã¯1ã¤ã—ã‹ãªãã€[<code>AutoConfig</code>]ã§ã™ï¼‰ãŒã€
ãƒ¢ãƒ‡ãƒ«ã«ã¤ã„ã¦ã¯ç•°ãªã‚Šã¾ã™ã€‚ã‚«ã‚¹ã‚¿ãƒ ãƒ¢ãƒ‡ãƒ«ã¯å¤šãã®ç•°ãªã‚‹ã‚¿ã‚¹ã‚¯ã«é©ã—ã¦ã„ã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹ãŸã‚ã€
ãƒ¢ãƒ‡ãƒ«ãŒæ­£ç¢ºãªè‡ªå‹•ã‚¯ãƒ©ã‚¹ã®ã†ã¡ã©ã‚Œã«é©ã—ã¦ã„ã‚‹ã‹ã‚’æŒ‡å®šã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚</p>
<p>æ¬¡ã«ã€å‰è¿°ã®ã‚ˆã†ã«è¨­å®šã¨ãƒ¢ãƒ‡ãƒ«ã‚’ä½œæˆã—ã¾ã—ã‚‡ã†ï¼š</p>
<div class="language-py highlight"><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="n">resnet50d_config</span> <span class="o">=</span> <span class="n">ResnetConfig</span><span class="p">(</span><span class="n">block_type</span><span class="o">=</span><span class="s2">&quot;bottleneck&quot;</span><span class="p">,</span> <span class="n">stem_width</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span> <span class="n">stem_type</span><span class="o">=</span><span class="s2">&quot;deep&quot;</span><span class="p">,</span> <span class="n">avg_down</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-10-2"><a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a><span class="n">resnet50d</span> <span class="o">=</span> <span class="n">ResnetModelForImageClassification</span><span class="p">(</span><span class="n">resnet50d_config</span><span class="p">)</span>
</span><span id="__span-10-3"><a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a>
</span><span id="__span-10-4"><a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a><span class="n">pretrained_model</span> <span class="o">=</span> <span class="n">timm</span><span class="o">.</span><span class="n">create_model</span><span class="p">(</span><span class="s2">&quot;resnet50d&quot;</span><span class="p">,</span> <span class="n">pretrained</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-10-5"><a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a><span class="n">resnet50d</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">load_state_dict</span><span class="p">(</span><span class="n">pretrained_model</span><span class="o">.</span><span class="n">state_dict</span><span class="p">())</span>
</span></code></pre></div>
<p>ãƒ¢ãƒ‡ãƒ«ã‚’Hubã«é€ä¿¡ã™ã‚‹ã«ã¯ã€ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã§æ¬¡ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¾ã™ï¼š</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a>hf<span class="w"> </span>auth<span class="w"> </span>login
</span></code></pre></div>
<p>ã¾ãŸã¯ãƒãƒ¼ãƒˆãƒ–ãƒƒã‚¯ã‹ã‚‰ï¼š</p>
<div class="language-py highlight"><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">huggingface_hub</span><span class="w"> </span><span class="kn">import</span> <span class="n">notebook_login</span>
</span><span id="__span-12-2"><a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a>
</span><span id="__span-12-3"><a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a><span class="n">notebook_login</span><span class="p">()</span>
</span></code></pre></div>
<p>æ¬¡ã«ã€æ¬¡ã®ã‚ˆã†ã«ã—ã¦ã€ç‹¬è‡ªã®åå‰ç©ºé–“ã«ãƒ—ãƒƒã‚·ãƒ¥ã§ãã¾ã™ï¼ˆã¾ãŸã¯ã€ãƒ¡ãƒ³ãƒãƒ¼ã§ã‚ã‚‹çµ„ç¹”ã«ãƒ—ãƒƒã‚·ãƒ¥ã§ãã¾ã™ï¼‰ï¼š</p>
<div class="language-py highlight"><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="n">resnet50d</span><span class="o">.</span><span class="n">push_to_hub</span><span class="p">(</span><span class="s2">&quot;custom-resnet50d&quot;</span><span class="p">)</span>
</span></code></pre></div>
<p>ãƒ¢ãƒ‡ãƒªãƒ³ã‚°ã®é‡ã¿ã¨JSONå½¢å¼ã®æ§‹æˆã«åŠ ãˆã¦ã€ã“ã®ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ã€Œcustom-resnet50dã€å†…ã®ãƒ¢ãƒ‡ãƒªãƒ³ã‚°ãŠã‚ˆã³æ§‹æˆã€Œ.pyã€ãƒ•ã‚¡ã‚¤ãƒ«ã‚‚ã‚³ãƒ”ãƒ¼ã•ã‚Œã€çµæœã¯Hubã«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã•ã‚Œã¾ã—ãŸã€‚çµæœã¯ã“ã®<a href="https://huggingface.co/sgugger/custom-resnet50d">model repo</a>ã§ç¢ºèªã§ãã¾ã™ã€‚</p>
<p>è©³ç´°ã«ã¤ã„ã¦ã¯ã€<a href="model_sharing">Hubã¸ã®ãƒ—ãƒƒã‚·ãƒ¥æ–¹æ³•</a>ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚</p>
<h2 id="using-a-model-with-custom-code">Using a model with custom code</h2>
<p>è‡ªå‹•ã‚¯ãƒ©ã‚¹ã¨ <code>from_pretrained</code> ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ä½¿ç”¨ã—ã¦ã€ãƒªãƒã‚¸ãƒˆãƒªå†…ã®ã‚«ã‚¹ã‚¿ãƒ ã‚³ãƒ¼ãƒ‰ãƒ•ã‚¡ã‚¤ãƒ«ã¨å…±ã«ä»»æ„ã®æ§‹æˆã€ãƒ¢ãƒ‡ãƒ«ã€ã¾ãŸã¯ãƒˆãƒ¼ã‚¯ãƒŠã‚¤ã‚¶ã‚’ä½¿ç”¨ã§ãã¾ã™ã€‚ Hubã«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã•ã‚Œã‚‹ã™ã¹ã¦ã®ãƒ•ã‚¡ã‚¤ãƒ«ã¨ã‚³ãƒ¼ãƒ‰ã¯ãƒãƒ«ã‚¦ã‚§ã‚¢ã®ã‚¹ã‚­ãƒ£ãƒ³ãŒå®Ÿæ–½ã•ã‚Œã¾ã™ï¼ˆè©³ç´°ã¯<a href="https://huggingface.co/docs/hub/security#malware-scanning">Hubã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£</a>ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å‚ç…§ã—ã¦ãã ã•ã„ï¼‰ã€ã—ã‹ã—ã€ä¾ç„¶ã¨ã—ã¦æ‚ªæ„ã®ã‚ã‚‹ã‚³ãƒ¼ãƒ‰ã‚’å®Ÿè¡Œã—ãªã„ãŸã‚ã«ã€ãƒ¢ãƒ‡ãƒ«ã‚³ãƒ¼ãƒ‰ã¨ä½œè€…ã‚’ç¢ºèªã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚
<code>trust_remote_code=True</code> ã‚’è¨­å®šã—ã¦ã‚«ã‚¹ã‚¿ãƒ ã‚³ãƒ¼ãƒ‰ã‚’æŒã¤ãƒ¢ãƒ‡ãƒ«ã‚’ä½¿ç”¨ã§ãã¾ã™ï¼š</p>
<div class="language-py highlight"><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">transformers</span><span class="w"> </span><span class="kn">import</span> <span class="n">AutoModelForImageClassification</span>
</span><span id="__span-14-2"><a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a>
</span><span id="__span-14-3"><a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a><span class="n">model</span> <span class="o">=</span> <span class="n">AutoModelForImageClassification</span><span class="o">.</span><span class="n">from_pretrained</span><span class="p">(</span><span class="s2">&quot;sgugger/custom-resnet50d&quot;</span><span class="p">,</span> <span class="n">trust_remote_code</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span></code></pre></div>
<p>ã‚³ãƒŸãƒƒãƒˆãƒãƒƒã‚·ãƒ¥ã‚’ã€Œrevisionã€ã¨ã—ã¦æ¸¡ã™ã“ã¨ã‚‚å¼·ãæ¨å¥¨ã•ã‚Œã¦ã„ã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ãƒ¢ãƒ‡ãƒ«ã®ä½œè€…ãŒã‚³ãƒ¼ãƒ‰ã‚’æ‚ªæ„ã®ã‚ã‚‹æ–°ã—ã„è¡Œã§æ›´æ–°ã—ãªã‹ã£ãŸã“ã¨ã‚’ç¢ºèªã§ãã¾ã™ï¼ˆãƒ¢ãƒ‡ãƒ«ã®ä½œè€…ã‚’å®Œå…¨ã«ä¿¡é ¼ã—ã¦ã„ã‚‹å ´åˆã‚’é™¤ãã¾ã™ï¼‰ã€‚</p>
<div class="language-py highlight"><pre><span></span><code><span id="__span-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a><span class="n">commit_hash</span> <span class="o">=</span> <span class="s2">&quot;ed94a7c6247d8aedce4647f00f20de6875b5b292&quot;</span>
</span><span id="__span-15-2"><a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a><span class="n">model</span> <span class="o">=</span> <span class="n">AutoModelForImageClassification</span><span class="o">.</span><span class="n">from_pretrained</span><span class="p">(</span>
</span><span id="__span-15-3"><a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a>    <span class="s2">&quot;sgugger/custom-resnet50d&quot;</span><span class="p">,</span> <span class="n">trust_remote_code</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">revision</span><span class="o">=</span><span class="n">commit_hash</span>
</span><span id="__span-15-4"><a id="__codelineno-15-4" name="__codelineno-15-4" href="#__codelineno-15-4"></a><span class="p">)</span>
</span></code></pre></div>
<p>ãƒ¢ãƒ‡ãƒ«ãƒªãƒã‚¸ãƒˆãƒªã®ã‚³ãƒŸãƒƒãƒˆå±¥æ­´ã‚’ãƒ–ãƒ©ã‚¦ã‚¸ãƒ³ã‚°ã™ã‚‹éš›ã«ã¯ã€ä»»æ„ã®ã‚³ãƒŸãƒƒãƒˆã®ã‚³ãƒŸãƒƒãƒˆãƒãƒƒã‚·ãƒ¥ã‚’ç°¡å˜ã«ã‚³ãƒ”ãƒ¼ã§ãã‚‹ãƒœã‚¿ãƒ³ãŒã‚ã‚Šã¾ã™ã€‚</p>
<h2 id="registering-a-model-with-custom-code-to-the-auto-classes">Registering a model with custom code to the auto classes</h2>
<p>ğŸ¤— Transformersã‚’æ‹¡å¼µã™ã‚‹ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½œæˆã—ã¦ã„ã‚‹å ´åˆã€ç‹¬è‡ªã®ãƒ¢ãƒ‡ãƒ«ã‚’å«ã‚ã‚‹ãŸã‚ã«è‡ªå‹•ã‚¯ãƒ©ã‚¹ã‚’æ‹¡å¼µã—ãŸã„å ´åˆãŒã‚ã‚Šã¾ã™ã€‚
ã“ã‚Œã¯ã‚³ãƒ¼ãƒ‰ã‚’Hubã«ãƒ—ãƒƒã‚·ãƒ¥ã™ã‚‹ã“ã¨ã¨ã¯ç•°ãªã‚Šã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯ã‚«ã‚¹ã‚¿ãƒ ãƒ¢ãƒ‡ãƒ«ã‚’å–å¾—ã™ã‚‹ãŸã‚ã«ã‚ãªãŸã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™
ï¼ˆHubã‹ã‚‰ãƒ¢ãƒ‡ãƒ«ã‚³ãƒ¼ãƒ‰ã‚’è‡ªå‹•çš„ã«ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã™ã‚‹ã®ã¨ã¯å¯¾ç…§çš„ã§ã™ï¼‰ã€‚</p>
<p>æ§‹æˆã«æ—¢å­˜ã®ãƒ¢ãƒ‡ãƒ«ã‚¿ã‚¤ãƒ—ã¨ç•°ãªã‚‹ <code>model_type</code> å±æ€§ãŒã‚ã‚‹é™ã‚Šã€ã¾ãŸã‚ãªãŸã®ãƒ¢ãƒ‡ãƒ«ã‚¯ãƒ©ã‚¹ãŒé©åˆ‡ãª <code>config_class</code> å±æ€§ã‚’æŒã£ã¦ã„ã‚‹é™ã‚Šã€
æ¬¡ã®ã‚ˆã†ã«ãã‚Œã‚‰ã‚’è‡ªå‹•ã‚¯ãƒ©ã‚¹ã«è¿½åŠ ã§ãã¾ã™ï¼š</p>
<div class="language-py highlight"><pre><span></span><code><span id="__span-16-1"><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">transformers</span><span class="w"> </span><span class="kn">import</span> <span class="n">AutoConfig</span><span class="p">,</span> <span class="n">AutoModel</span><span class="p">,</span> <span class="n">AutoModelForImageClassification</span>
</span><span id="__span-16-2"><a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a>
</span><span id="__span-16-3"><a id="__codelineno-16-3" name="__codelineno-16-3" href="#__codelineno-16-3"></a><span class="n">AutoConfig</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="s2">&quot;resnet&quot;</span><span class="p">,</span> <span class="n">ResnetConfig</span><span class="p">)</span>
</span><span id="__span-16-4"><a id="__codelineno-16-4" name="__codelineno-16-4" href="#__codelineno-16-4"></a><span class="n">AutoModel</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">ResnetConfig</span><span class="p">,</span> <span class="n">ResnetModel</span><span class="p">)</span>
</span><span id="__span-16-5"><a id="__codelineno-16-5" name="__codelineno-16-5" href="#__codelineno-16-5"></a><span class="n">AutoModelForImageClassification</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">ResnetConfig</span><span class="p">,</span> <span class="n">ResnetModelForImageClassification</span><span class="p">)</span>
</span></code></pre></div>
<p>æ³¨æ„: <code>AutoConfig</code> ã«ã‚«ã‚¹ã‚¿ãƒ è¨­å®šã‚’ç™»éŒ²ã™ã‚‹éš›ã®æœ€åˆã®å¼•æ•°ã¯ã€ã‚«ã‚¹ã‚¿ãƒ è¨­å®šã® <code>model_type</code> ã¨ä¸€è‡´ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚
ã¾ãŸã€ä»»æ„ã®è‡ªå‹•ãƒ¢ãƒ‡ãƒ«ã‚¯ãƒ©ã‚¹ã«ã‚«ã‚¹ã‚¿ãƒ ãƒ¢ãƒ‡ãƒ«ã‚’ç™»éŒ²ã™ã‚‹éš›ã®æœ€åˆã®å¼•æ•°ã¯ã€ãã‚Œã‚‰ã®ãƒ¢ãƒ‡ãƒ«ã® <code>config_class</code> ã¨ä¸€è‡´ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚</p>












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../../../../../..", "features": ["navigation.tabs", "navigation.indexes", "navigation.instant", "navigation.sections", "navigation.top", "navigation.tracking", "search.highlight", "search.share", "search.suggest", "toc.follow", "content.tabs.link", "content.code.copy"], "search": "../../../../../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../../../../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
    
  </body>
</html>